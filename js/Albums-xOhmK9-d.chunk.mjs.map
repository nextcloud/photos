{"version":3,"file":"Albums-xOhmK9-d.chunk.mjs","sources":["../src/views/Albums.vue"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<div>\n\t\t<CollectionsList :collections=\"albums\"\n\t\t\t:loading=\"loadingCollections\"\n\t\t\t:error=\"errorFetchingCollections\"\n\t\t\tclass=\"albums-list\">\n\t\t\t<HeaderNavigation key=\"navigation\"\n\t\t\t\tslot=\"header\"\n\t\t\t\t:loading=\"loadingCollections\"\n\t\t\t\t:title=\"t('photos', 'Albums')\"\n\t\t\t\t:root-title=\"t('photos', 'Albums')\"\n\t\t\t\t@refresh=\"fetchAlbums\">\n\t\t\t\t<NcButton :aria-label=\"isMobile ? t('photos', 'New album') : undefined\"\n\t\t\t\t\t@click=\"showAlbumCreationForm = true\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<Plus :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if=\"!isMobile\" #default>\n\t\t\t\t\t\t{{ t('photos', 'New album') }}\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t</HeaderNavigation>\n\n\t\t\t<CollectionCover :key=\"collection.basename\"\n\t\t\t\tslot-scope=\"{collection}\"\n\t\t\t\t:link=\"`/albums/${collection.basename}`\"\n\t\t\t\t:alt-img=\"t('photos', 'Cover photo for album {albumName}', { albumName: collection.basename })\"\n\t\t\t\t:cover-url=\"collection.lastPhoto | coverUrl\">\n\t\t\t\t<span class=\"album__name\">\n\t\t\t\t\t{{ collection.basename }}\n\t\t\t\t</span>\n\n\t\t\t\t<div slot=\"subtitle\" class=\"album__details\">\n\t\t\t\t\t{{ collection.date }} â¸± {{ n('photos', '%n item', '%n photos and videos', collection.nbItems,) }}\n\t\t\t\t</div>\n\t\t\t</CollectionCover>\n\n\t\t\t<NcEmptyContent slot=\"empty-collections-list\" :name=\"t('photos', 'There is no album yet!')\">\n\t\t\t\t<FolderMultipleImage slot=\"icon\" />\n\t\t\t</NcEmptyContent>\n\t\t</CollectionsList>\n\n\t\t<NcModal v-if=\"showAlbumCreationForm\"\n\t\t\t@close=\"showAlbumCreationForm = false\">\n\t\t\t<h2 class=\"album-creation__heading\">\n\t\t\t\t{{ t('photos', 'New album') }}\n\t\t\t</h2>\n\t\t\t<AlbumForm @done=\"handleAlbumCreated\" />\n\t\t</NcModal>\n\t</div>\n</template>\n\n<script lang='ts'>\nimport Plus from 'vue-material-design-icons/Plus.vue'\nimport FolderMultipleImage from 'vue-material-design-icons/FolderMultipleImage.vue'\n\nimport { generateUrl } from '@nextcloud/router'\nimport { NcModal, NcButton, NcEmptyContent, useIsSmallMobile } from '@nextcloud/vue'\nimport { translate, translatePlural } from '@nextcloud/l10n'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nimport CollectionsList from '../components/Collection/CollectionsList.vue'\nimport CollectionCover from '../components/Collection/CollectionCover.vue'\nimport HeaderNavigation from '../components/HeaderNavigation.vue'\nimport AlbumForm from '../components/Albums/AlbumForm.vue'\nimport FetchCollectionsMixin from '../mixins/FetchCollectionsMixin.js'\nimport type { Album } from '../store/albums.js'\n\nexport default {\n\tname: 'Albums',\n\tcomponents: {\n\t\tPlus,\n\t\tFolderMultipleImage,\n\t\tNcModal,\n\t\tNcButton,\n\t\tNcEmptyContent,\n\t\tCollectionsList,\n\t\tCollectionCover,\n\t\tHeaderNavigation,\n\t\tAlbumForm,\n\t},\n\n\tfilters: {\n\t\t/**\n\t\t * @param {string} lastPhoto The album's last photos.\n\t\t */\n\t\tcoverUrl(lastPhoto) {\n\t\t\tif (lastPhoto === -1) {\n\t\t\t\treturn ''\n\t\t\t}\n\n\t\t\treturn generateUrl(`/apps/photos/api/v1/preview/${lastPhoto}?x=${512}&y=${512}`)\n\t\t},\n\t},\n\n\tmixins: [\n\t\tFetchCollectionsMixin,\n\t],\n\n\tsetup() {\n\t\tconst isMobile = useIsSmallMobile()\n\t\treturn {\n\t\t\tisMobile,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tshowAlbumCreationForm: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\talbums(): Record<string, Album> {\n\t\t\treturn this.$store.getters.albums\n\t\t},\n\t},\n\n\tasync beforeMount() {\n\t\tthis.fetchAlbums()\n\t},\n\n\tmethods: {\n\t\tfetchAlbums() {\n\t\t\tthis.fetchCollections(\n\t\t\t\t`/photos/${getCurrentUser()?.uid}/albums`,\n\t\t\t\t['<nc:location />', '<nc:dateRange />', '<nc:collaborators />'],\n\t\t\t)\n\t\t},\n\n\t\thandleAlbumCreated({ album }) {\n\t\t\tthis.showAlbumCreationForm = false\n\t\t\tthis.$router.push(`albums/${album.basename}`)\n\t\t},\n\n\t\tt: translate,\n\t\tn: translatePlural,\n\t},\n}\n</script>\n<style lang=\"scss\" scoped>\n.albums-list {\n\tdisplay: flex;\n\tflex-direction: column;\n\n\t.album__name {\n\t\tfont-weight: normal;\n\t\toverflow: hidden;\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t\tfont-size: 20px;\n\t\tmargin-bottom: 12px;\n\t\tline-height: 30px;\n\t\tcolor: var(--color-main-text);\n\t}\n}\n\n.album-creation__heading {\n\tpadding: calc(var(--default-grid-baseline) * 4);\n\tmargin-bottom: 0px;\n\tpadding-bottom: 0px;\n}\n</style>\n"],"names":["_sfc_main","Plus","FolderMultipleImage","NcModal","NcButton","NcEmptyContent","CollectionsList","CollectionCover","HeaderNavigation","AlbumForm","lastPhoto","generateUrl","FetchCollectionsMixin","useIsSmallMobile","getCurrentUser","album","translate","translatePlural"],"mappings":"4sBAwEA,MAAAA,EAAA,CACA,KAAA,SACA,WAAA,CACA,KAAAC,EACA,oBAAAC,EACA,QAAAC,EACA,SAAAC,EACA,eAAAC,EACA,gBAAAC,EACA,gBAAAC,EACA,iBAAAC,EACA,UAAAC,CACA,EAEA,QAAA,CAIA,SAAAC,EAAA,CACA,OAAAA,IAAA,GACA,GAGAC,EAAA,+BAAAD,CAAA,cAAA,CAAA,CAEA,EAEA,OAAA,CACAE,CACA,EAEA,OAAA,CAEA,MAAA,CACA,SAFAC,EAAA,CAGA,CACA,EAEA,MAAA,CACA,MAAA,CACA,sBAAA,EACA,CACA,EAEA,SAAA,CACA,QAAA,CACA,OAAA,KAAA,OAAA,QAAA,MAAA,CAEA,EAEA,MAAA,aAAA,CACA,KAAA,YAAA,CACA,EAEA,QAAA,CACA,aAAA,CACA,KAAA,iBACA,WAAAC,KAAA,GAAA,UACA,CAAA,kBAAA,mBAAA,sBAAA,CACA,CACA,EAEA,mBAAA,CAAA,MAAAC,GAAA,CACA,KAAA,sBAAA,GACA,KAAA,QAAA,KAAA,UAAAA,EAAA,QAAA,EAAA,CACA,EAEA,EAAAC,EACAC,EAAAA,CAAA,CAEA"}
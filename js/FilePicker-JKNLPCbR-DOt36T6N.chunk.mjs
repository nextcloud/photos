import{V as H,u as Le,s as Fe,R as xe,d as F,g as f,e as p,G as q,P as ce,f as ue,A as $,U as Ie,W as Pe,k as Z,X as Be,b as j,q as ze,F as P,Q as $e,o as Ve,Y as de,Z as Ae,r as U,_ as pe,$ as ee,w as He}from"./vue.runtime.esm-BXvG6LpI.chunk.mjs";import{n as T,k as G,z as Y,a5 as b,t as v,s as K,Q as he,E as fe}from"./index-DYMFnNke.chunk.mjs";import{v as Ee,I as Me,a as O,s as De,f as Te}from"./index-lTlKQ0F5.chunk.mjs";import{N as me}from"./NcCheckboxRadioSwitch-BF1M0HBu-BLuX0CUC.chunk.mjs";import{e as Re}from"./index-BugWYp1e.chunk.mjs";import{N as Oe}from"./NcDateTime-enXYuwj8-_olnb_tR.chunk.mjs";import{E as We}from"./index-Botvo3cN.chunk.mjs";import{N as qe}from"./NcBreadcrumbs-DahxPGJY-cdSsrKEE.chunk.mjs";import{c as Ze}from"./createElementId-DhjFt1I9-B2HCdIOx.chunk.mjs";import{d as je}from"./index-DsdaSfKX.chunk.mjs";import{N as Ue}from"./NcActionButton-1gSJfFUC-Bkqpynuc.chunk.mjs";import{a as Ge,b as Ye}from"./NcAvatar-sR6y5B6f-CeUUcGkp.chunk.mjs";import{N as Ke}from"./NcSelect-B-X6xD0o-BLz9a2Lz.chunk.mjs";import{N as Qe}from"./NcTextField-UoSvO7Ha-RFAr8Giy.chunk.mjs";import{N as Je}from"./NcDialog-xD1P4AFd-ClgZMDQN.chunk.mjs";import{N as Xe}from"./NcEmptyContent-D1ak9nUx.chunk.mjs";import{p as M}from"./index-B9IdwLNi.chunk.mjs";import"./useModelMigration-EhAWvqDD-KN1-JmAp.chunk.mjs";import"./preload-helper-Dh9HmuEY.chunk.mjs";import"./dialog-C7fnOJva.chunk.mjs";import"./useFormatDateTime-DmRTKkoP.chunk.mjs";import"./video-BXb3J_ov.chunk.mjs";const et={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var tt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},it=[],rt=T(et,tt,it,!1,null,null);const st=rt.exports,nt={name:"NcBreadcrumb",components:{NcActions:Y,ChevronRight:st,NcButton:G},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],setup(){const e=Ze();return{actionsContainer:`.vue-crumb[data-crumb-id="${e}"]`,crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var at=function(){var e=this,t=e._self._c;return t("li",{ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{"data-crumb-id":e.crumbId,draggable:"false"},on:{dragstart:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(i){return i.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?t("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[t("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?t("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:e.actionsContainer,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),t("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},ot=[],lt=T(nt,at,ot,!1,null,"bc2f0c21");const ve=lt.exports;var R=Symbol(),B=Symbol(),te=Symbol(),ie=Symbol(),Q=function(e){return"frag"in e},ct={get:function(){return this[B]||this.parentElement},configurable:!0},z=function(e,t){B in e||(e[B]=t,Object.defineProperty(e,"parentNode",ct))},ut={get:function(){var e=this.parentNode.childNodes,t=e.indexOf(this);return t>-1&&e[t+1]||null}},E=function(e){te in e||(e[te]=!0,Object.defineProperty(e,"nextSibling",ut))},dt=function(e,t){for(;e.parentNode!==t;){var i=e,r=i.parentNode;r&&(e=r)}return e},W,ge=function(e){if(!W){var t=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");W=t.get}var i=W.apply(e),r=Array.from(i).map(function(s){return dt(s,e)});return r.filter(function(s,n){return s!==r[n-1]})},pt={get:function(){return this.frag||ge(this)}},ht={get:function(){return this.childNodes[0]||null}};function ft(){return this.childNodes.length>0}var re=function(e){ie in e||(e[ie]=!0,Object.defineProperties(e,{childNodes:pt,firstChild:ht}),e.hasChildNodes=ft)};function mt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function vt(){var e=this.frag,t=e.splice(0,e.length);t.forEach(function(i){i.remove()})}var gt=function e(t){var i;return(i=Array.prototype).concat.apply(i,t.map(function(r){return Q(r)?e(r.frag):r}))},yt=function(e,t){var i=e[R];t.before(i),z(i,e),e.frag.unshift(i)};function se(e){if(Q(this)){var t=this.frag.indexOf(e);if(t>-1){var i=this.frag.splice(t,1),r=i[0];this.frag.length===0&&yt(this,r),e.remove()}}else{var s=ge(this),n=s.indexOf(e);n>-1&&e.remove()}return e}function ne(e,t){var i=this,r=e.frag||[e];if(Q(this)){if(e[B]===this&&e.parentElement)return e;var s=this.frag;if(t){var n=s.indexOf(t);n>-1&&(s.splice.apply(s,[n,0].concat(r)),t.before.apply(t,r))}else{var a=s[s.length-1];s.push.apply(s,r),a.after.apply(a,r)}ye(this)}else t?this.childNodes.includes(t)&&t.before.apply(t,r):this.append.apply(this,r);r.forEach(function(c){z(c,i)});var o=r[r.length-1];return E(o),e}function _t(e){if(e[B]===this&&e.parentElement)return e;var t=this.frag,i=t[t.length-1];return i.after(e),z(e,this),ye(this),t.push(e),e}var ye=function(e){var t=e[R];e.frag[0]===t&&(e.frag.shift(),t.remove())},bt={set:function(e){var t=this;if(this.frag[0]!==this[R]&&this.frag.slice().forEach(function(r){return t.removeChild(r)}),e){var i=document.createElement("div");i.innerHTML=e,Array.from(i.childNodes).forEach(function(r){t.appendChild(r)})}},get:function(){return""}},wt={inserted:function(e){var t=e.parentNode,i=e.nextSibling,r=e.previousSibling,s=Array.from(e.childNodes),n=document.createComment("");s.length===0&&s.push(n),e.frag=s,e[R]=n;var a=document.createDocumentFragment();a.append.apply(a,gt(s)),e.replaceWith(a),s.forEach(function(o){z(o,e),E(o)}),re(e),Object.assign(e,{remove:vt,appendChild:_t,insertBefore:ne,removeChild:se,before:mt}),Object.defineProperty(e,"innerHTML",bt),t&&(Object.assign(t,{removeChild:se,insertBefore:ne}),z(e,t),re(t)),i&&E(e),r&&E(r)},unbind:function(e){e.remove()}},_e={name:"Fragment",directives:{frag:wt},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const Ct={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var kt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},St=[],Nt=T(Ct,kt,St,!1,null,null);const Lt=Nt.exports;function ae(e,t,i){if(e!==void 0)for(let r=e.length-1;r>=0;r--){const s=e[r],n=!s.componentOptions&&s.tag&&t.indexOf(s.tag)===-1,a=!!s.componentOptions&&typeof s.componentOptions.tag=="string",o=a&&t.indexOf(s.componentOptions.tag)===-1;(n||!a||o)&&((n||o)&&H.util.warn(`${n?s.tag:s.componentOptions.tag} is not allowed inside the ${i.$options.name} component`,i),e.splice(r,1))}}const _="vue-crumb",Ft={name:"NcBreadcrumbs",components:{NcActions:Y,NcActionButton:Ue,NcActionRouter:Ye,NcActionLink:Ge,NcBreadcrumb:ve,IconFolder:Lt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){ae(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){ae(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",je(()=>{this.handleWindowResize()},100)),Fe("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),Le("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),t=e.length,i=[],r=this.$refs.container.offsetWidth;let s=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(s+=this.$refs.breadcrumb__actions.offsetWidth);let n=s-r;n+=n>0?64:0;let a=0;const o=Math.floor(t/2);for(;n>0&&a<t-2;){const c=o+(a%2?a+1:a)/2*Math.pow(-1,a+t%2);n-=this.getWidth(e[c]?.elm,c===e.length-1),i.push(c),a++}this.arraysEqual(this.hiddenIndices,i.sort((c,l)=>c-l))||(this.hiddenIndices=i)},arraysEqual(e,t){if(e.length!==t.length)return!1;if(e===t)return!0;if(e===null||t===null)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0},getTotalWidth(e){return e.reduce((t,i,r)=>t+this.getWidth(i?.elm,r===e.length-1),0)},getWidth(e,t){if(!e?.classList)return 0;const i=e.classList.contains(`${_}--hidden`);e.style.minWidth="auto",t&&(e.style.maxWidth="210px"),e.classList.remove(`${_}--hidden`);const r=e.offsetWidth;return i&&e.classList.add(`${_}--hidden`),e.style.minWidth="",e.style.maxWidth="",r},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,t,i){return i||this.$emit("dropped",e,t),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${_}`).forEach(r=>{r.classList.remove(`${_}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,t){if(!t&&e.target.closest){const i=e.target.closest(`.${_}`);i.classList&&i.classList.contains(_)&&(document.querySelectorAll(`.${_}`).forEach(r=>{r.classList.remove(`${_}--hovered`)}),i.classList.add(`${_}--hovered`))}},dragLeave(e,t){if(!t&&!e.target.contains(e.relatedTarget)&&e.target.closest){const i=e.target.closest(`.${_}`);if(i.contains(e.relatedTarget))return;i.classList&&i.classList.contains(_)&&i.classList.remove(`${_}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,t)=>{e?.elm?.classList&&(this.hiddenIndices.includes(t)?e.elm.classList.add(`${_}--hidden`):e.elm.classList.remove(`${_}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const t=[];if(this.$slots.default.forEach(n=>{if(this.isBreadcrumb(n)){t.push(n);return}n?.type===_e&&n?.children?.forEach?.(a=>{this.isBreadcrumb(a)&&t.push(a)})}),t.length===0)return;H.set(t[0].componentOptions.propsData,"icon",this.rootIcon),H.set(t[0].componentOptions.propsData,"ref","breadcrumbs");const i={};t.forEach((n,a)=>{H.set(n,"ref",`crumb-${a}`),i[a]=n});let r=[];if(!this.hiddenIndices.length)r=t;else{r=t.slice(0,Math.round(t.length/2)),r.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":a=>{this.menuBreadcrumbProps.open=a}}},this.hiddenIndices.filter(a=>a<=t.length-1).map(a=>{const o=t[a],c=o.componentOptions.propsData.to,l=o.componentOptions.propsData.href,h=o.componentOptions.propsData.disableDrop,u=o.componentOptions.propsData.title,y=o.componentOptions.propsData.name;let w="NcActionButton",k="";l&&(w="NcActionLink",k=l),c&&(w="NcActionRouter",k=c);const S=e("IconFolder",{props:{size:20},slot:"icon"});return e(w,{class:_,props:{href:l||null,title:u,to:c||null},attrs:{draggable:!1},on:{...o.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:C=>this.dropped(C,k,h),dragover:this.dragOver,dragenter:C=>this.dragEnter(C,h),dragleave:C=>this.dragLeave(C,h)}},[S,y])})));const n=t.slice(Math.round(t.length/2));r=r.concat(n)}const s=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[r])])];return this.$slots.actions&&s.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=i,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===t.length-2}],ref:"container"},s)}},xt=null,It=null;var Pt=T(Ft,xt,It,!1,null,"daf14f2f");const Bt=Pt.exports;function J(e,t,i){const r=`#initial-state-${e}-${t}`;if(window._nc_initial_state?.has(r))return window._nc_initial_state.get(r);window._nc_initial_state||(window._nc_initial_state=new Map);const s=document.querySelector(r);if(s===null)return i;try{const n=JSON.parse(atob(s.value));return window._nc_initial_state.set(r,n),n}catch(n){return console.error("[@nextcloud/initial-state] Could not parse initial state",{key:t,app:e,error:n}),i}}function be(){return J("files_sharing","isPublic",null)??document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function I(e){return typeof e=="function"?e():xe(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;var zt="M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z",oe="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",$t="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",Vt="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",At="M7 14C5.9 14 5 13.1 5 12S5.9 10 7 10 9 10.9 9 12 8.1 14 7 14M12.6 10C11.8 7.7 9.6 6 7 6C3.7 6 1 8.7 1 12S3.7 18 7 18C9.6 18 11.8 16.3 12.6 14H16V18H20V14H23V10H12.6Z",Ht="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z",Et="M15,20A1,1 0 0,0 14,19H13V17H17A2,2 0 0,0 19,15V5A2,2 0 0,0 17,3H7A2,2 0 0,0 5,5V15A2,2 0 0,0 7,17H11V19H10A1,1 0 0,0 9,20H2V22H9A1,1 0 0,0 10,23H14A1,1 0 0,0 15,22H22V20H15M7,15V5H17V15H7Z",Mt="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",Dt="M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L11.59 21.42A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M13 20L4 11V4H11L20 13M6.5 5A1.5 1.5 0 1 1 5 6.5A1.5 1.5 0 0 1 6.5 5Z",D;(function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh"})(D||(D={}));class X extends Error{name="TimeoutError";constructor(t,i){super(t,i),Error.captureStackTrace?.(this,X)}}const le=e=>e.reason??new DOMException("This operation was aborted.","AbortError");function Tt(e,t){const{milliseconds:i,fallback:r,message:s,customTimers:n={setTimeout,clearTimeout},signal:a}=t;let o,c;const l=new Promise((h,u)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(a?.aborted){u(le(a));return}if(a&&(c=()=>{u(le(a))},a.addEventListener("abort",c,{once:!0})),e.then(h,u),i===Number.POSITIVE_INFINITY)return;const y=new X;o=n.setTimeout.call(void 0,()=>{if(r){try{h(r())}catch(w){u(w)}return}typeof e.cancel=="function"&&e.cancel(),s===!1?h():s instanceof Error?u(s):(y.message=s??`Promise timed out after ${i} milliseconds`,u(y))},i)}).finally(()=>{l.clear(),c&&a&&a.removeEventListener("abort",c)});return l.clear=()=>{n.clearTimeout.call(void 0,o),o=void 0},l}function Rt(e,t,i){let r=0,s=e.length;for(;s>0;){const n=Math.trunc(s/2);let a=r+n;i(e[a],t)<=0?(r=++a,s-=n+1):s=n}return r}class Ot{#i=[];enqueue(t,i){const{priority:r=0,id:s}=i??{},n={priority:r,id:s,run:t};if(this.size===0||this.#i[this.size-1].priority>=r){this.#i.push(n);return}const a=Rt(this.#i,n,(o,c)=>c.priority-o.priority);this.#i.splice(a,0,n)}setPriority(t,i){const r=this.#i.findIndex(n=>n.id===t);if(r===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);const[s]=this.#i.splice(r,1);this.enqueue(s.run,{priority:i,id:t})}dequeue(){return this.#i.shift()?.run}filter(t){return this.#i.filter(i=>i.priority===t.priority).map(i=>i.run)}get size(){return this.#i.length}}class Wt extends We{#i;#a;#o=0;#h;#m=!1;#y=!1;#l;#L=0;#_=0;#c;#u;#n;#s=[];#r=0;#e;#F;#t=0;#v;#d;#z=1n;#g=new Map;timeout;constructor(t){if(super(),t={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Ot,strict:!1,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);if(t.strict&&t.interval===0)throw new TypeError("The `strict` option requires a non-zero `interval`");if(t.strict&&t.intervalCap===Number.POSITIVE_INFINITY)throw new TypeError("The `strict` option requires a finite `intervalCap`");if(this.#i=t.carryoverIntervalCount??t.carryoverConcurrencyCount??!1,this.#a=t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,this.#h=t.intervalCap,this.#l=t.interval,this.#n=t.strict,this.#e=new t.queueClass,this.#F=t.queueClass,this.concurrency=t.concurrency,t.timeout!==void 0&&!(Number.isFinite(t.timeout)&&t.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${t.timeout}\` (${typeof t.timeout})`);this.timeout=t.timeout,this.#d=t.autoStart===!1,this.#T()}#b(t){for(;this.#r<this.#s.length;){const i=this.#s[this.#r];if(i!==void 0&&t-i>=this.#l)this.#r++;else break}(this.#r>100&&this.#r>this.#s.length/2||this.#r===this.#s.length)&&(this.#s=this.#s.slice(this.#r),this.#r=0)}#$(t){this.#n?this.#s.push(t):this.#o++}#V(){this.#n?this.#s.length>this.#r&&this.#s.pop():this.#o>0&&this.#o--}#w(){return this.#s.length-this.#r}get#A(){return this.#a?!0:this.#n?this.#w()<this.#h:this.#o<this.#h}get#H(){return this.#t<this.#v}#E(){this.#t--,this.#t===0&&this.emit("pendingZero"),this.#S(),this.emit("next")}#M(){this.#u=void 0,this.#P(),this.#I()}#D(t){if(this.#n){if(this.#b(t),this.#w()>=this.#h){const i=this.#s[this.#r],r=this.#l-(t-i);return this.#C(r),!0}return!1}if(this.#c===void 0){const i=this.#L-t;if(i<0){if(this.#_>0){const r=t-this.#_;if(r<this.#l)return this.#C(this.#l-r),!0}this.#o=this.#i?this.#t:0}else return this.#C(i),!0}return!1}#C(t){this.#u===void 0&&(this.#u=setTimeout(()=>{this.#M()},t))}#k(){this.#c&&(clearInterval(this.#c),this.#c=void 0)}#x(){this.#u&&(clearTimeout(this.#u),this.#u=void 0)}#S(){if(this.#e.size===0){if(this.#k(),this.emit("empty"),this.#t===0){if(this.#x(),this.#n&&this.#r>0){const i=Date.now();this.#b(i)}this.emit("idle")}return!1}let t=!1;if(!this.#d){const i=Date.now(),r=!this.#D(i);if(this.#A&&this.#H){const s=this.#e.dequeue();this.#a||(this.#$(i),this.#f()),this.emit("active"),s(),r&&this.#I(),t=!0}}return t}#I(){this.#a||this.#c!==void 0||this.#n||(this.#c=setInterval(()=>{this.#P()},this.#l),this.#L=Date.now()+this.#l)}#P(){this.#n||(this.#o===0&&this.#t===0&&this.#c&&this.#k(),this.#o=this.#i?this.#t:0),this.#N(),this.#f()}#N(){for(;this.#S(););}get concurrency(){return this.#v}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#v=t,this.#N()}setPriority(t,i){if(typeof i!="number"||!Number.isFinite(i))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${i}\` (${typeof i})`);this.#e.setPriority(t,i)}async add(t,i={}){return i={timeout:this.timeout,...i,id:i.id??(this.#z++).toString()},new Promise((r,s)=>{const n=Symbol(`task-${i.id}`);this.#e.enqueue(async()=>{this.#t++,this.#g.set(n,{id:i.id,priority:i.priority??0,startTime:Date.now(),timeout:i.timeout});let a;try{try{i.signal?.throwIfAborted()}catch(l){throw this.#R(),this.#g.delete(n),l}this.#_=Date.now();let o=t({signal:i.signal});if(i.timeout&&(o=Tt(Promise.resolve(o),{milliseconds:i.timeout,message:`Task timed out after ${i.timeout}ms (queue has ${this.#t} running, ${this.#e.size} waiting)`})),i.signal){const{signal:l}=i;o=Promise.race([o,new Promise((h,u)=>{a=()=>{u(l.reason)},l.addEventListener("abort",a,{once:!0})})])}const c=await o;r(c),this.emit("completed",c)}catch(o){s(o),this.emit("error",o)}finally{a&&i.signal?.removeEventListener("abort",a),this.#g.delete(n),queueMicrotask(()=>{this.#E()})}},i),this.emit("add"),this.#S()})}async addAll(t,i){return Promise.all(t.map(async r=>this.add(r,i)))}start(){return this.#d?(this.#d=!1,this.#N(),this):this}pause(){this.#d=!0}clear(){this.#e=new this.#F,this.#k(),this.#B(),this.emit("empty"),this.#t===0&&(this.#x(),this.emit("idle")),this.emit("next")}async onEmpty(){this.#e.size!==0&&await this.#p("empty")}async onSizeLessThan(t){this.#e.size<t||await this.#p("next",()=>this.#e.size<t)}async onIdle(){this.#t===0&&this.#e.size===0||await this.#p("idle")}async onPendingZero(){this.#t!==0&&await this.#p("pendingZero")}async onRateLimit(){this.isRateLimited||await this.#p("rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await this.#p("rateLimitCleared")}onError(){return new Promise((t,i)=>{const r=s=>{this.off("error",r),i(s)};this.on("error",r)})}async#p(t,i){return new Promise(r=>{const s=()=>{i&&!i()||(this.off(t,s),r())};this.on(t,s)})}get size(){return this.#e.size}sizeBy(t){return this.#e.filter(t).length}get pending(){return this.#t}get isPaused(){return this.#d}#T(){this.#a||(this.on("add",()=>{this.#e.size>0&&this.#f()}),this.on("next",()=>{this.#f()}))}#f(){this.#a||this.#y||(this.#y=!0,queueMicrotask(()=>{this.#y=!1,this.#B()}))}#R(){this.#a||(this.#V(),this.#f())}#B(){const t=this.#m;if(this.#a||this.#e.size===0){t&&(this.#m=!1,this.emit("rateLimitCleared"));return}let i;if(this.#n){const s=Date.now();this.#b(s),i=this.#w()}else i=this.#o;const r=i>=this.#h;r!==t&&(this.#m=r,this.emit(r?"rateLimit":"rateLimitCleared"))}get isRateLimited(){return this.#m}get isSaturated(){return this.#t===this.#v&&this.#e.size>0||this.isRateLimited&&this.#e.size>0}get runningTasks(){return[...this.#g.values()].map(t=>({...t}))}}const qt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Zt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},jt=[],Ut=b(qt,Zt,jt,!1,null,null);const we=Ut.exports,Ce=()=>{const e=J("files","config",null),t=f(e?.show_hidden??!0),i=f(e?.sort_favorites_first??!0),r=f(e?.crop_image_previews??!0);return $(async()=>{if(be())console.debug("Skip loading files settings - currently on public share");else try{const{data:s}=await he.get(Z("/apps/files/api/v1/configs"));t.value=s?.data?.show_hidden??!1,i.value=s?.data?.sort_favorites_first??!0,r.value=s?.data?.crop_image_previews??!0}catch(s){console.error("Could not load files settings",s),K(v("Could not load files settings"))}}),{showHiddenFiles:t,sortFavoritesFirst:i,cropImagePreviews:r}},Gt=e=>{const t=l=>l==="asc"?"ascending":l==="desc"?"descending":"none",i=J("files","viewConfigs",null),r=f({sortBy:i?.files?.sorting_mode??"basename",order:t(i?.files?.sorting_direction??"asc")}),s=f({sortBy:i?.recent?.sorting_mode??"basename",order:t(i?.recent?.sorting_direction??"asc")}),n=f({sortBy:i?.favorites?.sorting_mode??"basename",order:t(i?.favorites?.sorting_direction??"asc")});$(async()=>{if(be())console.debug("Skip loading files views - currently on public share");else try{const{data:l}=await he.get(Z("/apps/files/api/v1/views"));r.value={sortBy:l?.data?.files?.sorting_mode??"basename",order:t(l?.data?.files?.sorting_direction)},n.value={sortBy:l?.data?.favorites?.sorting_mode??"basename",order:t(l?.data?.favorites?.sorting_direction)},s.value={sortBy:l?.data?.recent?.sorting_mode??"basename",order:t(l?.data?.recent?.sorting_direction)}}catch(l){console.error("Could not load files views",l),K(v("Could not load files views"))}});const a=p(()=>I(e||"files")==="files"?r.value:I(e)==="recent"?s.value:n.value),o=p(()=>a.value.sortBy),c=p(()=>a.value.order);return{filesViewConfig:r,favoritesViewConfig:n,recentViewConfig:s,currentConfig:a,sortBy:o,order:c}},Yt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Kt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Qt=[],Jt=b(Yt,Kt,Qt,!1,null,null);const Xt=Jt.exports,ei={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ti=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ii=[],ri=b(ei,ti,ii,!1,null,null);const si=ri.exports,ke={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},ni=F({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:ke}}});var ai=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?t("td",{staticClass:"row-checkbox"},[t("span")]):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"row-wrapper"},[t("span",{class:i.fileListIconStyles["file-picker__file-icon"]}),t("span")])]),e._m(0),e._m(1)])},oi=[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-size"},[t("span")])},function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-modified"},[t("span")])}],li=b(ni,ai,oi,!1,null,"15187afc");const ci=li.exports,ui=new Wt({concurrency:5});function di(e){const{resolve:t,promise:i}=Promise.withResolvers();return ui.add(()=>{const r=new Image;return r.onerror=()=>t(!1),r.onload=()=>t(!0),r.src=e,i}),i}function pi(e,t={}){t={size:32,cropPreview:!1,mimeFallback:!0,...t};try{const i=e.attributes?.previewUrl||Z("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(i)}catch{r=new URL(i,window.location.origin)}return r.searchParams.set("x",`${t.size}`),r.searchParams.set("y",`${t.size}`),r.searchParams.set("mimeFallback",`${t.mimeFallback}`),r.searchParams.set("a",t.cropPreview===!0?"0":"1"),r.searchParams.set("c",`${e.attributes.etag}`),r}catch{return null}}const hi=(e,t)=>{const i=f(null),r=f(!1);return He(()=>{r.value=!1,i.value=pi(I(e),I(t||{})),i.value&&I(e).type===P.File&&di(i.value.href).then(s=>{r.value=s})}),{previewURL:i,previewLoaded:r}},fi={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var mi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},vi=[],gi=b(fi,mi,vi,!1,null,null);const Se=gi.exports,yi={name:"FilePreview"},_i=F({...yi,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const t=e,i=f(ke),{previewURL:r,previewLoaded:s}=hi(ue(t,"node"),p(()=>({cropPreview:t.cropImagePreviews}))),n=p(()=>t.node.type===P.File),a=p(()=>{if(t.node.type!==P.Folder)return null;if(t.node.attributes?.["is-encrypted"]===1)return At;if(t.node.attributes?.["is-tag"])return Dt;const o=Object.values(t.node.attributes?.["share-types"]||{}).flat();if(o.some(c=>c===D.Link||c===D.Email))return Ht;if(o.length>0)return oe;switch(t.node.attributes?.["mount-type"]){case"external":case"external-session":return Et;case"group":return zt;case"shared":return oe}return null});return{__sfc:!0,fileListIconStyles:i,props:t,previewURL:r,previewLoaded:s,isFile:n,folderDecorationIcon:a,NcIconSvgWrapper:fe,IconFile:we,IconFolder:Se}}});var bi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{class:i.fileListIconStyles["file-picker__file-icon"],style:i.previewLoaded?{backgroundImage:`url(${i.previewURL})`}:void 0},[i.previewLoaded?e._e():[i.isFile?t(i.IconFile,{attrs:{size:32}}):[i.folderDecorationIcon?t(i.NcIconSvgWrapper,{class:i.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:i.folderDecorationIcon,size:16}}):e._e(),t(i.IconFolder,{class:i.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},wi=[],Ci=b(_i,bi,wi,!1,null,null);const ki=Ci.exports,Si=F({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:t}){const i=e,r=p(()=>Re(i.node.displayname)),s=p(()=>i.node.displayname.slice(0,r.value?-r.value.length:void 0)),n=p(()=>i.node.type===P.Folder),a=p(()=>i.canPick&&(i.allowPickDirectory||!n.value)),o=p(()=>(i.node.permissions&ee.READ)===ee.READ);function c(){a.value&&t("update:selected",!i.selected)}function l(){n.value?o.value&&t("enter-directory",i.node):c()}function h(u){u.key==="Enter"&&l()}return{__sfc:!0,props:i,emit:t,fileExtension:r,displayName:s,isDirectory:n,isPickable:a,isNavigatable:o,toggleSelected:c,handleClick:l,handleKeyDown:h,formatFileSize:Te,NcCheckboxRadioSwitch:me,NcDateTime:Oe,t:v,FilePreview:ki}}});var Ni=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":i.isDirectory&&!i.isNavigatable,"file-picker__row--not-pickable":!i.isPickable}],attrs:{tabindex:e.showCheckbox&&!i.isDirectory?void 0:0,"aria-selected":i.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:i.handleClick,...!e.showCheckbox||i.isDirectory?{keydown:i.handleKeyDown}:{}}),[e.showCheckbox?t("td",{staticClass:"row-checkbox",on:{click:function(r){return r.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select the row for {nodename}",{nodename:i.displayName}),disabled:!i.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":i.toggleSelected}})],1):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[t(i.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),t("div",{staticClass:"file-picker__file-name",attrs:{title:i.displayName},domProps:{textContent:e._s(i.displayName)}}),t("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(i.fileExtension)}})],1)]),t("td",{staticClass:"row-size"},[e._v(" "+e._s(i.formatFileSize(e.node.size||0))+" ")]),t("td",{staticClass:"row-modified"},[t(i.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Li=[],Fi=b(Si,Ni,Li,!1,null,"82f380c9");const xi=Fi.exports,Ii=F({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,canPick:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:t}){const i=e,r=f(),{currentConfig:s}=Gt(i.currentView),n=p(()=>r.value??s.value),a=p(()=>n.value.sortBy==="basename"?n.value.order==="none"?void 0:n.value.order:void 0),o=p(()=>n.value.sortBy==="size"?n.value.order==="none"?void 0:n.value.order:void 0),c=p(()=>n.value.sortBy==="mtime"?n.value.order==="none"?void 0:n.value.order:void 0),l=g=>{n.value.sortBy===g?n.value.order==="ascending"?r.value={sortBy:n.value.sortBy,order:"descending"}:r.value={sortBy:n.value.sortBy,order:"ascending"}:r.value={sortBy:g,order:"ascending"}},{sortFavoritesFirst:h,cropImagePreviews:u}=Ce(),y=p(()=>De(i.files,{sortFoldersFirst:!0,sortFavoritesFirst:h.value,sortingOrder:n.value.order==="descending"?"desc":"asc",sortingMode:n.value.sortBy})),w=p(()=>i.files.filter(g=>i.allowPickDirectory||g.type!==P.Folder)),k=p(()=>!i.loading&&i.selectedFiles.length>0&&i.selectedFiles.length>=w.value.length);function S(){i.selectedFiles.length<w.value.length?t("update:selectedFiles",w.value):t("update:selectedFiles",[])}function C(g){i.selectedFiles.includes(g)?t("update:selectedFiles",i.selectedFiles.filter(L=>L.path!==g.path)):i.multiselect?t("update:selectedFiles",[...i.selectedFiles,g]):t("update:selectedFiles",[g])}function V(g){t("update:path",g.path)}const x=f(4),N=f();{const g=()=>$e(()=>{const L=N.value?.parentElement?.children||[];let A=N.value?.parentElement?.clientHeight||450;for(let d=0;d<L.length;d++)N.value?.isSameNode(L[d])||(A-=L[d].clientHeight);x.value=Math.max(1,Math.floor((A-50)/50))});$(()=>{window.addEventListener("resize",g),g()}),Ve(()=>{window.removeEventListener("resize",g)})}return{__sfc:!0,props:i,emit:t,customSortingConfig:r,filesAppSorting:s,sortingConfig:n,sortByName:a,sortBySize:o,sortByModified:c,toggleSorting:l,sortFavoritesFirst:h,cropImagePreviews:u,sortedFiles:y,selectableFiles:w,allSelected:k,onSelectAll:S,onNodeSelected:C,onChangeDirectory:V,skeletonNumber:x,fileContainer:N,NcButton:G,NcCheckboxRadioSwitch:me,t:v,IconSortAscending:Xt,IconSortDescending:si,LoadingTableRow:ci,FileListRow:xi}}});var Pi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"fileContainer",staticClass:"file-picker__files"},[t("table",[t("thead",[t("tr",[e.multiselect?t("th",{staticClass:"row-checkbox"},[t("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(i.t("Select entry"))+" ")]),e.multiselect?t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":i.allSelected},on:{"update:model-value":i.onSelectAll}}):e._e()],1):e._e(),t("th",{staticClass:"row-name",attrs:{"aria-sort":i.sortByName}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"file-picker__header-preview"}),t(i.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(r){return i.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByName==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByName==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Name"))+" ")])],1)]),t("th",{staticClass:"row-size",attrs:{"aria-sort":i.sortBySize}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortBySize==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortBySize==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Size"))+" ")])],1),t("th",{staticClass:"row-modified",attrs:{"aria-sort":i.sortByModified}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByModified==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByModified==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Modified"))+" ")])],1)])]),t("tbody",[e.loading?e._l(i.skeletonNumber,function(r){return t(i.LoadingTableRow,{key:r,attrs:{"show-checkbox":e.multiselect}})}):e._l(i.sortedFiles,function(r){return t(i.FileListRow,{key:r.fileid||r.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(r))&&(e.canPick===void 0||e.canPick(r)),selected:e.selectedFiles.includes(r),node:r,"crop-image-previews":i.cropImagePreviews},on:{"update:selected":function(s){return i.onNodeSelected(r)},"enter-directory":i.onChangeDirectory}})})],2)])])},Bi=[],zi=b(Ii,Pi,Bi,!1,null,"6503afab");const $i=zi.exports,Vi={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ai=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Hi=[],Ei=b(Vi,Ai,Hi,!1,null,null);const Mi=Ei.exports,Di={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ti=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ri=[],Oi=b(Di,Ti,Ri,!1,null,null);const Wi=Oi.exports,qi=F({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:t}){const i=e,r=f(!1),s=f(""),n=f();function a(){const l=s.value.trim(),h=n.value?.$el?.querySelector("input");let u="";try{Ee(l)}catch(y){if(!(y instanceof Me))throw y;switch(y.reason){case O.Character:u=v('"{char}" is not allowed inside a folder name.',{char:y.segment});break;case O.ReservedName:u=v('"{segment}" is a reserved name and not allowed for folder names.',{segment:y.segment});break;case O.Extension:u=v('Folder names must not end with "{extension}".',{extension:y.segment});break;default:u=v("Invalid folder name.")}}return h&&h.setCustomValidity(u),u===""}const o=function(){const l=s.value.trim();a()&&(r.value=!1,t("create-node",l),s.value="")},c=p(()=>i.path.split("/").filter(l=>l!=="").map((l,h,u)=>({name:l,path:"/"+u.slice(0,h+1).join("/")})));return{__sfc:!0,props:i,emit:t,actionsOpen:r,newNodeName:s,nameInput:n,validateInput:a,onSubmit:o,pathElements:c,NcActionInput:qe,NcActions:Y,NcBreadcrumb:ve,NcBreadcrumbs:Bt,IconFolder:Se,IconHome:Mi,IconPlus:Wi,t:v}}});var Zi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[t(i.NcBreadcrumb,{attrs:{name:i.t("All files"),title:i.t("Home")},on:{click:function(r){return i.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(i.pathElements,function(r){return t(i.NcBreadcrumb,{key:r.path,attrs:{name:r.name,title:r.path},on:{click:function(s){return i.emit("update:path",r.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[t(i.NcActions,{attrs:{open:i.actionsOpen,"aria-label":i.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":i.t("New"),type:"secondary"},on:{"update:open":function(r){i.actionsOpen=r},close:function(r){i.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[t(i.NcActionInput,{ref:"nameInput",attrs:{value:i.newNodeName,label:i.t("New folder"),placeholder:i.t("New folder name")},on:{"update:value":function(r){i.newNodeName=r},submit:i.onSubmit,"update:model-value":i.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},ji=[],Ui=b(qi,Zi,ji,!1,null,"1a8cb0b2");const Gi=Ui.exports,Yi={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ki=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Qi=[],Ji=b(Yi,Ki,Qi,!1,null,null);const Xi=Ji.exports,er={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var tr=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ir=[],rr=b(er,tr,ir,!1,null,null);const sr=rr.exports,nr=e=>{const t=[{id:"files",label:v("All files"),icon:Vt},{id:"recent",label:v("Recent"),icon:$t},{id:"favorites",label:v("Favorites"),icon:Mt}],i=e.value?t.filter(({id:r})=>r==="files"):t;return{allViews:t,availableViews:i}},ar=F({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:t}){const i=e,{availableViews:r}=nr(f(ze()===null)),s=p(()=>r.filter(n=>n.id===i.currentView)[0]??r[0]);return{__sfc:!0,props:i,emit:t,availableViews:r,currentViewObject:s,updateFilterValue:n=>t("update:filterString",n),IconClose:Xi,IconMagnify:sr,NcButton:G,NcIconSvgWrapper:fe,NcSelect:Ke,NcTextField:Qe,Fragment:_e,t:v}}});var or=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.Fragment,[t(i.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:i.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":i.updateFilterValue,"trailing-button-click":function(r){return i.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[t(i.IconClose,{attrs:{size:16}})]},proxy:!0}])},[t(i.IconMagnify,{attrs:{size:16}})],1),i.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?t(i.NcSelect,{attrs:{"aria-label":i.t("Current view selector"),clearable:!1,searchable:!1,options:i.availableViews,"model-value":i.currentViewObject},on:{"update:model-value":function(r){return i.emit("update:currentView",r.id)}}}):t("ul",{staticClass:"file-picker__side"},e._l(i.availableViews,function(r){return t("li",{key:r.id},[t(i.NcButton,{attrs:{type:e.currentView===r.id?"primary":"tertiary",wide:!0},on:{click:function(s){return e.$emit("update:currentView",r.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.NcIconSvgWrapper,{attrs:{path:r.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(r.label)+" ")])],1)}),0)]:e._e()],2)},lr=[],cr=b(ar,or,lr,!1,null,"f5975252");const ur=cr.exports;function dr(e){const t=new AbortController,i=Math.round(Date.now()/1e3)-60*60*24*14;return new de(async(r,s,n)=>{n(()=>t.abort());try{const{data:a}=await e.search("/",{signal:t.signal,details:!0,data:Ae(i)}),o=a.results.map(c=>U(c));r(o)}catch(a){s(a)}})}function pr(e,t){const i=new AbortController;return new de(async(r,s,n)=>{n(()=>i.abort());try{const a=(await e.getDirectoryContents(M.join(j,t),{signal:i.signal,details:!0,includeSelf:!0,data:pe()})).data.map(o=>U(o));r({contents:a.filter(({path:o})=>o!==t),folder:a.find(({path:o})=>o===t)})}catch(a){s(a)}})}async function hr(e,t){const{data:i}=await e.stat(M.join(j,t),{details:!0,data:pe()});return U(i)}const fr=function(e,t){const i=Pe(),r=q([]),s=q(null),n=f(!0),a=f(null);async function o(l){const h=M.join(t.value,l);await i.createDirectory(M.join(j,h));const u=await hr(i,h);return r.value=[...r.value,u],u}async function c(){a.value&&a.value.cancel(),n.value=!0,e.value==="favorites"?a.value=Be(i,t.value):e.value==="recent"?a.value=dr(i):a.value=pr(i,t.value);const l=await a.value;"folder"in l?(s.value=l.folder,r.value=l.contents):(s.value=null,r.value=l),a.value=null,n.value=!1}return ce([e,t],()=>c()),$(()=>c()),{isLoading:n,files:r,folder:s,loadFiles:c,createDirectory:o}},mr=function(e){const t=p(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const r=i.split("/");return t.value.some(([s,n])=>(r[0]===s||s==="*")&&(r[1]===n||n==="*"))}}},vr={name:"FilePicker"},gr=F({...vr,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},canPickFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:t}){const i=e,r=f(!0),s=p(()=>{const d=l.value.length===0&&i.allowPickDirectory&&C.value?[C.value]:l.value;return(typeof i.buttons=="function"?i.buttons(d,y.value,o.value):i.buttons).map(m=>({...m,disabled:m.disabled||V.value,callback:()=>{n=!0,a(m.callback,d)}}))});let n=!1;const a=async(d,m)=>{d(m),t("close",m),n=!1},o=f("files"),c=p(()=>o.value==="favorites"?v("Favorites"):o.value==="recent"?v("Recent"):""),l=q([]),h=f(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),u=f("");ce([u],()=>{i.path===void 0&&u.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",u.value),l.value=[]});const y=p({get:()=>o.value==="files"?u.value||i.path||h.value:"/",set:d=>{u.value=d}}),w=f(""),{isSupportedMimeType:k}=mr(ue(i,"mimetypeFilter")),{files:S,folder:C,isLoading:V,loadFiles:x,createDirectory:N}=fr(o,y);$(()=>x());const{showHiddenFiles:g}=Ce(),L=p(()=>{let d=S.value;return g.value||(d=d.filter(m=>!m.basename.startsWith("."))),i.mimetypeFilter.length>0&&(d=d.filter(m=>m.type==="folder"||m.mime&&k(m.mime))),w.value&&(d=d.filter(m=>m.basename.toLowerCase().includes(w.value.toLowerCase()))),i.filterFn&&(d=d.filter(m=>i.filterFn(m))),d}),A=p(()=>o.value==="files"?v("Upload some content or sync with your devices!"):o.value==="recent"?v("Files and folders you recently modified will show up here."):v("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:i,emit:t,isOpen:r,dialogButtons:s,isHandlingCallback:n,handleButtonClick:a,currentView:o,viewHeadline:c,selectedFiles:l,savedPath:h,navigatedPath:u,currentPath:y,filterString:w,isSupportedMimeType:k,files:S,currentFolder:C,isLoading:V,loadFiles:x,createDirectory:N,showHiddenFiles:g,filteredFiles:L,noFilesDescription:A,onCreateFolder:async d=>{try{const m=await N(d);u.value=m.path,Ie("files:node:created",S.value.filter(Ne=>Ne.basename===d)[0])}catch(m){console.warn("Could not create new folder",{name:d,error:m}),K(v("Could not create the new folder"))}},handleClose:d=>{!d&&!n&&t("close")},IconFile:we,FileList:$i,FilePickerBreadcrumbs:Gi,FilePickerNavigation:ur,NcDialog:Je,NcEmptyContent:Xe,t:v}}});var yr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcDialog,{attrs:{open:i.isOpen,container:e.container,buttons:i.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(r){i.isOpen=r},i.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:r}){return[t(i.FilePickerNavigation,{attrs:{"current-view":i.currentView,"filter-string":i.filterString,"is-collapsed":r,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(s){i.currentView=s},"update:current-view":function(s){i.currentView=s},"update:filterString":function(s){i.filterString=s},"update:filter-string":function(s){i.filterString=s}}})]}}])},[t("div",{staticClass:"file-picker__main"},[i.currentView==="files"?t(i.FilePickerBreadcrumbs,{attrs:{path:i.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(r){i.currentPath=r},"create-node":i.onCreateFolder}}):t("div",{staticClass:"file-picker__view"},[t("h3",[e._v(e._s(i.viewHeadline))])]),i.isLoading||i.filteredFiles.length>0?t(i.FileList,{attrs:{path:i.currentPath,"selected-files":i.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":i.currentView,files:i.filteredFiles,multiselect:e.multiselect,loading:i.isLoading,name:i.viewHeadline,"can-pick":e.canPickFn},on:{"update:path":[function(r){i.currentPath=r},function(r){i.currentView="files"}],"update:selectedFiles":function(r){i.selectedFiles=r},"update:selected-files":function(r){i.selectedFiles=r}}}):i.filterString?t(i.NcEmptyContent,{attrs:{name:i.t("No matching files"),description:i.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])}):t(i.NcEmptyContent,{attrs:{name:i.t("No files in here"),description:i.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])})],1)])},_r=[],br=b(gr,yr,_r,!1,null,"dda9b42b");const Wr=br.exports;export{Wr as default};
//# sourceMappingURL=FilePicker-JKNLPCbR-DOt36T6N.chunk.mjs.map

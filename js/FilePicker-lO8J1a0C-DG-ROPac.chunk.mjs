import{$ as bt,a0 as At,a1 as Ct,D as St,u as ae,a2 as Lt,a3 as Dt,l as Rt,k as nt,a4 as fe,a5 as Ft,X as Ot,d as j,f as b,c as I,a6 as be,w as rt,e as at,z as J,a7 as Pt,h as Ae,U as kt,o as xt,m as $t}from"./index-Cyn8tcq_.chunk.mjs";import{a5 as P,a6 as S,i as Mt,s as Ce,V as st,a7 as ne,J as ot,k as ct,z as Vt}from"./index-DX2SbTk6.chunk.mjs";import{C as Se,r as Bt}from"./string_decoder-CWm048B_.chunk.mjs";import{N as lt}from"./NcCheckboxRadioSwitch-DAPHFb0L-C5yI6tHT.chunk.mjs";import{N as Ut}from"./NcDateTime-enXYuwj8-DgMXXVsl.chunk.mjs";import{E as Ht}from"./index-BEAJDltQ.chunk.mjs";import{f as zt,N as Gt,a as Xt,b as jt}from"./NcBreadcrumbs-BPfsSByZ-BD4lMBVt.chunk.mjs";import{N as qt}from"./NcSelect-DTniMiUS-BSLDsywC.chunk.mjs";import{N as Yt}from"./NcTextField-CfZknuqx-NIse9ogT.chunk.mjs";import{N as Wt}from"./NcEmptyContent-BUSMgf3R.chunk.mjs";import"./index-BKNYV8jx.chunk.mjs";import"./useModelMigration-EhAWvqDD-B5MytT5w.chunk.mjs";import"./useFormatDateTime-BLrrQzS3.chunk.mjs";import"./NcActionButton-DykQxmXJ-DfC4xMBk.chunk.mjs";import"./index-BZR1y71w.chunk.mjs";import"./NcAvatar-D5nljVEA-CqudfoYn.chunk.mjs";import"./createElementId-DhjFt1I9-B2HCdIOx.chunk.mjs";function se(e,t,i){const a=`#initial-state-${e}-${t}`;if(window._nc_initial_state?.has(a))return window._nc_initial_state.get(a);window._nc_initial_state||(window._nc_initial_state=new Map);const l=document.querySelector(a);if(l===null)return i;try{const f=JSON.parse(atob(l.value));return window._nc_initial_state.set(a,f),f}catch(f){return console.error("[@nextcloud/initial-state] Could not parse initial state",{key:t,app:e,error:f}),i}}function ee(){return se("files_sharing","isPublic",null)??document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function Zt(){return se("files_sharing","sharingToken",null)??document.querySelector('input#sharingToken[type="hidden"]')?.value??null}function Qt(e){return e&&e.split("/").map(encodeURIComponent).join("/")}function ut(e,t){return e=e.replace(/\\/g,"/").replace(/\/+$/g,"").replace(/.*\//,""),e}function ie(e){e=e.replaceAll(/\\/g,"/");const t=e.split("/");return t.length<=1?".":(t.pop(),t.length===1&&t[0]===""?"/":t.join("/"))}function Kt(e){const t=ut(e),i=t.lastIndexOf(".");return i>0?t.substring(i):""}function Jt(...e){if(arguments.length<1)return"";const t=e.filter(u=>u.length>0);if(t.length<1)return"";const i=t[t.length-1],a=t[0].charAt(0)==="/",l=i.charAt(i.length-1)==="/",f=t.reduce((u,d)=>u.concat(d.split("/")),[]);let h=!a;const m=f.reduce((u,d)=>d===""?u:h?(h=!1,u+d):u+"/"+d,"");return l?m+"/":m}const ei=Lt().setApp("@nextcloud/files").detectUser().build();var z=(e=>(e.Folder="folder",e.File="file",e))(z||{}),M=(e=>(e[e.NONE=0]="NONE",e[e.CREATE=4]="CREATE",e[e.READ=1]="READ",e[e.UPDATE=2]="UPDATE",e[e.DELETE=8]="DELETE",e[e.SHARE=16]="SHARE",e[e.ALL=31]="ALL",e))(M||{});const dt=function(e,t){return e.match(t)!==null},G=(e,t)=>{if(e.id&&typeof e.id!="number")throw new Error("Invalid id type of value");if(!e.source)throw new Error("Missing mandatory source");try{new URL(e.source)}catch{throw new Error("Invalid source format, source must be a valid URL")}if(!e.source.startsWith("http"))throw new Error("Invalid source format, only http(s) is supported");if(e.displayname&&typeof e.displayname!="string")throw new Error("Invalid displayname type");if(e.mtime&&!(e.mtime instanceof Date))throw new Error("Invalid mtime type");if(e.crtime&&!(e.crtime instanceof Date))throw new Error("Invalid crtime type");if(!e.mime||typeof e.mime!="string"||!e.mime.match(/^[-\w.]+\/[-+\w.]+$/gi))throw new Error("Missing or invalid mandatory mime");if("size"in e&&typeof e.size!="number"&&e.size!==void 0)throw new Error("Invalid size type");if("permissions"in e&&e.permissions!==void 0&&!(typeof e.permissions=="number"&&e.permissions>=M.NONE&&e.permissions<=M.ALL))throw new Error("Invalid permissions");if(e.owner&&e.owner!==null&&typeof e.owner!="string")throw new Error("Invalid owner type");if(e.attributes&&typeof e.attributes!="object")throw new Error("Invalid attributes type");if(e.root&&typeof e.root!="string")throw new Error("Invalid root type");if(e.root&&!e.root.startsWith("/"))throw new Error("Root must start with a leading slash");if(e.root&&!e.source.includes(e.root))throw new Error("Root must be part of the source");if(e.root&&dt(e.source,t)){const i=e.source.match(t)[0];if(!e.source.includes(Jt(i,e.root)))throw new Error("The root must be relative to the service. e.g /files/emma")}if(e.status&&!Object.values(Le).includes(e.status))throw new Error("Status must be a valid NodeStatus")};var Le=(e=>(e.NEW="new",e.FAILED="failed",e.LOADING="loading",e.LOCKED="locked",e))(Le||{});class oe{_data;_attributes;_knownDavService=/(remote|public)\.php\/(web)?dav/i;readonlyAttributes=Object.entries(Object.getOwnPropertyDescriptors(oe.prototype)).filter(t=>typeof t[1].get=="function"&&t[0]!=="__proto__").map(t=>t[0]);handler={set:(t,i,a)=>this.readonlyAttributes.includes(i)?!1:Reflect.set(t,i,a),deleteProperty:(t,i)=>this.readonlyAttributes.includes(i)?!1:Reflect.deleteProperty(t,i),get:(t,i,a)=>this.readonlyAttributes.includes(i)?(ei.warn(`Accessing "Node.attributes.${i}" is deprecated, access it directly on the Node instance.`),Reflect.get(this,i)):Reflect.get(t,i,a)};constructor(t,i){t.mime||(t.mime="application/octet-stream"),G(t,i||this._knownDavService),this._data={displayname:t.attributes?.displayname,...t,attributes:{}},this._attributes=new Proxy(this._data.attributes,this.handler),this.update(t.attributes??{}),i&&(this._knownDavService=i)}get source(){return this._data.source.replace(/\/$/i,"")}get encodedSource(){const{origin:t}=new URL(this.source);return t+Qt(this.source.slice(t.length))}get basename(){return ut(this.source)}get displayname(){return this._data.displayname||this.basename}set displayname(t){G({...this._data,displayname:t},this._knownDavService),this._data.displayname=t}get extension(){return Kt(this.source)}get dirname(){if(this.root){let i=this.source;this.isDavResource&&(i=i.split(this._knownDavService).pop());const a=i.indexOf(this.root),l=this.root.replace(/\/$/,"");return ie(i.slice(a+l.length)||"/")}const t=new URL(this.source);return ie(t.pathname)}get mime(){return this._data.mime||"application/octet-stream"}set mime(t){t??="application/octet-stream",G({...this._data,mime:t},this._knownDavService),this._data.mime=t}get mtime(){return this._data.mtime}set mtime(t){G({...this._data,mtime:t},this._knownDavService),this._data.mtime=t}get crtime(){return this._data.crtime}get size(){return this._data.size}set size(t){G({...this._data,size:t},this._knownDavService),this.updateMtime(),this._data.size=t}get attributes(){return this._attributes}get permissions(){return this.owner===null&&!this.isDavResource?M.READ:this._data.permissions!==void 0?this._data.permissions:M.NONE}set permissions(t){G({...this._data,permissions:t},this._knownDavService),this.updateMtime(),this._data.permissions=t}get owner(){return this.isDavResource?this._data.owner:null}get isDavResource(){return dt(this.source,this._knownDavService)}get isDavRessource(){return this.isDavResource}get root(){return this._data.root?this._data.root.replace(/^(.+)\/$/,"$1"):this.isDavResource&&ie(this.source).split(this._knownDavService).pop()||null}get path(){if(this.root){let t=this.source;this.isDavResource&&(t=t.split(this._knownDavService).pop());const i=t.indexOf(this.root),a=this.root.replace(/\/$/,"");return t.slice(i+a.length)||"/"}return(this.dirname+"/"+this.basename).replace(/\/\//g,"/")}get fileid(){return this._data?.id}get status(){return this._data?.status}set status(t){G({...this._data,status:t},this._knownDavService),this._data.status=t}get data(){return structuredClone(this._data)}move(t){G({...this._data,source:t},this._knownDavService);const i=this.basename;this._data.source=t,this.displayname===i&&this.basename!==i&&(this.displayname=this.basename)}rename(t){if(t.includes("/"))throw new Error("Invalid basename");this.move(ie(this.source)+"/"+t)}updateMtime(){this._data.mtime&&(this._data.mtime=new Date)}update(t){for(const[i,a]of Object.entries(t))try{a===void 0?delete this.attributes[i]:this.attributes[i]=a}catch(l){if(l instanceof TypeError)continue;throw l}}}class De extends oe{get type(){return z.File}clone(){return new De(this.data)}}class Re extends oe{constructor(t){super({...t,mime:"httpd/unix-directory"})}get type(){return z.Folder}get extension(){return null}get mime(){return"httpd/unix-directory"}clone(){return new Re(this.data)}}const ti=function(e=""){let t=M.NONE;return e&&((e.includes("C")||e.includes("K"))&&(t|=M.CREATE),e.includes("G")&&(t|=M.READ),(e.includes("W")||e.includes("N")||e.includes("V"))&&(t|=M.UPDATE),e.includes("D")&&(t|=M.DELETE),e.includes("R")&&(t|=M.SHARE)),t},ii=["d:getcontentlength","d:getcontenttype","d:getetag","d:getlastmodified","d:creationdate","d:displayname","d:quota-available-bytes","d:resourcetype","nc:has-preview","nc:is-encrypted","nc:mount-type","oc:comments-unread","oc:favorite","oc:fileid","oc:owner-display-name","oc:owner-id","oc:permissions","oc:size"],ni={d:"DAV:",nc:"http://nextcloud.org/ns",oc:"http://owncloud.org/ns",ocs:"http://open-collaboration-services.org/ns"},Fe=function(){return typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...ii]),window._nc_dav_properties.map(e=>`<${e} />`).join(" ")},Oe=function(){return typeof window._nc_dav_namespaces>"u"&&(window._nc_dav_namespaces={...ni}),Object.keys(window._nc_dav_namespaces).map(e=>`xmlns:${e}="${window._nc_dav_namespaces?.[e]}"`).join(" ")},pt=function(){return`<?xml version="1.0"?>
		<d:propfind ${Oe()}>
			<d:prop>
				${Fe()}
			</d:prop>
		</d:propfind>`},ri=function(){return`<?xml version="1.0"?>
		<oc:filter-files ${Oe()}>
			<d:prop>
				${Fe()}
			</d:prop>
			<oc:filter-rules>
				<oc:favorite>1</oc:favorite>
			</oc:filter-rules>
		</oc:filter-files>`},ai=function(e){return`<?xml version="1.0" encoding="UTF-8"?>
<d:searchrequest ${Oe()}
	xmlns:ns="https://github.com/icewind1991/SearchDAV/ns">
	<d:basicsearch>
		<d:select>
			<d:prop>
				${Fe()}
			</d:prop>
		</d:select>
		<d:from>
			<d:scope>
				<d:href>/files/${ae()?.uid}/</d:href>
				<d:depth>infinity</d:depth>
			</d:scope>
		</d:from>
		<d:where>
			<d:and>
				<d:or>
					<d:not>
						<d:eq>
							<d:prop>
								<d:getcontenttype/>
							</d:prop>
							<d:literal>httpd/unix-directory</d:literal>
						</d:eq>
					</d:not>
					<d:eq>
						<d:prop>
							<oc:size/>
						</d:prop>
						<d:literal>0</d:literal>
					</d:eq>
				</d:or>
				<d:gt>
					<d:prop>
						<d:getlastmodified/>
					</d:prop>
					<d:literal>${e}</d:literal>
				</d:gt>
			</d:and>
		</d:where>
		<d:orderby>
			<d:order>
				<d:prop>
					<d:getlastmodified/>
				</d:prop>
				<d:descending/>
			</d:order>
		</d:orderby>
		<d:limit>
			<d:nresults>100</d:nresults>
			<ns:firstresult>0</ns:firstresult>
		</d:limit>
	</d:basicsearch>
</d:searchrequest>`};function si(){return ee()?`/files/${Zt()}`:`/files/${ae()?.uid}`}const te=si();function oi(){const e=St("dav");return ee()?e.replace("remote.php","public.php"):e}const ft=oi(),ci=function(e=ft,t={}){const i=bt(e,{headers:t});function a(l){i.setHeaders({...t,"X-Requested-With":"XMLHttpRequest",requesttoken:l??""})}return Dt(a),a(At()),Ct().patch("fetch",(l,f)=>{const h=f.headers;return h?.method&&(f.method=h.method,delete h.method),fetch(l,f)}),i},li=(e,t="/",i=te)=>{const a=new AbortController;return new Se(async(l,f,h)=>{h(()=>a.abort());try{const m=(await e.getDirectoryContents(`${i}${t}`,{signal:a.signal,details:!0,data:ri(),headers:{method:"REPORT"},includeSelf:!0})).data.filter(u=>u.filename!==t).map(u=>ce(u,i));l(m)}catch(m){f(m)}})},ce=function(e,t=te,i=ft){let a=ae()?.uid;if(ee())a=a??"anonymous";else if(!a)throw new Error("No user id found");const l=e.props,f=ti(l?.permissions),h=String(l?.["owner-id"]||a),m=l.fileid||0,u=new Date(Date.parse(e.lastmod)),d=new Date(Date.parse(l.creationdate)),c={id:m,source:`${i}${e.filename}`,mtime:!isNaN(u.getTime())&&u.getTime()!==0?u:void 0,crtime:!isNaN(d.getTime())&&d.getTime()!==0?d:void 0,mime:e.mime||"application/octet-stream",displayname:l.displayname!==void 0?String(l.displayname):void 0,size:l?.size||Number.parseInt(l.getcontentlength||"0"),status:m<0?Le.FAILED:void 0,permissions:f,owner:h,root:t,attributes:{...e,...l,hasPreview:l?.["has-preview"]}};return delete c.attributes?.props,e.type==="file"?new De(c):new Re(c)};var he={},He,ze;function ht(){return ze||(ze=1,He=typeof Ft=="object"&&he&&he.NODE_DEBUG&&/\bsemver\b/i.test(he.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{}),He}var me,Ge;function mt(){if(Ge)return me;Ge=1;const e="2.0.0",t=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,a=16,l=t-6;return me={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:l,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},me}var Ee={exports:{}},Xe;function ui(){return Xe||(Xe=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:a,MAX_LENGTH:l}=mt(),f=ht();t=e.exports={};const h=t.re=[],m=t.safeRe=[],u=t.src=[],d=t.safeSrc=[],c=t.t={};let E=0;const _="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",l],[_,a]],U=R=>{for(const[F,$]of y)R=R.split(`${F}*`).join(`${F}{0,${$}}`).split(`${F}+`).join(`${F}{1,${$}}`);return R},g=(R,F,$)=>{const V=U(F),v=E++;f(R,v,F),c[R]=v,u[v]=F,d[v]=V,h[v]=new RegExp(F,$?"g":void 0),m[v]=new RegExp(V,$?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${_}*`),g("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${u[c.NONNUMERICIDENTIFIER]}|${u[c.NUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NONNUMERICIDENTIFIER]}|${u[c.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${_}+`),g("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),g("FULL",`^${u[c.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),g("LOOSE",`^${u[c.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),g("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),g("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?(?:${u[c.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",u[c.COERCE],!0),g("COERCERTLFULL",u[c.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Ee,Ee.exports)),Ee.exports}var ge,je;function di(){if(je)return ge;je=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return ge=i=>i?typeof i!="object"?e:i:t,ge}var ve,qe;function pi(){if(qe)return ve;qe=1;const e=/^[0-9]+$/,t=(i,a)=>{if(typeof i=="number"&&typeof a=="number")return i===a?0:i<a?-1:1;const l=e.test(i),f=e.test(a);return l&&f&&(i=+i,a=+a),i===a?0:l&&!f?-1:f&&!l?1:i<a?-1:1};return ve={compareIdentifiers:t,rcompareIdentifiers:(i,a)=>t(a,i)},ve}var _e,Ye;function Et(){if(Ye)return _e;Ye=1;const e=ht(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:i}=mt(),{safeRe:a,t:l}=ui(),f=di(),{compareIdentifiers:h}=pi();class m{constructor(d,c){if(c=f(c),d instanceof m){if(d.loose===!!c.loose&&d.includePrerelease===!!c.includePrerelease)return d;d=d.version}else if(typeof d!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof d}".`);if(d.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",d,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const E=d.trim().match(c.loose?a[l.LOOSE]:a[l.FULL]);if(!E)throw new TypeError(`Invalid Version: ${d}`);if(this.raw=d,this.major=+E[1],this.minor=+E[2],this.patch=+E[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");E[4]?this.prerelease=E[4].split(".").map(_=>{if(/^[0-9]+$/.test(_)){const y=+_;if(y>=0&&y<i)return y}return _}):this.prerelease=[],this.build=E[5]?E[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(d){if(e("SemVer.compare",this.version,this.options,d),!(d instanceof m)){if(typeof d=="string"&&d===this.version)return 0;d=new m(d,this.options)}return d.version===this.version?0:this.compareMain(d)||this.comparePre(d)}compareMain(d){return d instanceof m||(d=new m(d,this.options)),this.major<d.major?-1:this.major>d.major?1:this.minor<d.minor?-1:this.minor>d.minor?1:this.patch<d.patch?-1:this.patch>d.patch?1:0}comparePre(d){if(d instanceof m||(d=new m(d,this.options)),this.prerelease.length&&!d.prerelease.length)return-1;if(!this.prerelease.length&&d.prerelease.length)return 1;if(!this.prerelease.length&&!d.prerelease.length)return 0;let c=0;do{const E=this.prerelease[c],_=d.prerelease[c];if(e("prerelease compare",c,E,_),E===void 0&&_===void 0)return 0;if(_===void 0)return 1;if(E===void 0)return-1;if(E!==_)return h(E,_)}while(++c)}compareBuild(d){d instanceof m||(d=new m(d,this.options));let c=0;do{const E=this.build[c],_=d.build[c];if(e("build compare",c,E,_),E===void 0&&_===void 0)return 0;if(_===void 0)return 1;if(E===void 0)return-1;if(E!==_)return h(E,_)}while(++c)}inc(d,c,E){if(d.startsWith("pre")){if(!c&&E===!1)throw new Error("invalid increment argument: identifier is empty");if(c){const _=`-${c}`.match(this.options.loose?a[l.PRERELEASELOOSE]:a[l.PRERELEASE]);if(!_||_[1]!==c)throw new Error(`invalid identifier: ${c}`)}}switch(d){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,E);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,E);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,E),this.inc("pre",c,E);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,E),this.inc("pre",c,E);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const _=Number(E)?1:0;if(this.prerelease.length===0)this.prerelease=[_];else{let y=this.prerelease.length;for(;--y>=0;)typeof this.prerelease[y]=="number"&&(this.prerelease[y]++,y=-2);if(y===-1){if(c===this.prerelease.join(".")&&E===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(_)}}if(c){let y=[c,_];E===!1&&(y=[c]),h(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=y):this.prerelease=y}break}default:throw new Error(`invalid increment argument: ${d}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return _e=m,_e}var we,We;function fi(){if(We)return we;We=1;const e=Et();return we=(t,i)=>new e(t,i).major,we}fi();var ye,Ze;function hi(){if(Ze)return ye;Ze=1;const e=Et();return ye=(t,i,a=!1)=>{if(t instanceof e)return t;try{return new e(t,i)}catch(l){if(!a)return null;throw l}},ye}var Ne,Qe;function mi(){if(Qe)return Ne;Qe=1;const e=hi();return Ne=(t,i)=>{const a=e(t,i);return a?a.version:null},Ne}mi();var Ke={},Je;function Ei(){return Je||(Je=1,function(e){(function(t){t.parser=function(r,n){return new a(r,n)},t.SAXParser=a,t.SAXStream=c,t.createStream=d,t.MAX_BUFFER_LENGTH=64*1024;var i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function a(r,n){if(!(this instanceof a))return new a(r,n);var p=this;f(p),p.q=p.c="",p.bufferCheckPosition=t.MAX_BUFFER_LENGTH,p.opt=n||{},p.opt.lowercase=p.opt.lowercase||p.opt.lowercasetags,p.looseCase=p.opt.lowercase?"toLowerCase":"toUpperCase",p.tags=[],p.closed=p.closedRoot=p.sawRoot=!1,p.tag=p.error=null,p.strict=!!r,p.noscript=!!(r||p.opt.noscript),p.state=o.BEGIN,p.strictEntities=p.opt.strictEntities,p.ENTITIES=p.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),p.attribList=[],p.opt.xmlns&&(p.ns=Object.create(g)),p.opt.unquotedAttributeValues===void 0&&(p.opt.unquotedAttributeValues=!r),p.trackPosition=p.opt.position!==!1,p.trackPosition&&(p.position=p.line=p.column=0),W(p,"onready")}Object.create||(Object.create=function(r){function n(){}n.prototype=r;var p=new n;return p}),Object.keys||(Object.keys=function(r){var n=[];for(var p in r)r.hasOwnProperty(p)&&n.push(p);return n});function l(r){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),p=0,s=0,N=i.length;s<N;s++){var L=r[i[s]].length;if(L>n)switch(i[s]){case"textNode":Z(r);break;case"cdata":C(r,"oncdata",r.cdata),r.cdata="";break;case"script":C(r,"onscript",r.script),r.script="";break;default:Q(r,"Max buffer length exceeded: "+i[s])}p=Math.max(p,L)}var D=t.MAX_BUFFER_LENGTH-p;r.bufferCheckPosition=D+r.position}function f(r){for(var n=0,p=i.length;n<p;n++)r[i[n]]=""}function h(r){Z(r),r.cdata!==""&&(C(r,"oncdata",r.cdata),r.cdata=""),r.script!==""&&(C(r,"onscript",r.script),r.script="")}a.prototype={end:function(){$e(this)},write:Tt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){h(this)}};var m;try{m=require("stream").Stream}catch{m=function(){}}m||(m=function(){});var u=t.EVENTS.filter(function(r){return r!=="error"&&r!=="end"});function d(r,n){return new c(r,n)}function c(r,n){if(!(this instanceof c))return new c(r,n);m.apply(this),this._parser=new a(r,n),this.writable=!0,this.readable=!0;var p=this;this._parser.onend=function(){p.emit("end")},this._parser.onerror=function(s){p.emit("error",s),p._parser.error=null},this._decoder=null,u.forEach(function(s){Object.defineProperty(p,"on"+s,{get:function(){return p._parser["on"+s]},set:function(N){if(!N)return p.removeAllListeners(s),p._parser["on"+s]=N,N;p.on(s,N)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(m.prototype,{constructor:{value:c}}),c.prototype.write=function(r){if(typeof fe=="function"&&typeof fe.isBuffer=="function"&&fe.isBuffer(r)){if(!this._decoder){var n=Bt.StringDecoder;this._decoder=new n("utf8")}r=this._decoder.write(r)}return this._parser.write(r.toString()),this.emit("data",r),!0},c.prototype.end=function(r){return r&&r.length&&this.write(r),this._parser.end(),!0},c.prototype.on=function(r,n){var p=this;return!p._parser["on"+r]&&u.indexOf(r)!==-1&&(p._parser["on"+r]=function(){var s=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);s.splice(0,0,r),p.emit.apply(p,s)}),m.prototype.on.call(p,r,n)};var E="[CDATA[",_="DOCTYPE",y="http://www.w3.org/XML/1998/namespace",U="http://www.w3.org/2000/xmlns/",g={xml:y,xmlns:U},R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,F=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,$=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,V=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function v(r){return r===" "||r===`
`||r==="\r"||r==="	"}function B(r){return r==='"'||r==="'"}function q(r){return r===">"||v(r)}function w(r,n){return r.test(n)}function A(r,n){return!w(r,n)}var o=0;t.STATE={BEGIN:o++,BEGIN_WHITESPACE:o++,TEXT:o++,TEXT_ENTITY:o++,OPEN_WAKA:o++,SGML_DECL:o++,SGML_DECL_QUOTED:o++,DOCTYPE:o++,DOCTYPE_QUOTED:o++,DOCTYPE_DTD:o++,DOCTYPE_DTD_QUOTED:o++,COMMENT_STARTING:o++,COMMENT:o++,COMMENT_ENDING:o++,COMMENT_ENDED:o++,CDATA:o++,CDATA_ENDING:o++,CDATA_ENDING_2:o++,PROC_INST:o++,PROC_INST_BODY:o++,PROC_INST_ENDING:o++,OPEN_TAG:o++,OPEN_TAG_SLASH:o++,ATTRIB:o++,ATTRIB_NAME:o++,ATTRIB_NAME_SAW_WHITE:o++,ATTRIB_VALUE:o++,ATTRIB_VALUE_QUOTED:o++,ATTRIB_VALUE_CLOSED:o++,ATTRIB_VALUE_UNQUOTED:o++,ATTRIB_VALUE_ENTITY_Q:o++,ATTRIB_VALUE_ENTITY_U:o++,CLOSE_TAG:o++,CLOSE_TAG_SAW_WHITE:o++,SCRIPT:o++,SCRIPT_ENDING:o++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(r){var n=t.ENTITIES[r],p=typeof n=="number"?String.fromCharCode(n):n;t.ENTITIES[r]=p});for(var ke in t.STATE)t.STATE[t.STATE[ke]]=ke;o=t.STATE;function W(r,n,p){r[n]&&r[n](p)}function C(r,n,p){r.textNode&&Z(r),W(r,n,p)}function Z(r){r.textNode=xe(r.opt,r.textNode),r.textNode&&W(r,"ontext",r.textNode),r.textNode=""}function xe(r,n){return r.trim&&(n=n.trim()),r.normalize&&(n=n.replace(/\s+/g," ")),n}function Q(r,n){return Z(r),r.trackPosition&&(n+=`
Line: `+r.line+`
Column: `+r.column+`
Char: `+r.c),n=new Error(n),r.error=n,W(r,"onerror",n),r}function $e(r){return r.sawRoot&&!r.closedRoot&&T(r,"Unclosed root tag"),r.state!==o.BEGIN&&r.state!==o.BEGIN_WHITESPACE&&r.state!==o.TEXT&&Q(r,"Unexpected end"),Z(r),r.c="",r.closed=!0,W(r,"onend"),a.call(r,r.strict,r.opt),r}function T(r,n){if(typeof r!="object"||!(r instanceof a))throw new Error("bad call to strictFail");r.strict&&Q(r,n)}function yt(r){r.strict||(r.tagName=r.tagName[r.looseCase]());var n=r.tags[r.tags.length-1]||r,p=r.tag={name:r.tagName,attributes:{}};r.opt.xmlns&&(p.ns=n.ns),r.attribList.length=0,C(r,"onopentagstart",p)}function le(r,n){var p=r.indexOf(":"),s=p<0?["",r]:r.split(":"),N=s[0],L=s[1];return n&&r==="xmlns"&&(N="xmlns",L=""),{prefix:N,local:L}}function ue(r){if(r.strict||(r.attribName=r.attribName[r.looseCase]()),r.attribList.indexOf(r.attribName)!==-1||r.tag.attributes.hasOwnProperty(r.attribName)){r.attribName=r.attribValue="";return}if(r.opt.xmlns){var n=le(r.attribName,!0),p=n.prefix,s=n.local;if(p==="xmlns")if(s==="xml"&&r.attribValue!==y)T(r,"xml: prefix must be bound to "+y+`
Actual: `+r.attribValue);else if(s==="xmlns"&&r.attribValue!==U)T(r,"xmlns: prefix must be bound to "+U+`
Actual: `+r.attribValue);else{var N=r.tag,L=r.tags[r.tags.length-1]||r;N.ns===L.ns&&(N.ns=Object.create(L.ns)),N.ns[s]=r.attribValue}r.attribList.push([r.attribName,r.attribValue])}else r.tag.attributes[r.attribName]=r.attribValue,C(r,"onattribute",{name:r.attribName,value:r.attribValue});r.attribName=r.attribValue=""}function X(r,n){if(r.opt.xmlns){var p=r.tag,s=le(r.tagName);p.prefix=s.prefix,p.local=s.local,p.uri=p.ns[s.prefix]||"",p.prefix&&!p.uri&&(T(r,"Unbound namespace prefix: "+JSON.stringify(r.tagName)),p.uri=s.prefix);var N=r.tags[r.tags.length-1]||r;p.ns&&N.ns!==p.ns&&Object.keys(p.ns).forEach(function(Ue){C(r,"onopennamespace",{prefix:Ue,uri:p.ns[Ue]})});for(var L=0,D=r.attribList.length;L<D;L++){var k=r.attribList[L],x=k[0],Y=k[1],O=le(x,!0),H=O.prefix,It=O.local,Be=H===""?"":p.ns[H]||"",pe={name:x,value:Y,prefix:H,local:It,uri:Be};H&&H!=="xmlns"&&!Be&&(T(r,"Unbound namespace prefix: "+JSON.stringify(H)),pe.uri=H),r.tag.attributes[x]=pe,C(r,"onattribute",pe)}r.attribList.length=0}r.tag.isSelfClosing=!!n,r.sawRoot=!0,r.tags.push(r.tag),C(r,"onopentag",r.tag),n||(!r.noscript&&r.tagName.toLowerCase()==="script"?r.state=o.SCRIPT:r.state=o.TEXT,r.tag=null,r.tagName=""),r.attribName=r.attribValue="",r.attribList.length=0}function de(r){if(!r.tagName){T(r,"Weird empty close tag."),r.textNode+="</>",r.state=o.TEXT;return}if(r.script){if(r.tagName!=="script"){r.script+="</"+r.tagName+">",r.tagName="",r.state=o.SCRIPT;return}C(r,"onscript",r.script),r.script=""}var n=r.tags.length,p=r.tagName;r.strict||(p=p[r.looseCase]());for(var s=p;n--;){var N=r.tags[n];if(N.name!==s)T(r,"Unexpected close tag");else break}if(n<0){T(r,"Unmatched closing tag: "+r.tagName),r.textNode+="</"+r.tagName+">",r.state=o.TEXT;return}r.tagName=p;for(var L=r.tags.length;L-- >n;){var D=r.tag=r.tags.pop();r.tagName=r.tag.name,C(r,"onclosetag",r.tagName);var k={};for(var x in D.ns)k[x]=D.ns[x];var Y=r.tags[r.tags.length-1]||r;r.opt.xmlns&&D.ns!==Y.ns&&Object.keys(D.ns).forEach(function(O){var H=D.ns[O];C(r,"onclosenamespace",{prefix:O,uri:H})})}n===0&&(r.closedRoot=!0),r.tagName=r.attribValue=r.attribName="",r.attribList.length=0,r.state=o.TEXT}function Nt(r){var n=r.entity,p=n.toLowerCase(),s,N="";return r.ENTITIES[n]?r.ENTITIES[n]:r.ENTITIES[p]?r.ENTITIES[p]:(n=p,n.charAt(0)==="#"&&(n.charAt(1)==="x"?(n=n.slice(2),s=parseInt(n,16),N=s.toString(16)):(n=n.slice(1),s=parseInt(n,10),N=s.toString(10))),n=n.replace(/^0+/,""),isNaN(s)||N.toLowerCase()!==n?(T(r,"Invalid character entity"),"&"+r.entity+";"):String.fromCodePoint(s))}function Me(r,n){n==="<"?(r.state=o.OPEN_WAKA,r.startTagPosition=r.position):v(n)||(T(r,"Non-whitespace before first tag."),r.textNode=n,r.state=o.TEXT)}function Ve(r,n){var p="";return n<r.length&&(p=r.charAt(n)),p}function Tt(r){var n=this;if(this.error)throw this.error;if(n.closed)return Q(n,"Cannot write after close. Assign an onready handler.");if(r===null)return $e(n);typeof r=="object"&&(r=r.toString());for(var p=0,s="";s=Ve(r,p++),n.c=s,!!s;)switch(n.trackPosition&&(n.position++,s===`
`?(n.line++,n.column=0):n.column++),n.state){case o.BEGIN:if(n.state=o.BEGIN_WHITESPACE,s==="\uFEFF")continue;Me(n,s);continue;case o.BEGIN_WHITESPACE:Me(n,s);continue;case o.TEXT:if(n.sawRoot&&!n.closedRoot){for(var N=p-1;s&&s!=="<"&&s!=="&";)s=Ve(r,p++),s&&n.trackPosition&&(n.position++,s===`
`?(n.line++,n.column=0):n.column++);n.textNode+=r.substring(N,p-1)}s==="<"&&!(n.sawRoot&&n.closedRoot&&!n.strict)?(n.state=o.OPEN_WAKA,n.startTagPosition=n.position):(!v(s)&&(!n.sawRoot||n.closedRoot)&&T(n,"Text data outside of root node."),s==="&"?n.state=o.TEXT_ENTITY:n.textNode+=s);continue;case o.SCRIPT:s==="<"?n.state=o.SCRIPT_ENDING:n.script+=s;continue;case o.SCRIPT_ENDING:s==="/"?n.state=o.CLOSE_TAG:(n.script+="<"+s,n.state=o.SCRIPT);continue;case o.OPEN_WAKA:if(s==="!")n.state=o.SGML_DECL,n.sgmlDecl="";else if(!v(s))if(w(R,s))n.state=o.OPEN_TAG,n.tagName=s;else if(s==="/")n.state=o.CLOSE_TAG,n.tagName="";else if(s==="?")n.state=o.PROC_INST,n.procInstName=n.procInstBody="";else{if(T(n,"Unencoded <"),n.startTagPosition+1<n.position){var L=n.position-n.startTagPosition;s=new Array(L).join(" ")+s}n.textNode+="<"+s,n.state=o.TEXT}continue;case o.SGML_DECL:if(n.sgmlDecl+s==="--"){n.state=o.COMMENT,n.comment="",n.sgmlDecl="";continue}n.doctype&&n.doctype!==!0&&n.sgmlDecl?(n.state=o.DOCTYPE_DTD,n.doctype+="<!"+n.sgmlDecl+s,n.sgmlDecl=""):(n.sgmlDecl+s).toUpperCase()===E?(C(n,"onopencdata"),n.state=o.CDATA,n.sgmlDecl="",n.cdata=""):(n.sgmlDecl+s).toUpperCase()===_?(n.state=o.DOCTYPE,(n.doctype||n.sawRoot)&&T(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):s===">"?(C(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=o.TEXT):(B(s)&&(n.state=o.SGML_DECL_QUOTED),n.sgmlDecl+=s);continue;case o.SGML_DECL_QUOTED:s===n.q&&(n.state=o.SGML_DECL,n.q=""),n.sgmlDecl+=s;continue;case o.DOCTYPE:s===">"?(n.state=o.TEXT,C(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=s,s==="["?n.state=o.DOCTYPE_DTD:B(s)&&(n.state=o.DOCTYPE_QUOTED,n.q=s));continue;case o.DOCTYPE_QUOTED:n.doctype+=s,s===n.q&&(n.q="",n.state=o.DOCTYPE);continue;case o.DOCTYPE_DTD:s==="]"?(n.doctype+=s,n.state=o.DOCTYPE):s==="<"?(n.state=o.OPEN_WAKA,n.startTagPosition=n.position):B(s)?(n.doctype+=s,n.state=o.DOCTYPE_DTD_QUOTED,n.q=s):n.doctype+=s;continue;case o.DOCTYPE_DTD_QUOTED:n.doctype+=s,s===n.q&&(n.state=o.DOCTYPE_DTD,n.q="");continue;case o.COMMENT:s==="-"?n.state=o.COMMENT_ENDING:n.comment+=s;continue;case o.COMMENT_ENDING:s==="-"?(n.state=o.COMMENT_ENDED,n.comment=xe(n.opt,n.comment),n.comment&&C(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+s,n.state=o.COMMENT);continue;case o.COMMENT_ENDED:s!==">"?(T(n,"Malformed comment"),n.comment+="--"+s,n.state=o.COMMENT):n.doctype&&n.doctype!==!0?n.state=o.DOCTYPE_DTD:n.state=o.TEXT;continue;case o.CDATA:s==="]"?n.state=o.CDATA_ENDING:n.cdata+=s;continue;case o.CDATA_ENDING:s==="]"?n.state=o.CDATA_ENDING_2:(n.cdata+="]"+s,n.state=o.CDATA);continue;case o.CDATA_ENDING_2:s===">"?(n.cdata&&C(n,"oncdata",n.cdata),C(n,"onclosecdata"),n.cdata="",n.state=o.TEXT):s==="]"?n.cdata+="]":(n.cdata+="]]"+s,n.state=o.CDATA);continue;case o.PROC_INST:s==="?"?n.state=o.PROC_INST_ENDING:v(s)?n.state=o.PROC_INST_BODY:n.procInstName+=s;continue;case o.PROC_INST_BODY:if(!n.procInstBody&&v(s))continue;s==="?"?n.state=o.PROC_INST_ENDING:n.procInstBody+=s;continue;case o.PROC_INST_ENDING:s===">"?(C(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=o.TEXT):(n.procInstBody+="?"+s,n.state=o.PROC_INST_BODY);continue;case o.OPEN_TAG:w(F,s)?n.tagName+=s:(yt(n),s===">"?X(n):s==="/"?n.state=o.OPEN_TAG_SLASH:(v(s)||T(n,"Invalid character in tag name"),n.state=o.ATTRIB));continue;case o.OPEN_TAG_SLASH:s===">"?(X(n,!0),de(n)):(T(n,"Forward-slash in opening tag not followed by >"),n.state=o.ATTRIB);continue;case o.ATTRIB:if(v(s))continue;s===">"?X(n):s==="/"?n.state=o.OPEN_TAG_SLASH:w(R,s)?(n.attribName=s,n.attribValue="",n.state=o.ATTRIB_NAME):T(n,"Invalid attribute name");continue;case o.ATTRIB_NAME:s==="="?n.state=o.ATTRIB_VALUE:s===">"?(T(n,"Attribute without value"),n.attribValue=n.attribName,ue(n),X(n)):v(s)?n.state=o.ATTRIB_NAME_SAW_WHITE:w(F,s)?n.attribName+=s:T(n,"Invalid attribute name");continue;case o.ATTRIB_NAME_SAW_WHITE:if(s==="=")n.state=o.ATTRIB_VALUE;else{if(v(s))continue;T(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",C(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",s===">"?X(n):w(R,s)?(n.attribName=s,n.state=o.ATTRIB_NAME):(T(n,"Invalid attribute name"),n.state=o.ATTRIB)}continue;case o.ATTRIB_VALUE:if(v(s))continue;B(s)?(n.q=s,n.state=o.ATTRIB_VALUE_QUOTED):(n.opt.unquotedAttributeValues||Q(n,"Unquoted attribute value"),n.state=o.ATTRIB_VALUE_UNQUOTED,n.attribValue=s);continue;case o.ATTRIB_VALUE_QUOTED:if(s!==n.q){s==="&"?n.state=o.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=s;continue}ue(n),n.q="",n.state=o.ATTRIB_VALUE_CLOSED;continue;case o.ATTRIB_VALUE_CLOSED:v(s)?n.state=o.ATTRIB:s===">"?X(n):s==="/"?n.state=o.OPEN_TAG_SLASH:w(R,s)?(T(n,"No whitespace between attributes"),n.attribName=s,n.attribValue="",n.state=o.ATTRIB_NAME):T(n,"Invalid attribute name");continue;case o.ATTRIB_VALUE_UNQUOTED:if(!q(s)){s==="&"?n.state=o.ATTRIB_VALUE_ENTITY_U:n.attribValue+=s;continue}ue(n),s===">"?X(n):n.state=o.ATTRIB;continue;case o.CLOSE_TAG:if(n.tagName)s===">"?de(n):w(F,s)?n.tagName+=s:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=o.SCRIPT):(v(s)||T(n,"Invalid tagname in closing tag"),n.state=o.CLOSE_TAG_SAW_WHITE);else{if(v(s))continue;A(R,s)?n.script?(n.script+="</"+s,n.state=o.SCRIPT):T(n,"Invalid tagname in closing tag."):n.tagName=s}continue;case o.CLOSE_TAG_SAW_WHITE:if(v(s))continue;s===">"?de(n):T(n,"Invalid characters in closing tag");continue;case o.TEXT_ENTITY:case o.ATTRIB_VALUE_ENTITY_Q:case o.ATTRIB_VALUE_ENTITY_U:var D,k;switch(n.state){case o.TEXT_ENTITY:D=o.TEXT,k="textNode";break;case o.ATTRIB_VALUE_ENTITY_Q:D=o.ATTRIB_VALUE_QUOTED,k="attribValue";break;case o.ATTRIB_VALUE_ENTITY_U:D=o.ATTRIB_VALUE_UNQUOTED,k="attribValue";break}if(s===";"){var x=Nt(n);n.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(x)?(n.entity="",n.state=D,n.write(x)):(n[k]+=x,n.entity="",n.state=D)}else w(n.entity.length?V:$,s)?n.entity+=s:(T(n,"Invalid character in entity name"),n[k]+="&"+n.entity+s,n.entity="",n.state=D);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&l(n),n}String.fromCodePoint||function(){var r=String.fromCharCode,n=Math.floor,p=function(){var s=16384,N=[],L,D,k=-1,x=arguments.length;if(!x)return"";for(var Y="";++k<x;){var O=Number(arguments[k]);if(!isFinite(O)||O<0||O>1114111||n(O)!==O)throw RangeError("Invalid code point: "+O);O<=65535?N.push(O):(O-=65536,L=(O>>10)+55296,D=O%1024+56320,N.push(L,D)),(k+1===x||N.length>s)&&(Y+=r.apply(null,N),N.length=0)}return Y};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:p,configurable:!0,writable:!0}):String.fromCodePoint=p}()})(e)}(Ke)),Ke}Ei();const Te=["B","KB","MB","GB","TB","PB"],Ie=["B","KiB","MiB","GiB","TiB","PiB"];function gi(e,t=!1,i=!1,a=!1){i=i&&!a,typeof e=="string"&&(e=Number(e));let l=e>0?Math.floor(Math.log(e)/Math.log(a?1e3:1024)):0;l=Math.min((i?Ie.length:Te.length)-1,l);const f=i?Ie[l]:Te[l];let h=(e/Math.pow(a?1e3:1024,l)).toFixed(1);return t===!0&&l===0?(h!=="0.0"?"< 1 ":"0 ")+(i?Ie[1]:Te[1]):(l<2?h=parseFloat(h).toFixed(0):h=parseFloat(h).toLocaleString(nt()),h+" "+f)}function et(e){return e instanceof Date?e.toISOString():String(e)}function vi(e,t,i){t=t??[f=>f],i=i??[];const a=t.map((f,h)=>(i[h]??"asc")==="asc"?1:-1),l=Intl.Collator([Rt(),nt()],{numeric:!0,usage:"sort"});return[...e].sort((f,h)=>{for(const[m,u]of t.entries()){const d=l.compare(et(u(f)),et(u(h)));if(d!==0)return d*a[m]}return 0})}function _i(e,t={}){const i={sortingMode:"basename",sortingOrder:"asc",...t};function a(h){const m=h.displayname||h.attributes?.displayname||h.basename||"";return h.type===z.Folder?m:m.lastIndexOf(".")>0?m.slice(0,m.lastIndexOf(".")):m}const l=[...i.sortFavoritesFirst?[h=>h.attributes?.favorite!==1]:[],...i.sortFoldersFirst?[h=>h.type!=="folder"]:[],...i.sortingMode!=="basename"?[h=>h[i.sortingMode]??h.attributes[i.sortingMode]]:[],h=>a(h),h=>h.basename],f=[...i.sortFavoritesFirst?["asc"]:[],...i.sortFoldersFirst?["asc"]:[],...i.sortingMode==="mtime"?[i.sortingOrder==="asc"?"desc":"asc"]:[],...i.sortingMode!=="mtime"&&i.sortingMode!=="basename"?[i.sortingOrder]:[],i.sortingOrder,i.sortingOrder];return vi(e,l,f)}function K(e){return typeof e=="function"?e():Ot(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;var tt="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",wi="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",yi="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Ni="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14",Ti="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z",Ii="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z",bi="M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17Z",Ai="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",Ci="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",re;(function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh"})(re||(re={}));class Pe extends Error{name="TimeoutError";constructor(t,i){super(t,i),Error.captureStackTrace?.(this,Pe)}}const it=e=>e.reason??new DOMException("This operation was aborted.","AbortError");function Si(e,t){const{milliseconds:i,fallback:a,message:l,customTimers:f={setTimeout,clearTimeout},signal:h}=t;let m,u;const d=new Promise((c,E)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(h?.aborted){E(it(h));return}if(h&&(u=()=>{E(it(h))},h.addEventListener("abort",u,{once:!0})),e.then(c,E),i===Number.POSITIVE_INFINITY)return;const _=new Pe;m=f.setTimeout.call(void 0,()=>{if(a){try{c(a())}catch(y){E(y)}return}typeof e.cancel=="function"&&e.cancel(),l===!1?c():l instanceof Error?E(l):(_.message=l??`Promise timed out after ${i} milliseconds`,E(_))},i)}).finally(()=>{d.clear(),u&&h&&h.removeEventListener("abort",u)});return d.clear=()=>{f.clearTimeout.call(void 0,m),m=void 0},d}function Li(e,t,i){let a=0,l=e.length;for(;l>0;){const f=Math.trunc(l/2);let h=a+f;i(e[h],t)<=0?(a=++h,l-=f+1):l=f}return a}class Di{#t=[];enqueue(t,i){const{priority:a=0,id:l}=i??{},f={priority:a,id:l,run:t};if(this.size===0||this.#t[this.size-1].priority>=a){this.#t.push(f);return}const h=Li(this.#t,f,(m,u)=>u.priority-m.priority);this.#t.splice(h,0,f)}setPriority(t,i){const a=this.#t.findIndex(f=>f.id===t);if(a===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);const[l]=this.#t.splice(a,1);this.enqueue(l.run,{priority:i,id:t})}dequeue(){return this.#t.shift()?.run}filter(t){return this.#t.filter(i=>i.priority===t.priority).map(i=>i.run)}get size(){return this.#t.length}}class Ri extends Ht{#t;#n;#r=0;#f;#h=!1;#m=!1;#l;#_=0;#E=0;#a;#s;#e;#w;#i=0;#u;#o;#A=1n;#d=new Map;timeout;constructor(t){if(super(),t={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Di,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);if(this.#t=t.carryoverIntervalCount??t.carryoverConcurrencyCount??!1,this.#n=t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,this.#f=t.intervalCap,this.#l=t.interval,this.#e=new t.queueClass,this.#w=t.queueClass,this.concurrency=t.concurrency,t.timeout!==void 0&&!(Number.isFinite(t.timeout)&&t.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${t.timeout}\` (${typeof t.timeout})`);this.timeout=t.timeout,this.#o=t.autoStart===!1,this.#O()}get#C(){return this.#n||this.#r<this.#f}get#S(){return this.#i<this.#u}#L(){this.#i--,this.#i===0&&this.emit("pendingZero"),this.#g(),this.emit("next")}#D(){this.#I(),this.#T(),this.#s=void 0}get#R(){const t=Date.now();if(this.#a===void 0){const i=this.#_-t;if(i<0){if(this.#E>0){const a=t-this.#E;if(a<this.#l)return this.#y(this.#l-a),!0}this.#r=this.#t?this.#i:0}else return this.#y(i),!0}return!1}#y(t){this.#s===void 0&&(this.#s=setTimeout(()=>{this.#D()},t))}#N(){this.#a&&(clearInterval(this.#a),this.#a=void 0)}#F(){this.#s&&(clearTimeout(this.#s),this.#s=void 0)}#g(){if(this.#e.size===0)return this.#N(),this.emit("empty"),this.#i===0&&(this.#F(),this.emit("idle")),!1;let t=!1;if(!this.#o){const i=!this.#R;if(this.#C&&this.#S){const a=this.#e.dequeue();this.#n||(this.#r++,this.#p()),this.emit("active"),this.#E=Date.now(),a(),i&&this.#T(),t=!0}}return t}#T(){this.#n||this.#a!==void 0||(this.#a=setInterval(()=>{this.#I()},this.#l),this.#_=Date.now()+this.#l)}#I(){this.#r===0&&this.#i===0&&this.#a&&this.#N(),this.#r=this.#t?this.#i:0,this.#v(),this.#p()}#v(){for(;this.#g(););}get concurrency(){return this.#u}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#u=t,this.#v()}setPriority(t,i){if(typeof i!="number"||!Number.isFinite(i))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${i}\` (${typeof i})`);this.#e.setPriority(t,i)}async add(t,i={}){return i.id??=(this.#A++).toString(),i={timeout:this.timeout,...i},new Promise((a,l)=>{const f=Symbol(`task-${i.id}`);this.#e.enqueue(async()=>{this.#i++,this.#d.set(f,{id:i.id,priority:i.priority??0,startTime:Date.now(),timeout:i.timeout});let h;try{try{i.signal?.throwIfAborted()}catch(d){throw this.#n||this.#r--,this.#d.delete(f),d}let m=t({signal:i.signal});if(i.timeout&&(m=Si(Promise.resolve(m),{milliseconds:i.timeout,message:`Task timed out after ${i.timeout}ms (queue has ${this.#i} running, ${this.#e.size} waiting)`})),i.signal){const{signal:d}=i;m=Promise.race([m,new Promise((c,E)=>{h=()=>{E(d.reason)},d.addEventListener("abort",h,{once:!0})})])}const u=await m;a(u),this.emit("completed",u)}catch(m){l(m),this.emit("error",m)}finally{h&&i.signal?.removeEventListener("abort",h),this.#d.delete(f),queueMicrotask(()=>{this.#L()})}},i),this.emit("add"),this.#g()})}async addAll(t,i){return Promise.all(t.map(async a=>this.add(a,i)))}start(){return this.#o?(this.#o=!1,this.#v(),this):this}pause(){this.#o=!0}clear(){this.#e=new this.#w,this.#b()}async onEmpty(){this.#e.size!==0&&await this.#c("empty")}async onSizeLessThan(t){this.#e.size<t||await this.#c("next",()=>this.#e.size<t)}async onIdle(){this.#i===0&&this.#e.size===0||await this.#c("idle")}async onPendingZero(){this.#i!==0&&await this.#c("pendingZero")}async onRateLimit(){this.isRateLimited||await this.#c("rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await this.#c("rateLimitCleared")}async onError(){return new Promise((t,i)=>{const a=l=>{this.off("error",a),i(l)};this.on("error",a)})}async#c(t,i){return new Promise(a=>{const l=()=>{i&&!i()||(this.off(t,l),a())};this.on(t,l)})}get size(){return this.#e.size}sizeBy(t){return this.#e.filter(t).length}get pending(){return this.#i}get isPaused(){return this.#o}#O(){this.#n||(this.on("add",()=>{this.#e.size>0&&this.#p()}),this.on("next",()=>{this.#p()}))}#p(){this.#n||this.#m||(this.#m=!0,queueMicrotask(()=>{this.#m=!1,this.#b()}))}#b(){const t=this.#h,i=!this.#n&&this.#r>=this.#f&&this.#e.size>0;i!==t&&(this.#h=i,this.emit(i?"rateLimit":"rateLimitCleared"))}get isRateLimited(){return this.#h}get isSaturated(){return this.#i===this.#u&&this.#e.size>0||this.isRateLimited&&this.#e.size>0}get runningTasks(){return[...this.#d.values()].map(t=>({...t}))}}const Fi={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Oi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Pi=[],ki=P(Fi,Oi,Pi,!1,null,null);const gt=ki.exports,vt=()=>{const e=se("files","config",null),t=b(e?.show_hidden??!0),i=b(e?.sort_favorites_first??!0),a=b(e?.crop_image_previews??!0);return J(async()=>{if(ee())console.debug("Skip loading files settings - currently on public share");else try{const{data:l}=await st.get(Ae("/apps/files/api/v1/configs"));t.value=l?.data?.show_hidden??!1,i.value=l?.data?.sort_favorites_first??!0,a.value=l?.data?.crop_image_previews??!0}catch(l){console.error("Could not load files settings",l),Ce(S("Could not load files settings"))}}),{showHiddenFiles:t,sortFavoritesFirst:i,cropImagePreviews:a}},xi=e=>{const t=d=>d==="asc"?"ascending":d==="desc"?"descending":"none",i=se("files","viewConfigs",null),a=b({sortBy:i?.files?.sorting_mode??"basename",order:t(i?.files?.sorting_direction??"asc")}),l=b({sortBy:i?.recent?.sorting_mode??"basename",order:t(i?.recent?.sorting_direction??"asc")}),f=b({sortBy:i?.favorites?.sorting_mode??"basename",order:t(i?.favorites?.sorting_direction??"asc")});J(async()=>{if(ee())console.debug("Skip loading files views - currently on public share");else try{const{data:d}=await st.get(Ae("/apps/files/api/v1/views"));a.value={sortBy:d?.data?.files?.sorting_mode??"basename",order:t(d?.data?.files?.sorting_direction)},f.value={sortBy:d?.data?.favorites?.sorting_mode??"basename",order:t(d?.data?.favorites?.sorting_direction)},l.value={sortBy:d?.data?.recent?.sorting_mode??"basename",order:t(d?.data?.recent?.sorting_direction)}}catch(d){console.error("Could not load files views",d),Ce(S("Could not load files views"))}});const h=I(()=>K(e||"files")==="files"?a.value:K(e)==="recent"?l.value:f.value),m=I(()=>h.value.sortBy),u=I(()=>h.value.order);return{filesViewConfig:a,favoritesViewConfig:f,recentViewConfig:l,currentConfig:h,sortBy:m,order:u}},$i={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Mi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Vi=[],Bi=P($i,Mi,Vi,!1,null,null);const Ui=Bi.exports,Hi={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var zi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Gi=[],Xi=P(Hi,zi,Gi,!1,null,null);const ji=Xi.exports,_t={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},qi=j({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:_t}}});var Yi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?t("td",{staticClass:"row-checkbox"},[t("span")]):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"row-wrapper"},[t("span",{class:i.fileListIconStyles["file-picker__file-icon"]}),t("span")])]),e._m(0),e._m(1)])},Wi=[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-size"},[t("span")])},function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-modified"},[t("span")])}],Zi=P(qi,Yi,Wi,!1,null,"15187afc");const Qi=Zi.exports,Ki=new Ri({concurrency:5});function Ji(e){const{resolve:t,promise:i}=Promise.withResolvers();return Ki.add(()=>{const a=new Image;return a.onerror=()=>t(!1),a.onload=()=>t(!0),a.src=e,i}),i}function en(e,t={}){t={size:32,cropPreview:!1,mimeFallback:!0,...t};try{const i=e.attributes?.previewUrl||Ae("/core/preview?fileId={fileid}",{fileid:e.fileid});let a;try{a=new URL(i)}catch{a=new URL(i,window.location.origin)}return a.searchParams.set("x",`${t.size}`),a.searchParams.set("y",`${t.size}`),a.searchParams.set("mimeFallback",`${t.mimeFallback}`),a.searchParams.set("a",t.cropPreview===!0?"0":"1"),a.searchParams.set("c",`${e.attributes.etag}`),a}catch{return null}}const tn=(e,t)=>{const i=b(null),a=b(!1);return $t(()=>{a.value=!1,i.value=en(K(e),K(t||{})),i.value&&K(e).type===z.File&&Ji(i.value.href).then(l=>{a.value=l})}),{previewURL:i,previewLoaded:a}},nn={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var rn=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},an=[],sn=P(nn,rn,an,!1,null,null);const wt=sn.exports,on={name:"FilePreview"},cn=j({...on,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const t=e,i=b(_t),{previewURL:a,previewLoaded:l}=tn(at(t,"node"),I(()=>({cropPreview:t.cropImagePreviews}))),f=I(()=>t.node.type===z.File),h=I(()=>{if(t.node.type!==z.Folder)return null;if(t.node.attributes?.["is-encrypted"]===1)return Ii;if(t.node.attributes?.["is-tag"])return Ci;const m=Object.values(t.node.attributes?.["share-types"]||{}).flat();if(m.some(u=>u===re.Link||u===re.Email))return Ti;if(m.length>0)return tt;switch(t.node.attributes?.["mount-type"]){case"external":case"external-session":return bi;case"group":return Ni;case"shared":return tt}return null});return{__sfc:!0,fileListIconStyles:i,props:t,previewURL:a,previewLoaded:l,isFile:f,folderDecorationIcon:h,NcIconSvgWrapper:ot,IconFile:gt,IconFolder:wt}}});var ln=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{class:i.fileListIconStyles["file-picker__file-icon"],style:i.previewLoaded?{backgroundImage:`url(${i.previewURL})`}:void 0},[i.previewLoaded?e._e():[i.isFile?t(i.IconFile,{attrs:{size:32}}):[i.folderDecorationIcon?t(i.NcIconSvgWrapper,{class:i.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:i.folderDecorationIcon,size:16}}):e._e(),t(i.IconFolder,{class:i.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},un=[],dn=P(cn,ln,un,!1,null,null);const pn=dn.exports,fn=j({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:t}){const i=e,a=I(()=>i.node.attributes?.displayName||i.node.basename.slice(0,i.node.extension?-i.node.extension.length:void 0)),l=I(()=>i.node.extension),f=I(()=>i.node.type===z.Folder),h=I(()=>i.canPick&&(i.allowPickDirectory||!f.value)),m=I(()=>(i.node.permissions&M.READ)===M.READ);function u(){h.value&&t("update:selected",!i.selected)}function d(){f.value?m.value&&t("enter-directory",i.node):u()}function c(E){E.key==="Enter"&&d()}return{__sfc:!0,props:i,emit:t,displayName:a,fileExtension:l,isDirectory:f,isPickable:h,isNavigatable:m,toggleSelected:u,handleClick:d,handleKeyDown:c,formatFileSize:gi,NcCheckboxRadioSwitch:lt,NcDateTime:Ut,t:S,FilePreview:pn}}});var hn=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":i.isDirectory&&!i.isNavigatable,"file-picker__row--not-pickable":!i.isPickable}],attrs:{tabindex:e.showCheckbox&&!i.isDirectory?void 0:0,"aria-selected":i.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:i.handleClick,...!e.showCheckbox||i.isDirectory?{keydown:i.handleKeyDown}:{}}),[e.showCheckbox?t("td",{staticClass:"row-checkbox",on:{click:function(a){return a.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select the row for {nodename}",{nodename:i.displayName}),disabled:!i.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":i.toggleSelected}})],1):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[t(i.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),t("div",{staticClass:"file-picker__file-name",attrs:{title:i.displayName},domProps:{textContent:e._s(i.displayName)}}),t("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(i.fileExtension)}})],1)]),t("td",{staticClass:"row-size"},[e._v(" "+e._s(i.formatFileSize(e.node.size||0))+" ")]),t("td",{staticClass:"row-modified"},[t(i.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},mn=[],En=P(fn,hn,mn,!1,null,"ba4db9f8");const gn=En.exports,vn=j({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,canPick:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:t}){const i=e,a=b(),{currentConfig:l}=xi(i.currentView),f=I(()=>a.value??l.value),h=I(()=>f.value.sortBy==="basename"?f.value.order==="none"?void 0:f.value.order:void 0),m=I(()=>f.value.sortBy==="size"?f.value.order==="none"?void 0:f.value.order:void 0),u=I(()=>f.value.sortBy==="mtime"?f.value.order==="none"?void 0:f.value.order:void 0),d=v=>{f.value.sortBy===v?f.value.order==="ascending"?a.value={sortBy:f.value.sortBy,order:"descending"}:a.value={sortBy:f.value.sortBy,order:"ascending"}:a.value={sortBy:v,order:"ascending"}},{sortFavoritesFirst:c,cropImagePreviews:E}=vt(),_=I(()=>_i(i.files,{sortFoldersFirst:!0,sortFavoritesFirst:c.value,sortingOrder:f.value.order==="descending"?"desc":"asc",sortingMode:f.value.sortBy})),y=I(()=>i.files.filter(v=>i.allowPickDirectory||v.type!==z.Folder)),U=I(()=>!i.loading&&i.selectedFiles.length>0&&i.selectedFiles.length>=y.value.length);function g(){i.selectedFiles.length<y.value.length?t("update:selectedFiles",y.value):t("update:selectedFiles",[])}function R(v){i.selectedFiles.includes(v)?t("update:selectedFiles",i.selectedFiles.filter(B=>B.path!==v.path)):i.multiselect?t("update:selectedFiles",[...i.selectedFiles,v]):t("update:selectedFiles",[v])}function F(v){t("update:path",v.path)}const $=b(4),V=b();{const v=()=>kt(()=>{const B=V.value?.parentElement?.children||[];let q=V.value?.parentElement?.clientHeight||450;for(let w=0;w<B.length;w++)V.value?.isSameNode(B[w])||(q-=B[w].clientHeight);$.value=Math.max(1,Math.floor((q-50)/50))});J(()=>{window.addEventListener("resize",v),v()}),xt(()=>{window.removeEventListener("resize",v)})}return{__sfc:!0,props:i,emit:t,customSortingConfig:a,filesAppSorting:l,sortingConfig:f,sortByName:h,sortBySize:m,sortByModified:u,toggleSorting:d,sortFavoritesFirst:c,cropImagePreviews:E,sortedFiles:_,selectableFiles:y,allSelected:U,onSelectAll:g,onNodeSelected:R,onChangeDirectory:F,skeletonNumber:$,fileContainer:V,NcButton:ct,NcCheckboxRadioSwitch:lt,t:S,IconSortAscending:Ui,IconSortDescending:ji,LoadingTableRow:Qi,FileListRow:gn}}});var _n=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"fileContainer",staticClass:"file-picker__files"},[t("table",[t("thead",[t("tr",[e.multiselect?t("th",{staticClass:"row-checkbox"},[t("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(i.t("Select entry"))+" ")]),e.multiselect?t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":i.allSelected},on:{"update:model-value":i.onSelectAll}}):e._e()],1):e._e(),t("th",{staticClass:"row-name",attrs:{"aria-sort":i.sortByName}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"file-picker__header-preview"}),t(i.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(a){return i.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByName==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByName==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Name"))+" ")])],1)]),t("th",{staticClass:"row-size",attrs:{"aria-sort":i.sortBySize}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(a){return i.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortBySize==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortBySize==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Size"))+" ")])],1),t("th",{staticClass:"row-modified",attrs:{"aria-sort":i.sortByModified}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(a){return i.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByModified==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByModified==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Modified"))+" ")])],1)])]),t("tbody",[e.loading?e._l(i.skeletonNumber,function(a){return t(i.LoadingTableRow,{key:a,attrs:{"show-checkbox":e.multiselect}})}):e._l(i.sortedFiles,function(a){return t(i.FileListRow,{key:a.fileid||a.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(a))&&(e.canPick===void 0||e.canPick(a)),selected:e.selectedFiles.includes(a),node:a,"crop-image-previews":i.cropImagePreviews},on:{"update:selected":function(l){return i.onNodeSelected(a)},"enter-directory":i.onChangeDirectory}})})],2)])])},wn=[],yn=P(vn,_n,wn,!1,null,"6503afab");const Nn=yn.exports,Tn={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var In=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},bn=[],An=P(Tn,In,bn,!1,null,null);const Cn=An.exports,Sn={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ln=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Dn=[],Rn=P(Sn,Ln,Dn,!1,null,null);const Fn=Rn.exports,On=j({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:t}){const i=e,a=b(!1),l=b(""),f=b();function h(){const d=l.value.trim(),c=f.value?.$el?.querySelector("input");let E="";return d.length===0?E=S("Folder name cannot be empty."):d.includes("/")?E=S('"/" is not allowed inside a folder name.'):["..","."].includes(d)?E=S('"{name}" is an invalid folder name.',{name:d}):window.OC.config?.blacklist_files_regex&&d.match(window.OC.config?.blacklist_files_regex)&&(E=S('"{name}" is not an allowed folder name',{name:d})),c&&c.setCustomValidity(E),E===""}const m=function(){const d=l.value.trim();h()&&(a.value=!1,t("create-node",d),l.value="")},u=I(()=>i.path.split("/").filter(d=>d!=="").map((d,c,E)=>({name:d,path:"/"+E.slice(0,c+1).join("/")})));return{__sfc:!0,props:i,emit:t,actionsOpen:a,newNodeName:l,nameInput:f,validateInput:h,onSubmit:m,pathElements:u,IconFolder:wt,IconHome:Cn,IconPlus:Fn,NcActions:Vt,NcActionInput:jt,NcBreadcrumbs:Xt,NcBreadcrumb:Gt,t:S}}});var Pn=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[t(i.NcBreadcrumb,{attrs:{name:i.t("All files"),title:i.t("Home")},on:{click:function(a){return i.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(i.pathElements,function(a){return t(i.NcBreadcrumb,{key:a.path,attrs:{name:a.name,title:a.path},on:{click:function(l){return i.emit("update:path",a.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[t(i.NcActions,{attrs:{open:i.actionsOpen,"aria-label":i.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":i.t("New"),type:"secondary"},on:{"update:open":function(a){i.actionsOpen=a},close:function(a){i.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[t(i.NcActionInput,{ref:"nameInput",attrs:{value:i.newNodeName,label:i.t("New folder"),placeholder:i.t("New folder name")},on:{"update:value":function(a){i.newNodeName=a},submit:i.onSubmit,"update:model-value":i.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},kn=[],xn=P(On,Pn,kn,!1,null,"ec4d392b");const $n=xn.exports,Mn={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Vn=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Bn=[],Un=P(Mn,Vn,Bn,!1,null,null);const Hn=Un.exports,zn={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Gn=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Xn=[],jn=P(zn,Gn,Xn,!1,null,null);const qn=jn.exports,Yn=e=>{const t=[{id:"files",label:S("All files"),icon:yi},{id:"recent",label:S("Recent"),icon:wi},{id:"favorites",label:S("Favorites"),icon:Ai}],i=e.value?t.filter(({id:a})=>a==="files"):t;return{allViews:t,availableViews:i}},Wn=j({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:t}){const i=e,{availableViews:a}=Yn(b(ae()===null)),l=I(()=>a.filter(f=>f.id===i.currentView)[0]??a[0]);return{__sfc:!0,props:i,emit:t,availableViews:a,currentViewObject:l,updateFilterValue:f=>t("update:filterString",f),IconClose:Hn,IconMagnify:qn,NcButton:ct,NcIconSvgWrapper:ot,NcSelect:qt,NcTextField:Yt,Fragment:zt,t:S}}});var Zn=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.Fragment,[t(i.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:i.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":i.updateFilterValue,"trailing-button-click":function(a){return i.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[t(i.IconClose,{attrs:{size:16}})]},proxy:!0}])},[t(i.IconMagnify,{attrs:{size:16}})],1),i.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?t(i.NcSelect,{attrs:{"aria-label":i.t("Current view selector"),clearable:!1,searchable:!1,options:i.availableViews,"model-value":i.currentViewObject},on:{"update:model-value":function(a){return i.emit("update:currentView",a.id)}}}):t("ul",{staticClass:"file-picker__side"},e._l(i.availableViews,function(a){return t("li",{key:a.id},[t(i.NcButton,{attrs:{type:e.currentView===a.id?"primary":"tertiary",wide:!0},on:{click:function(l){return e.$emit("update:currentView",a.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.NcIconSvgWrapper,{attrs:{path:a.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.label)+" ")])],1)}),0)]:e._e()],2)},Qn=[],Kn=P(Wn,Zn,Qn,!1,null,"f5975252");const Jn=Kn.exports;function er(e){const t=new AbortController,i=Math.round(Date.now()/1e3)-60*60*24*14;return new Se(async(a,l,f)=>{f(()=>t.abort());try{const{data:h}=await e.search("/",{signal:t.signal,details:!0,data:ai(i)}),m=h.results.map(u=>ce(u));a(m)}catch(h){l(h)}})}function tr(e,t){const i=new AbortController;return new Se(async(a,l,f)=>{f(()=>i.abort());try{const h=(await e.getDirectoryContents(ne.join(te,t),{signal:i.signal,details:!0,includeSelf:!0,data:pt()})).data.map(m=>ce(m));a({contents:h.filter(({path:m})=>m!==t),folder:h.find(({path:m})=>m===t)})}catch(h){l(h)}})}async function ir(e,t){const{data:i}=await e.stat(ne.join(te,t),{details:!0,data:pt()});return ce(i)}const nr=function(e,t){const i=ci(),a=be([]),l=be(null),f=b(!0),h=b(null);async function m(d){const c=ne.join(t.value,d);await i.createDirectory(ne.join(te,c));const E=await ir(i,c);return a.value=[...a.value,E],E}async function u(){h.value&&h.value.cancel(),f.value=!0,e.value==="favorites"?h.value=li(i,t.value):e.value==="recent"?h.value=er(i):h.value=tr(i,t.value);const d=await h.value;"folder"in d?(l.value=d.folder,a.value=d.contents):(l.value=null,a.value=d),h.value=null,f.value=!1}return rt([e,t],()=>u()),J(()=>u()),{isLoading:f,files:a,folder:l,loadFiles:u,createDirectory:m}},rr=function(e){const t=I(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const a=i.split("/");return t.value.some(([l,f])=>(a[0]===l||l==="*")&&(a[1]===f||f==="*"))}}},ar={name:"FilePicker"},sr=j({...ar,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},canPickFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:t}){const i=e,a=b(!0),l=I(()=>{const w=d.value.length===0&&i.allowPickDirectory&&R.value?[R.value]:d.value;return(typeof i.buttons=="function"?i.buttons(w,_.value,m.value):i.buttons).map(A=>({...A,disabled:A.disabled||F.value,callback:()=>{f=!0,h(A.callback,w)}}))});let f=!1;const h=async(w,A)=>{w(A),t("close",A),f=!1},m=b("files"),u=I(()=>m.value==="favorites"?S("Favorites"):m.value==="recent"?S("Recent"):""),d=be([]),c=b(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),E=b("");rt([E],()=>{i.path===void 0&&E.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",E.value),d.value=[]});const _=I({get:()=>m.value==="files"?E.value||i.path||c.value:"/",set:w=>{E.value=w}}),y=b(""),{isSupportedMimeType:U}=rr(at(i,"mimetypeFilter")),{files:g,folder:R,isLoading:F,loadFiles:$,createDirectory:V}=nr(m,_);J(()=>$());const{showHiddenFiles:v}=vt(),B=I(()=>{let w=g.value;return v.value||(w=w.filter(A=>!A.basename.startsWith("."))),i.mimetypeFilter.length>0&&(w=w.filter(A=>A.type==="folder"||A.mime&&U(A.mime))),y.value&&(w=w.filter(A=>A.basename.toLowerCase().includes(y.value.toLowerCase()))),i.filterFn&&(w=w.filter(A=>i.filterFn(A))),w}),q=I(()=>m.value==="files"?S("Upload some content or sync with your devices!"):m.value==="recent"?S("Files and folders you recently modified will show up here."):S("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:i,emit:t,isOpen:a,dialogButtons:l,isHandlingCallback:f,handleButtonClick:h,currentView:m,viewHeadline:u,selectedFiles:d,savedPath:c,navigatedPath:E,currentPath:_,filterString:y,isSupportedMimeType:U,files:g,currentFolder:R,isLoading:F,loadFiles:$,createDirectory:V,showHiddenFiles:v,filteredFiles:B,noFilesDescription:q,onCreateFolder:async w=>{try{const A=await V(w);E.value=A.path,Pt("files:node:created",g.value.filter(o=>o.basename===w)[0])}catch(A){console.warn("Could not create new folder",{name:w,error:A}),Ce(S("Could not create the new folder"))}},handleClose:w=>{!w&&!f&&t("close")},IconFile:gt,FileList:Nn,FilePickerBreadcrumbs:$n,FilePickerNavigation:Jn,NcDialog:Mt,NcEmptyContent:Wt,t:S}}});var or=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcDialog,{attrs:{open:i.isOpen,container:e.container,buttons:i.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(a){i.isOpen=a},i.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:a}){return[t(i.FilePickerNavigation,{attrs:{"current-view":i.currentView,"filter-string":i.filterString,"is-collapsed":a,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(l){i.currentView=l},"update:current-view":function(l){i.currentView=l},"update:filterString":function(l){i.filterString=l},"update:filter-string":function(l){i.filterString=l}}})]}}])},[t("div",{staticClass:"file-picker__main"},[i.currentView==="files"?t(i.FilePickerBreadcrumbs,{attrs:{path:i.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(a){i.currentPath=a},"create-node":i.onCreateFolder}}):t("div",{staticClass:"file-picker__view"},[t("h3",[e._v(e._s(i.viewHeadline))])]),i.isLoading||i.filteredFiles.length>0?t(i.FileList,{attrs:{path:i.currentPath,"selected-files":i.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":i.currentView,files:i.filteredFiles,multiselect:e.multiselect,loading:i.isLoading,name:i.viewHeadline,"can-pick":e.canPickFn},on:{"update:path":[function(a){i.currentPath=a},function(a){i.currentView="files"}],"update:selectedFiles":function(a){i.selectedFiles=a},"update:selected-files":function(a){i.selectedFiles=a}}}):i.filterString?t(i.NcEmptyContent,{attrs:{name:i.t("No matching files"),description:i.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])}):t(i.NcEmptyContent,{attrs:{name:i.t("No files in here"),description:i.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])})],1)])},cr=[],lr=P(sr,or,cr,!1,null,"dda9b42b");const Cr=lr.exports;export{Cr as default};
//# sourceMappingURL=FilePicker-lO8J1a0C-DG-ROPac.chunk.mjs.map

import{I as n,a as i}from"./index-Dt0wq4bO.chunk.mjs";import{d as o}from"./vue.runtime.esm-OiydnxB-.chunk.mjs";import{n as s,t as r}from"./index-DPkUyJ8g-BlLzolVA.chunk.mjs";import{N as l}from"./NcDialog-Bu9xyU24-In8X1aeg.chunk.mjs";import{N as m}from"./NcTextField-DLlQozKA-Cjumguf1.chunk.mjs";import{N as d}from"./NcNoteCard-MWGt2wnX.chunk.mjs";import"./preload-helper-CPULxMJS.chunk.mjs";import"./index-COmVzmHC.chunk.mjs";import"./index-DuF3OKwX.chunk.mjs";import"./index-ycziVi-9.chunk.mjs";import"./dialog-CiY8TRVl.chunk.mjs";import"./useHotKey-DwbsMrnX.chunk.mjs";import"./NcActionButton-1gSJfFUC-DtAb5qOU.chunk.mjs";import"./NcProgressBar-D7zYeXBH-B7c0IkhC.chunk.mjs";import"./useModelMigration-EhAWvqDD-CCVvXBPb.chunk.mjs";const c=o({components:{NcDialog:l,NcNoteCard:d,NcTextField:m},props:{error:{type:n,required:!0},validateFilename:{type:Function,required:!0}},setup(){return{t:r}},data(){return{newName:"",validationError:""}},computed:{isValidName(){return this.validationError===""},isInvalidFileType(){return this.error.reason===i.Extension&&this.error.segment.match(/^\.\w/)!==null},canRename(){return!this.isInvalidFileType},dialogButtons(){const e=[{label:r("Cancel"),type:"error",callback:()=>{this.$emit("close",{cancel:!0})}},{label:r("Skip"),callback:()=>{this.$emit("close",{skip:!0})}}];return this.canRename&&e.push({label:r("Rename"),type:"primary",disabled:!this.isValidName,callback:()=>{this.$emit("close",{rename:this.newName.trimEnd()})}}),e}},watch:{error:{handler(){this.validationError=this.getErrorText(this.error),this.newName=this.error.filename},immediate:!0},newName(){var e;try{this.validateFilename(this.newName.trimEnd()),this.validationError=""}catch(t){this.validationError=this.getErrorText(t)}finally{const t=(e=this.$refs.textfield)==null?void 0:e.$el.querySelector("input");t&&(t.setCustomValidity(this.validationError),t.reportValidity())}}},methods:{getErrorText(e){switch(e.reason){case i.Character:return r('"{segment}" is not allowed inside a file or folder name.',{segment:e.segment});case i.ReservedName:return r('"{segment}" is a forbidden file or folder name.',{segment:e.segment});case i.Extension:return e.segment.match(/\.\w/)?r('"{segment}" is a forbidden file type.',{segment:e.segment}):r('Filenames must not end with "{segment}".',{segment:e.segment})}}}});var p=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("NcDialog",{attrs:{buttons:e.dialogButtons,name:e.t("Invalid filename")},on:{close:function(a){return e.$emit("close",{cancel:!0})}}},[t("NcNoteCard",{attrs:{severity:"error"}},[e._v(" "+e._s(e.getErrorText(e.error))+" "+e._s(e.t("You can either rename the file, skip this file or cancel the whole operation."))+" ")]),e.canRename?t("NcTextField",{ref:"textfield",staticClass:"invalid-filename-dialog__input",attrs:{error:!e.isValidName,"helper-text":e.validationError,label:e.t("New filename"),value:e.newName},on:{"update:value":function(a){e.newName=a}}}):e._e()],1)},h=[],u=s(c,p,h,!1,null,"9d7d9a49");const R=u.exports;export{R as default};
//# sourceMappingURL=InvalidFilenameDialog-BM2VDeLo-DUhtxcWJ.chunk.mjs.map

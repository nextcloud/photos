{"version":3,"file":"InvalidFilenameDialog-BYpqWa7P-BkfDn6qz.chunk.mjs","sources":["../node_modules/@nextcloud/upload/dist/chunks/InvalidFilenameDialog-BYpqWa7P.mjs"],"sourcesContent":["import '../assets/InvalidFilenameDialog-YDOzIzS6.css';\nimport { InvalidFilenameError, InvalidFilenameErrorReason } from \"@nextcloud/files\";\nimport { defineComponent } from \"vue\";\nimport { t, n as normalizeComponent } from \"./index-DdKmqUaK.mjs\";\nimport NcDialog from \"@nextcloud/vue/dist/Components/NcDialog.js\";\nimport NcTextField from \"@nextcloud/vue/dist/Components/NcTextField.js\";\nimport NcNoteCard from \"@nextcloud/vue/dist/Components/NcNoteCard.js\";\nconst _sfc_main = defineComponent({\n  components: {\n    NcDialog,\n    NcNoteCard,\n    NcTextField\n  },\n  props: {\n    error: {\n      type: InvalidFilenameError,\n      required: true\n    },\n    /**\n     * @deprecated just for legacy reasons, replace with function from @nextcloud/files in future\n     */\n    validateFilename: {\n      type: Function,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      t\n    };\n  },\n  data() {\n    return {\n      newName: \"\",\n      validationError: \"\"\n    };\n  },\n  computed: {\n    isValidName() {\n      return this.validationError === \"\";\n    },\n    isInvalidFileType() {\n      return this.error.reason === InvalidFilenameErrorReason.Extension && this.error.segment.match(/^\\.\\w/) !== null;\n    },\n    canRename() {\n      return !this.isInvalidFileType;\n    },\n    dialogButtons() {\n      const buttons = [\n        {\n          label: t(\"Cancel\"),\n          type: \"error\",\n          callback: () => {\n            this.$emit(\"close\", { cancel: true });\n          }\n        },\n        {\n          label: t(\"Skip\"),\n          callback: () => {\n            this.$emit(\"close\", { skip: true });\n          }\n        }\n      ];\n      if (this.canRename) {\n        buttons.push({\n          label: t(\"Rename\"),\n          type: \"primary\",\n          disabled: !this.isValidName,\n          callback: () => {\n            this.$emit(\"close\", { rename: this.newName.trimEnd() });\n          }\n        });\n      }\n      return buttons;\n    }\n  },\n  watch: {\n    error: {\n      handler() {\n        this.validationError = this.getErrorText(this.error);\n        this.newName = this.error.filename;\n      },\n      immediate: true\n    },\n    newName() {\n      try {\n        this.validateFilename(this.newName.trimEnd());\n        this.validationError = \"\";\n      } catch (error) {\n        this.validationError = this.getErrorText(error);\n      } finally {\n        const textfield = this.$refs.textfield?.$el.querySelector(\"input\");\n        if (textfield) {\n          textfield.setCustomValidity(this.validationError);\n          textfield.reportValidity();\n        }\n      }\n    }\n  },\n  methods: {\n    getErrorText(error) {\n      switch (error.reason) {\n        case InvalidFilenameErrorReason.Character:\n          return t('\"{segment}\" is not allowed inside a file or folder name.', { segment: error.segment });\n        case InvalidFilenameErrorReason.ReservedName:\n          return t('\"{segment}\" is a forbidden file or folder name.', { segment: error.segment });\n        case InvalidFilenameErrorReason.Extension:\n          return error.segment.match(/\\.\\w/) ? t('\"{segment}\" is a forbidden file type.', { segment: error.segment }) : t('Filenames must not end with \"{segment}\".', { segment: error.segment });\n      }\n    }\n  }\n});\nvar _sfc_render = function render() {\n  var _vm = this, _c = _vm._self._c;\n  _vm._self._setupProxy;\n  return _c(\"NcDialog\", { attrs: { \"buttons\": _vm.dialogButtons, \"name\": _vm.t(\"Invalid filename\") }, on: { \"close\": function($event) {\n    return _vm.$emit(\"close\", { cancel: true });\n  } } }, [_c(\"NcNoteCard\", { attrs: { \"severity\": \"error\" } }, [_vm._v(\" \" + _vm._s(_vm.getErrorText(_vm.error)) + \" \" + _vm._s(_vm.t(\"You can either rename the file, skip this file or cancel the whole operation.\")) + \" \")]), _vm.canRename ? _c(\"NcTextField\", { ref: \"textfield\", staticClass: \"invalid-filename-dialog__input\", attrs: { \"error\": !_vm.isValidName, \"helper-text\": _vm.validationError, \"label\": _vm.t(\"New filename\"), \"value\": _vm.newName }, on: { \"update:value\": function($event) {\n    _vm.newName = $event;\n  } } }) : _vm._e()], 1);\n};\nvar _sfc_staticRenderFns = [];\nvar __component__ = /* @__PURE__ */ normalizeComponent(\n  _sfc_main,\n  _sfc_render,\n  _sfc_staticRenderFns,\n  false,\n  null,\n  \"3a479259\"\n);\nconst InvalidFilenameDialog = __component__.exports;\nexport {\n  InvalidFilenameDialog as default\n};\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}
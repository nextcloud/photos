import{r as u,b as f}from"./vue.runtime.esm-OiydnxB-.chunk.mjs";import{m as a}from"./index-Dt0wq4bO.chunk.mjs";import{p as h,j as y,g as b,d as g,a as v}from"./index-ycziVi-9.chunk.mjs";var w=Object.defineProperty,s=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,n=(d,e,t)=>e in d?w(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t,j=(d,e)=>{for(var t in e||(e={}))x.call(e,t)&&n(d,t,e[t]);if(s)for(var t of s(e))O.call(e,t)&&n(d,t,e[t]);return d};async function D(d={}){const e=j({firstResult:0,nbResults:200,mimesType:v,onThisDay:!1,onlyFavorites:!1,full:!1,extraFilters:""},d),t=e.mimesType.reduce((r,o)=>"".concat(r,"\n		<d:eq>\n			<d:prop>\n				<d:getcontenttype/>\n			</d:prop>\n			<d:literal>").concat(o,"</d:literal>\n		</d:eq>\n	"),""),c=e.onlyFavorites?"<d:eq>\n				<d:prop>\n					<oc:favorite/>\n				</d:prop>\n				<d:literal>1</d:literal>\n			</d:eq>":"",l=e.onThisDay?"<d:or>".concat(Array(20).fill(1).map((r,o)=>{const p=a(Date.now()).startOf("day").subtract(3,"d").subtract(o+1,"y"),m=a(Date.now()).endOf("day").add(3,"d").subtract(o+1,"y");return"<d:and>\n				<d:gt>\n					<d:prop>\n						<nc:metadata-photos-original_date_time/>\n					</d:prop>\n					<d:literal>".concat(p.valueOf()/1e3,"</d:literal>\n				</d:gt>\n				<d:lt>\n					<d:prop>\n						<nc:metadata-photos-original_date_time/>\n					</d:prop>\n					<d:literal>").concat(m.valueOf()/1e3,"</d:literal>\n				</d:lt>\n			</d:and>")}).join("\n"),"</d:or>"):"",i=h.state.userConfig.photosSourceFolders.map(r=>"\n			<d:scope>\n				<d:href>".concat(y(f,r),"</d:href>\n				<d:depth>infinity</d:depth>\n			</d:scope>")).join("\n");return e.data='<?xml version="1.0" encoding="UTF-8"?>\n		<d:searchrequest xmlns:d="DAV:"\n			xmlns:oc="http://owncloud.org/ns"\n			xmlns:nc="http://nextcloud.org/ns"\n			xmlns:ns="https://github.com/icewind1991/SearchDAV/ns"\n			xmlns:ocs="http://open-collaboration-services.org/ns">\n			<d:basicsearch>\n				<d:select>\n					<d:prop>\n						'.concat(b(),"\n					</d:prop>\n				</d:select>\n				<d:from>\n					").concat(i,"\n				</d:from>\n				<d:where>\n					<d:and>\n						<d:or>\n							").concat(t,"\n						</d:or>\n						").concat(c,"\n						").concat(l,"\n						").concat(e.extraFilters,"\n					</d:and>\n				</d:where>\n				<d:orderby>\n					<d:order>\n						<d:prop><nc:metadata-photos-original_date_time/></d:prop>\n						<d:descending/>\n					</d:order>\n					<d:order>\n						<d:prop><d:getlastmodified/></d:prop>\n						<d:descending/>\n					</d:order>\n				</d:orderby>\n				<d:limit>\n					<d:nresults>").concat(e.nbResults,"</d:nresults>\n					<ns:firstresult>").concat(e.firstResult,"</ns:firstresult>\n				</d:limit>\n			</d:basicsearch>\n		</d:searchrequest>"),e.details=!0,(await g.search("/",e)).data.results.map(r=>(r.filename=r.filename.replace(/^\/remote.php\/dav/,""),r)).map(r=>u(r))}export{D as g};
//# sourceMappingURL=PhotoSearch-D9pXMTwk.chunk.mjs.map

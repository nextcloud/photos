{"version":3,"file":"PhotosSourceLocationsSettings-C87KS544.chunk.mjs","sources":["../src/components/Settings/PhotosFolder.vue","../src/components/Settings/PhotosSourceLocationsSettings.vue"],"sourcesContent":["<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div class=\"folder\">\n\t\t<component :is=\"rootFolderIcon\" v-if=\"path === '/'\" />\n\t\t<Folder v-else />\n\t\t<span class=\"folder__info\">\n\t\t\t<div class=\"folder__path\">{{ folderName }}</div>\n\t\t\t<div v-if=\"subname !== ''\">\n\t\t\t\t{{ subname }}\n\t\t\t</div>\n\t\t</span>\n\t\t<NcButton\n\t\t\tv-if=\"canDelete\"\n\t\t\ttype=\"tertiary\"\n\t\t\t:aria-label=\"t('photos', 'Delete source directory')\"\n\t\t\t@click=\"emitRemoveSourceFolder\">\n\t\t\t<template #icon>\n\t\t\t\t<Close :size=\"20\" />\n\t\t\t</template>\n\t\t</NcButton>\n\t</div>\n</template>\n\n<script lang='ts'>\nimport { t } from '@nextcloud/l10n'\nimport { defineComponent } from 'vue'\nimport NcButton from '@nextcloud/vue/components/NcButton'\nimport Close from 'vue-material-design-icons/Close.vue'\nimport Folder from 'vue-material-design-icons/Folder.vue'\n\nexport default defineComponent({\n\tname: 'PhotosFolder',\n\n\tcomponents: {\n\t\tNcButton,\n\t\tFolder,\n\t\tClose,\n\t},\n\n\tprops: {\n\t\tpath: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\tcanDelete: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\n\t\trootFolderLabel: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\trootFolderIcon: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['remove-folder'],\n\n\tcomputed: {\n\t\tfolderName() {\n\t\t\tif (this.path === '/') {\n\t\t\t\treturn this.rootFolderLabel\n\t\t\t} else {\n\t\t\t\treturn this.path.split('/').pop()\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Return the summary path of the folder\n\t\t * Examples:\n\t\t *  - /        ==> Home\n\t\t *  - /a       ==> nothing\n\t\t *  - /a/b     ==> /a\n\t\t *  - /a/b/c   ==> /a/b\n\t\t *  - /a/b/c/d ==> /a/b\n\t\t */\n\t\tsubname() {\n\t\t\tconst slashesCount = (this.path.match(/\\//g) ?? []).length\n\n\t\t\tswitch (slashesCount) {\n\t\t\t\tcase 1:\n\t\t\t\t\treturn ''\n\t\t\t\tcase 2:\n\t\t\t\t\treturn this.path.split('/').splice(0, 2).join('/')\n\t\t\t\tdefault:\n\t\t\t\t\treturn this.path.split('/').splice(0, 3).join('/')\n\t\t\t}\n\t\t},\n\t},\n\n\tmethods: {\n\t\temitRemoveSourceFolder() {\n\t\t\tthis.$emit('remove-folder')\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.folder {\n\tdisplay: flex;\n\tgap: 16px;\n\tmin-width: 300px;\n\n\t&__info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tflex-grow: 1;\n\t\tjustify-content: center;\n\t}\n\n\t&__path {\n\t\tfont-weight: bold;\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div class=\"photos-locations-container\">\n\t\t<div class=\"photos-locations\">\n\t\t\t<li\n\t\t\t\tv-for=\"(source, index) in photosSourceFolders\"\n\t\t\t\t:key=\"index\">\n\t\t\t\t<PhotosFolder\n\t\t\t\t\t:path=\"source\"\n\t\t\t\t\t:can-delete=\"photosSourceFolders.length !== 1\"\n\t\t\t\t\t:root-folder-label=\"t('photos', 'All folders')\"\n\t\t\t\t\t:root-folder-icon=\"FolderMultiple\"\n\t\t\t\t\t@remove-folder=\"removeSourceFolder(index)\" />\n\t\t\t</li>\n\t\t</div>\n\n\t\t<NcButton\n\t\t\t:aria-label=\"t('photos', 'Add a Photos source for the timelines')\"\n\t\t\t@click=\"debounceAddSourceFolder\">\n\t\t\t<template #icon>\n\t\t\t\t<Plus :size=\"20\" />\n\t\t\t</template>\n\t\t\t{{ t('photos', 'Add folder') }}\n\t\t</NcButton>\n\t</div>\n</template>\n\n<script lang='ts'>\nimport { getFilePickerBuilder } from '@nextcloud/dialogs'\nimport { t } from '@nextcloud/l10n'\nimport debounce from 'debounce'\nimport { defineComponent } from 'vue'\nimport NcButton from '@nextcloud/vue/components/NcButton'\nimport FolderMultiple from 'vue-material-design-icons/FolderMultiple.vue'\nimport Plus from 'vue-material-design-icons/Plus.vue'\nimport PhotosFolder from './PhotosFolder.vue'\nimport logger from '../../services/logger.js'\n\nexport default defineComponent({\n\tname: 'PhotosSourceLocationsSettings',\n\n\tcomponents: {\n\t\tNcButton,\n\t\tPhotosFolder,\n\t\tPlus,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tFolderMultiple,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tphotosSourceFolders(): string[] {\n\t\t\treturn this.$store.state.userConfig.photosSourceFolders\n\t\t},\n\t},\n\n\tmethods: {\n\t\tdebounceAddSourceFolder: debounce(function(...args) {\n\t\t\tthis.addSourceFolder(...args)\n\t\t}, 200, { immediate: false }),\n\n\t\tasync openFilePicker(title: string): Promise<string> {\n\t\t\tconst picker = getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.addMimeTypeFilter('httpd/unix-directory')\n\t\t\t\t.allowDirectories()\n\t\t\t\t.addButton({\n\t\t\t\t\tlabel: t('photos', 'Pick folder'),\n\t\t\t\t\tcallback: (nodes) => logger.debug('Picked', { nodes }),\n\t\t\t\t})\n\t\t\t\t.build()\n\n\t\t\treturn picker.pick()\n\t\t},\n\n\t\tasync addSourceFolder() {\n\t\t\tconst pickedFolder = await this.openFilePicker(t('photos', 'Select a source folder for your media'))\n\t\t\tif (this.photosSourceFolders.includes(pickedFolder)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.$store.dispatch('updateUserConfig', { key: 'photosSourceFolders', value: [...this.photosSourceFolders, pickedFolder] })\n\t\t},\n\n\t\tremoveSourceFolder(index) {\n\t\t\tconst folders = [...this.photosSourceFolders]\n\t\t\tfolders.splice(index, 1)\n\t\t\tthis.$store.dispatch('updateUserConfig', { key: 'photosSourceFolders', value: folders })\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.photos-locations-container {\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: fit-content;\n\n\t.photos-locations {\n\t\tmargin-bottom: 16px;\n\n\t\tli {\n\t\t\tlist-style: none;\n\t\t}\n\t}\n}\n</style>\n"],"names":["_sfc_main$1","defineComponent","NcButton","Folder","Close","t","_sfc_main","PhotosFolder","Plus","FolderMultiple","debounce","args","title","getFilePickerBuilder","nodes","logger","pickedFolder","index","folders"],"mappings":"qRAkCA,MAAAA,EAAAC,EAAA,CACA,KAAA,eAEA,WAAA,CACA,SAAAC,EAAA,OACAC,EACA,MAAAC,CACA,EAEA,MAAA,CACA,KAAA,CACA,KAAA,OACA,SAAA,EACA,EAEA,UAAA,CACA,KAAA,QACA,QAAA,EACA,EAEA,gBAAA,CACA,KAAA,OACA,SAAA,EACA,EAEA,eAAA,CACA,KAAA,OACA,SAAA,EAAA,CAEA,EAEA,MAAA,CAAA,eAAA,EAEA,SAAA,CACA,YAAA,CACA,OAAA,KAAA,OAAA,IACA,KAAA,gBAEA,KAAA,KAAA,MAAA,GAAA,EAAA,IAAA,CAEA,EAWA,SAAA,CAGA,QAFA,KAAA,KAAA,MAAA,KAAA,GAAA,CAAA,GAAA,OAEA,CACA,IACA,GAAA,MAAA,GACA,IAAA,GACA,OAAA,KAAA,KAAA,MAAA,GAAA,EAAA,OAAA,EAAA,CAAA,EAAA,KAAA,GAAA,EACA,QACA,OAAA,KAAA,KAAA,MAAA,GAAA,EAAA,OAAA,EAAA,CAAA,EAAA,KAAA,GAAA,CAAA,CACA,CAEA,EAEA,QAAA,CACA,wBAAA,CACA,KAAA,MAAA,eAAA,CACA,EAEAC,CAAA,CAEA,CAAA,6oBChEAC,EAAAL,EAAA,CACA,KAAA,gCAEA,WAAA,CACA,SAAAC,EACA,aAAAK,EACA,KAAAC,CACA,EAEA,MAAA,CACA,MAAA,CACA,eAAAC,CACA,CACA,EAEA,SAAA,CACA,qBAAA,CACA,OAAA,KAAA,OAAA,MAAA,WAAA,mBAAA,CAEA,EAEA,QAAA,CACA,wBAAAC,EAAA,YAAAC,EAAA,CACA,KAAA,gBAAA,GAAAA,CAAA,CACA,EAAA,IAAA,CAAA,UAAA,GAAA,EAEA,MAAA,eAAAC,EAAA,CAWA,OAVAC,EAAAD,CAAA,EACA,eAAA,EAAA,EACA,kBAAA,sBAAA,EACA,iBAAA,EACA,UAAA,CACA,MAAAP,EAAA,SAAA,aAAA,EACA,SAAAS,GAAAC,EAAA,MAAA,SAAA,CAAA,MAAAD,CAAA,CAAA,CACA,CAAA,EACA,MAAA,EAEA,KAAA,CACA,EAEA,MAAA,iBAAA,CACA,MAAAE,EAAA,MAAA,KAAA,eAAAX,EAAA,SAAA,uCAAA,CAAA,EACA,KAAA,oBAAA,SAAAW,CAAA,GAGA,KAAA,OAAA,SAAA,mBAAA,CAAA,IAAA,sBAAA,MAAA,CAAA,GAAA,KAAA,oBAAAA,CAAA,EAAA,CACA,EAEA,mBAAAC,EAAA,CACA,MAAAC,EAAA,CAAA,GAAA,KAAA,mBAAA,EACAA,EAAA,OAAAD,EAAA,CAAA,EACA,KAAA,OAAA,SAAA,mBAAA,CAAA,IAAA,sBAAA,MAAAC,EAAA,CACA,EAEAb,CAAA,CAEA,CAAA"}
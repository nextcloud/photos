import{t as a,h as n,C as s,D as r}from"./index-Cyn8tcq_.chunk.mjs";import"./NcActionButton-DykQxmXJ-DfC4xMBk.chunk.mjs";import{F as m,z as c,H as e,A as u,I as i}from"./index-DX2SbTk6.chunk.mjs";import"./NcColorPicker-CYzA8Dxx.chunk.mjs";import"./NcProgressBar-D7zYeXBH-BJ-8evEW.chunk.mjs";import"./NcBreadcrumbs-BPfsSByZ-BD4lMBVt.chunk.mjs";import"./NcAvatar-D5nljVEA-CqudfoYn.chunk.mjs";import"./video-CN-8rN3C.chunk.mjs";import"./NcFormBoxButton-C6EvdLK4-B04j2RhN.chunk.mjs";import"./useHotKey-U4kMc8_n.chunk.mjs";import"./createElementId-DhjFt1I9-B2HCdIOx.chunk.mjs";import"./NcCheckboxRadioSwitch-DAPHFb0L-C5yI6tHT.chunk.mjs";import"./useFormatDateTime-BLrrQzS3.chunk.mjs";import"./NcDateTimePicker-CPx6U3yK.chunk.mjs";import"./NcSelect-DTniMiUS-BSLDsywC.chunk.mjs";import{N as p}from"./NcEmptyContent-BUSMgf3R.chunk.mjs";import"./NcTextField-CfZknuqx-NIse9ogT.chunk.mjs";import"./NcSelectUsers-RyUVUaWQ-CJ0Vfb-h.chunk.mjs";import"./NcUserBubble-VLY4hn5K-aXVRNSK2.chunk.mjs";import{m as h,M as b,n as d}from"./icons-CDOHk7t6.chunk.mjs";import{C as f}from"./CollectionContent-BJTmp7bn.chunk.mjs";import{H as g}from"./HeaderNavigation-TGG6NM0U.chunk.mjs";import{F as C}from"./FetchCollectionContentMixin-67X8q0Tu.chunk.mjs";import"./index-BKNYV8jx.chunk.mjs";import"./index-BZR1y71w.chunk.mjs";import"./useModelMigration-EhAWvqDD-B5MytT5w.chunk.mjs";import"./index-BEAJDltQ.chunk.mjs";import"./FileComponent-BeLIm01X.chunk.mjs";import"./FilesSelectionMixin-D6tIj8IU.chunk.mjs";import"./fileFetcher-BQ4eAwfl.chunk.mjs";import"./collectionFetcher-Dc1KYokQ.chunk.mjs";import"./AbortControllerMixin-Dh9iWmJw.chunk.mjs";const F={computed:{isMobile(){return m.value}}},v={name:"PublicAlbumContent",components:{MapMarkerOutline:b,ImageOffOutline:h,NcEmptyContent:p,NcActions:c,CollectionContent:f,HeaderNavigation:g},mixins:[C,F],props:{token:{type:String,required:!0}},data(){return{showAddPhotosModal:!1,loadingCount:0,loadingAddFilesToAlbum:!1,albumOriginalName:"",publicClient:s(r("dav"),{Authorization:`Basic ${btoa(`${this.token}:`)}`})}},computed:{album(){return this.$store.getters.getPublicAlbum(this.albumName)},albumName(){return this.token},albumFileIds(){return this.$store.getters.getPublicAlbumFiles(this.albumName)},publicAlbumFileName(){return this.$store.getters.getPublicAlbumName(this.albumName)}},async beforeMount(){await this.fetchAlbumInfo(),await this.fetchAlbumContent()},methods:{async fetchAlbumInfo(){const t=await this.fetchCollection(`${e}/${this.token}`,i,this.publicClient);t!==null&&(this.albumOriginalName=t.attributes["original-name"])},async fetchAlbumContent(){(await this.fetchCollectionFiles(`${e}/${this.token}`,[...u,...i],this.publicClient)).forEach(t=>{t.update({previewUrl:n(`/apps/photos/api/v1/publicPreview/${t.fileid}?x=4096&y=4096&token=${this.token}`),hasPreview:!1})})},async handleFilesPicked(t){this.showAddPhotosModal=!1,await this.$store.dispatch("addFilesToCollection",{collectionFileName:this.album.root+this.albumName,fileIdsToAdd:t}),await this.fetchAlbumContent()},async handleRemoveFilesFromAlbum(t){this.$refs.collectionContent.onUncheckFiles(t),await this.$store.dispatch("removeFilesFromCollection",{collectionFileName:this.album.root+this.albumName,fileIdsToRemove:t})},t:a}};var N=function(){var t=this,o=t._self._c;return o("div",[o("CollectionContent",{ref:"collectionContent",attrs:{collection:t.album,"collection-file-ids":t.albumFileIds,"allow-selection":!1,loading:t.loadingCollection||t.loadingCollectionFiles,error:t.errorFetchingCollection||t.errorFetchingCollectionFiles},scopedSlots:t._u([{key:"header",fn:function({selectedFileIds:l}){return t.albumOriginalName!==""?o("HeaderNavigation",{key:"navigation",attrs:{loading:t.loadingCollection||t.loadingCollectionFiles,params:{token:t.token},path:"/","root-title":t.albumOriginalName,title:t.albumOriginalName},on:{refresh:t.fetchAlbumContent}},[t.album.attributes.location!==""?o("div",{staticClass:"album__location",attrs:{slot:"subtitle"},slot:"subtitle"},[o("MapMarkerOutline"),t._v(t._s(t.album.attributes.location)+" ")],1):t._e(),t.album!==void 0?o("template",{slot:"right"},[o("NcActions",{attrs:{"force-menu":!0,"aria-label":t.t("photos","Open actions menu")}},[l.length>0?void 0:t._e()],2)],1):t._e()],2):t._e()}}],null,!0)},[o("NcEmptyContent",{staticClass:"album__empty",attrs:{slot:"empty-content",name:t.t("photos","This album does not have any photos or videos yet!")},slot:"empty-content"},[o("ImageOffOutline",{attrs:{slot:"icon"},slot:"icon"})],1)],1)],1)},A=[],y=d(v,N,A,!1,null,"46c7b0a7");const et=y.exports;export{et as default};
//# sourceMappingURL=PublicAlbumContent-DcOMAy61.chunk.mjs.map

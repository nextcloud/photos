import{a,t as n}from"./vue.runtime.esm-CgV0NZOD.chunk.mjs";import{u as r}from"./index-DetBNuUF.chunk.mjs";import{N as l}from"./NcActionButton-CpGK6gSX-BnfngIri.chunk.mjs";import{f as c,s as h,ag as o,l as p}from"./index-mp1XnZYt.chunk.mjs";import{N as d}from"./NcEmptyContent-Cp3DHWlv.chunk.mjs";import{q as g,n as f}from"./icons-CG9j2hi8.chunk.mjs";import{F as m}from"./FileComponent-CsVjcvAM.chunk.mjs";import{F as u,a as C}from"./FilesSelectionMixin-C1CvAUfK.chunk.mjs";import{A as w}from"./AbortControllerMixin-BnD5BHDy.chunk.mjs";import"./index-Ce7iYg--.chunk.mjs";import"./preload-helper-Dh9HmuEY.chunk.mjs";import"./NcCheckboxRadioSwitch-BIEYfWtF-DjNh97v8.chunk.mjs";import"./useModelMigration-EhAWvqDD-k0RoVAnp.chunk.mjs";import"./fileFetcher-DmMkpmMb.chunk.mjs";const y={name:"TagContent",components:{FileComponent:m,FilesListViewer:C,NcEmptyContent:d,NcActions:h,NcActionButton:l,NcLoadingIcon:c,ArrowLeft:g},mixins:[u,w],props:{path:{type:String,default:""}},setup(){return{isMobile:r()}},data(){return{error:null,loading:!1,appContent:document.getElementById("app-content-vue")}},computed:{files(){return this.$store.state.files.files},tags(){return this.$store.state.systemtags.tags},tagId(){return this.$store.getters.tagId(this.path)},tag(){return this.tags[this.tagId]},fileIds(){return this.$store.state.systemtags.tagsFiles[this.tagId]},isEmpty(){return this.fileIds.length===0}},watch:{async path(){this.fetchContent()}},async beforeMount(){this.fetchContent()},methods:{async fetchContent(){window.OCA.Viewer.close(),this.loading=!0,this.error=null;try{this.tags[this.tagId]||await this.$store.dispatch("fetchAllTags",{signal:this.abortController.signal}),this.tag&&!this.fileIds&&await this.$store.dispatch("fetchTagFiles",{id:this.tagId,signal:this.abortController.signal})}catch(t){p.error("Failed to fetch tags",{error:t}),this.error=!0}finally{this.loading=!1}},openViewer(t){window.OCA.Viewer.open({fileInfo:o(this.files[t]),list:this.fileIds.map(s=>o(this.files[s]))})},t:n,n:a}};var _=function(){var t=this,s=t._self._c;return t.error?s("NcEmptyContent",{attrs:{name:t.t("photos","An error occurred")}}):t.loading?s("NcLoadingIcon",{staticClass:"loader"}):s("div",[s("div",{staticClass:"photos-navigation"},[s("NcActions",{staticClass:"photos-navigation__back"},[s("NcActionButton",{on:{click:function(e){return t.$router.push({name:"tags"})}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("ArrowLeft")]},proxy:!0}])},[t._v(" "+t._s(t.t("photos","Back to tags overview"))+" ")])],1),s("h2",{staticClass:"photos-navigation__title"},[t._v(" "+t._s(t.path)+" ")])],1),s("div",{staticClass:"heading-subline"},[t._v(" "+t._s(t.n("photos","%n photo","%n photos",t.fileIds.length))+" ")]),t.isEmpty?s("NcEmptyContent",{attrs:{name:t.t("photos","No photos with this tag yet")}}):t._e(),s("FilesListViewer",{staticClass:"tag__photos",attrs:{"container-element":t.appContent,"file-ids":t.fileIds,"base-height":t.isMobile?120:200,loading:t.loading},scopedSlots:t._u([{key:"default",fn:function({file:e,distance:i}){return s("FileComponent",{attrs:{file:t.files[e.id],"allow-selection":!0,selected:t.selection[e.id]===!0,distance:i},on:{click:t.openViewer,"select-toggled":t.onFileSelectToggle}})}}])})],1)},I=[],v=f(y,_,I,!1,null,"6de1acf5");const O=v.exports;export{O as default};
//# sourceMappingURL=TagContent-DkXH6U_j.chunk.mjs.map

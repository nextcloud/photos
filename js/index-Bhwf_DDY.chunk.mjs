import{A as T}from"./vue.runtime.esm-Bphz5Mz8.chunk.mjs";import{E}from"./index-oIyADb1j.chunk.mjs";var p,b;function I(){if(b)return p;b=1;function m(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function e(t,i){for(var r="",o=0,h=-1,n=0,l,a=0;a<=t.length;++a){if(a<t.length)l=t.charCodeAt(a);else{if(l===47)break;l=47}if(l===47){if(!(h===a-1||n===1))if(h!==a-1&&n===2){if(r.length<2||o!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var f=r.lastIndexOf("/");if(f!==r.length-1){f===-1?(r="",o=0):(r=r.slice(0,f),o=r.length-1-r.lastIndexOf("/")),h=a,n=0;continue}}else if(r.length===2||r.length===1){r="",o=0,h=a,n=0;continue}}i&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+t.slice(h+1,a):r=t.slice(h+1,a),o=a-h-1;h=a,n=0}else l===46&&n!==-1?++n:n=-1}return r}function s(t,i){var r=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return r?r===i.root?r+o:r+t+o:o}var u={resolve:function(){for(var t="",i=!1,r,o=arguments.length-1;o>=-1&&!i;o--){var h;o>=0?h=arguments[o]:(r===void 0&&(r=T.cwd()),h=r),m(h),h.length!==0&&(t=h+"/"+t,i=h.charCodeAt(0)===47)}return t=e(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(m(t),t.length===0)return".";var i=t.charCodeAt(0)===47,r=t.charCodeAt(t.length-1)===47;return t=e(t,!i),t.length===0&&!i&&(t="."),t.length>0&&r&&(t+="/"),i?"/"+t:t},isAbsolute:function(t){return m(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,i=0;i<arguments.length;++i){var r=arguments[i];m(r),r.length>0&&(t===void 0?t=r:t+="/"+r)}return t===void 0?".":u.normalize(t)},relative:function(t,i){if(m(t),m(i),t===i||(t=u.resolve(t),i=u.resolve(i),t===i))return"";for(var r=1;r<t.length&&t.charCodeAt(r)===47;++r);for(var o=t.length,h=o-r,n=1;n<i.length&&i.charCodeAt(n)===47;++n);for(var l=i.length,a=l-n,f=h<a?h:a,d=-1,c=0;c<=f;++c){if(c===f){if(a>f){if(i.charCodeAt(n+c)===47)return i.slice(n+c+1);if(c===0)return i.slice(n+c)}else h>f&&(t.charCodeAt(r+c)===47?d=c:c===0&&(d=0));break}var y=t.charCodeAt(r+c),C=i.charCodeAt(n+c);if(y!==C)break;y===47&&(d=c)}var g="";for(c=r+d+1;c<=o;++c)(c===o||t.charCodeAt(c)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+i.slice(n+d):(n+=d,i.charCodeAt(n)===47&&++n,i.slice(n))},_makeLong:function(t){return t},dirname:function(t){if(m(t),t.length===0)return".";for(var i=t.charCodeAt(0),r=i===47,o=-1,h=!0,n=t.length-1;n>=1;--n)if(i=t.charCodeAt(n),i===47){if(!h){o=n;break}}else h=!1;return o===-1?r?"/":".":r&&o===1?"//":t.slice(0,o)},basename:function(t,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');m(t);var r=0,o=-1,h=!0,n;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var l=i.length-1,a=-1;for(n=t.length-1;n>=0;--n){var f=t.charCodeAt(n);if(f===47){if(!h){r=n+1;break}}else a===-1&&(h=!1,a=n+1),l>=0&&(f===i.charCodeAt(l)?--l===-1&&(o=n):(l=-1,o=a))}return r===o?o=a:o===-1&&(o=t.length),t.slice(r,o)}else{for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!h){r=n+1;break}}else o===-1&&(h=!1,o=n+1);return o===-1?"":t.slice(r,o)}},extname:function(t){m(t);for(var i=-1,r=0,o=-1,h=!0,n=0,l=t.length-1;l>=0;--l){var a=t.charCodeAt(l);if(a===47){if(!h){r=l+1;break}continue}o===-1&&(h=!1,o=l+1),a===46?i===-1?i=l:n!==1&&(n=1):i!==-1&&(n=-1)}return i===-1||o===-1||n===0||n===1&&i===o-1&&i===r+1?"":t.slice(i,o)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return s("/",t)},parse:function(t){m(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var r=t.charCodeAt(0),o=r===47,h;o?(i.root="/",h=1):h=0;for(var n=-1,l=0,a=-1,f=!0,d=t.length-1,c=0;d>=h;--d){if(r=t.charCodeAt(d),r===47){if(!f){l=d+1;break}continue}a===-1&&(f=!1,a=d+1),r===46?n===-1?n=d:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===l+1?a!==-1&&(l===0&&o?i.base=i.name=t.slice(1,a):i.base=i.name=t.slice(l,a)):(l===0&&o?(i.name=t.slice(1,n),i.base=t.slice(1,a)):(i.name=t.slice(l,n),i.base=t.slice(l,a)),i.ext=t.slice(n,a)),l>0?i.dir=t.slice(0,l-1):o&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};return u.posix=u,p=u,p}var k=I();class v extends Error{name="TimeoutError";constructor(e,s){super(e,s),Error.captureStackTrace?.(this,v)}}const w=m=>m.reason??new DOMException("This operation was aborted.","AbortError");function A(m,e){const{milliseconds:s,fallback:u,message:t,customTimers:i={setTimeout,clearTimeout},signal:r}=e;let o,h;const n=new Promise((l,a)=>{if(typeof s!="number"||Math.sign(s)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${s}\``);if(r?.aborted){a(w(r));return}if(r&&(h=()=>{a(w(r))},r.addEventListener("abort",h,{once:!0})),m.then(l,a),s===Number.POSITIVE_INFINITY)return;const f=new v;o=i.setTimeout.call(void 0,()=>{if(u){try{l(u())}catch(d){a(d)}return}typeof m.cancel=="function"&&m.cancel(),t===!1?l():t instanceof Error?a(t):(f.message=t??`Promise timed out after ${s} milliseconds`,a(f))},s)}).finally(()=>{n.clear(),h&&r&&r.removeEventListener("abort",h)});return n.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},n}function x(m,e,s){let u=0,t=m.length;for(;t>0;){const i=Math.trunc(t/2);let r=u+i;s(m[r],e)<=0?(u=++r,t-=i+1):t=i}return u}class P{#e=[];enqueue(e,s){const{priority:u=0,id:t}=s??{},i={priority:u,id:t,run:e};if(this.size===0||this.#e[this.size-1].priority>=u){this.#e.push(i);return}const r=x(this.#e,i,(o,h)=>h.priority-o.priority);this.#e.splice(r,0,i)}setPriority(e,s){const u=this.#e.findIndex(i=>i.id===e);if(u===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[t]=this.#e.splice(u,1);this.enqueue(t.run,{priority:s,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(s=>s.priority===e.priority).map(s=>s.run)}get size(){return this.#e.length}}class L extends E{#e;#o;#h=0;#f;#g=!1;#y=!1;#a;#x=0;#b=0;#u;#l;#n;#s=[];#r=0;#t;#P;#i=0;#p;#c;#$=1n;#v=new Map;timeout;constructor(e){if(super(),e={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:P,strict:!1,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);if(e.strict&&e.interval===0)throw new TypeError("The `strict` option requires a non-zero `interval`");if(e.strict&&e.intervalCap===Number.POSITIVE_INFINITY)throw new TypeError("The `strict` option requires a finite `intervalCap`");if(this.#e=e.carryoverIntervalCount??e.carryoverConcurrencyCount??!1,this.#o=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#f=e.intervalCap,this.#a=e.interval,this.#n=e.strict,this.#t=new e.queueClass,this.#P=e.queueClass,this.concurrency=e.concurrency,e.timeout!==void 0&&!(Number.isFinite(e.timeout)&&e.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${e.timeout}\` (${typeof e.timeout})`);this.timeout=e.timeout,this.#c=e.autoStart===!1,this.#V()}#w(e){for(;this.#r<this.#s.length;){const s=this.#s[this.#r];if(s!==void 0&&e-s>=this.#a)this.#r++;else break}(this.#r>100&&this.#r>this.#s.length/2||this.#r===this.#s.length)&&(this.#s=this.#s.slice(this.#r),this.#r=0)}#S(e){this.#n?this.#s.push(e):this.#h++}#q(){this.#n?this.#s.length>this.#r&&this.#s.pop():this.#h>0&&this.#h--}#C(){return this.#s.length-this.#r}get#O(){return this.#o?!0:this.#n?this.#C()<this.#f:this.#h<this.#f}get#R(){return this.#i<this.#p}#F(){this.#i--,this.#i===0&&this.emit("pendingZero"),this.#I(),this.emit("next")}#D(){this.#l=void 0,this.#k(),this.#N()}#M(e){if(this.#n){if(this.#w(e),this.#C()>=this.#f){const s=this.#s[this.#r],u=this.#a-(e-s);return this.#T(u),!0}return!1}if(this.#u===void 0){const s=this.#x-e;if(s<0){if(this.#b>0){const u=e-this.#b;if(u<this.#a)return this.#T(this.#a-u),!0}this.#h=this.#e?this.#i:0}else return this.#T(s),!0}return!1}#T(e){this.#l===void 0&&(this.#l=setTimeout(()=>{this.#D()},e))}#E(){this.#u&&(clearInterval(this.#u),this.#u=void 0)}#z(){this.#l&&(clearTimeout(this.#l),this.#l=void 0)}#I(){if(this.#t.size===0){if(this.#E(),this.emit("empty"),this.#i===0){if(this.#z(),this.#n&&this.#r>0){const s=Date.now();this.#w(s)}this.emit("idle")}return!1}let e=!1;if(!this.#c){const s=Date.now(),u=!this.#M(s);if(this.#O&&this.#R){const t=this.#t.dequeue();this.#o||(this.#S(s),this.#d()),this.emit("active"),t(),u&&this.#N(),e=!0}}return e}#N(){this.#o||this.#u!==void 0||this.#n||(this.#u=setInterval(()=>{this.#k()},this.#a),this.#x=Date.now()+this.#a)}#k(){this.#n||(this.#h===0&&this.#i===0&&this.#u&&this.#E(),this.#h=this.#e?this.#i:0),this.#A(),this.#d()}#A(){for(;this.#I(););}get concurrency(){return this.#p}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#p=e,this.#A()}setPriority(e,s){if(typeof s!="number"||!Number.isFinite(s))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${s}\` (${typeof s})`);this.#t.setPriority(e,s)}async add(e,s={}){return s={timeout:this.timeout,...s,id:s.id??(this.#$++).toString()},new Promise((u,t)=>{const i=Symbol(`task-${s.id}`);this.#t.enqueue(async()=>{this.#i++,this.#v.set(i,{id:s.id,priority:s.priority??0,startTime:Date.now(),timeout:s.timeout});let r;try{try{s.signal?.throwIfAborted()}catch(n){throw this.#_(),this.#v.delete(i),n}this.#b=Date.now();let o=e({signal:s.signal});if(s.timeout&&(o=A(Promise.resolve(o),{milliseconds:s.timeout,message:`Task timed out after ${s.timeout}ms (queue has ${this.#i} running, ${this.#t.size} waiting)`})),s.signal){const{signal:n}=s;o=Promise.race([o,new Promise((l,a)=>{r=()=>{a(n.reason)},n.addEventListener("abort",r,{once:!0})})])}const h=await o;u(h),this.emit("completed",h)}catch(o){t(o),this.emit("error",o)}finally{r&&s.signal?.removeEventListener("abort",r),this.#v.delete(i),queueMicrotask(()=>{this.#F()})}},s),this.emit("add"),this.#I()})}async addAll(e,s){return Promise.all(e.map(async u=>this.add(u,s)))}start(){return this.#c?(this.#c=!1,this.#A(),this):this}pause(){this.#c=!0}clear(){this.#t=new this.#P,this.#E(),this.#L(),this.emit("empty"),this.#i===0&&(this.#z(),this.emit("idle")),this.emit("next")}async onEmpty(){this.#t.size!==0&&await this.#m("empty")}async onSizeLessThan(e){this.#t.size<e||await this.#m("next",()=>this.#t.size<e)}async onIdle(){this.#i===0&&this.#t.size===0||await this.#m("idle")}async onPendingZero(){this.#i!==0&&await this.#m("pendingZero")}async onRateLimit(){this.isRateLimited||await this.#m("rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await this.#m("rateLimitCleared")}onError(){return new Promise((e,s)=>{const u=t=>{this.off("error",u),s(t)};this.on("error",u)})}async#m(e,s){return new Promise(u=>{const t=()=>{s&&!s()||(this.off(e,t),u())};this.on(e,t)})}get size(){return this.#t.size}sizeBy(e){return this.#t.filter(e).length}get pending(){return this.#i}get isPaused(){return this.#c}#V(){this.#o||(this.on("add",()=>{this.#t.size>0&&this.#d()}),this.on("next",()=>{this.#d()}))}#d(){this.#o||this.#y||(this.#y=!0,queueMicrotask(()=>{this.#y=!1,this.#L()}))}#_(){this.#o||(this.#q(),this.#d())}#L(){const e=this.#g;if(this.#o||this.#t.size===0){e&&(this.#g=!1,this.emit("rateLimitCleared"));return}let s;if(this.#n){const t=Date.now();this.#w(t),s=this.#C()}else s=this.#h;const u=s>=this.#f;u!==e&&(this.#g=u,this.emit(u?"rateLimit":"rateLimitCleared"))}get isRateLimited(){return this.#g}get isSaturated(){return this.#i===this.#p&&this.#t.size>0||this.isRateLimited&&this.#t.size>0}get runningTasks(){return[...this.#v.values()].map(e=>({...e}))}}export{L as P,k as p};
//# sourceMappingURL=index-Bhwf_DDY.chunk.mjs.map

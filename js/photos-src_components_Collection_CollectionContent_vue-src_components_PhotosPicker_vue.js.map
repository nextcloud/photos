{"version":3,"file":"photos-src_components_Collection_CollectionContent_vue-src_components_PhotosPicker_vue.js?v=492b41294c46ac3beadc","mappings":"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","sources":["webpack://photos/./src/components/Collection/CollectionContent.vue?de63","webpack:///photos/src/components/Collection/CollectionContent.vue","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=script&lang=js","webpack://photos/./src/components/Collection/CollectionContent.vue?0fd9","webpack://photos/./src/components/Collection/CollectionContent.vue?d20d","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=style&index=0&id=7b4ec2eb&prod&lang=scss&scoped=true","webpack://photos/./src/components/PhotosPicker.vue?4733","webpack:///photos/src/components/PhotosPicker.vue","webpack:///photos/src/components/PhotosPicker.vue?vue&type=script&lang=js","webpack://photos/./src/components/PhotosPicker.vue?1685","webpack://photos/./src/components/PhotosPicker.vue?67e2","webpack:///photos/src/mixins/FilesByMonthMixin.js","webpack:///photos/src/components/PhotosPicker.vue?vue&type=style&index=0&id=ada68ef2&prod&lang=scss&scoped=true","webpack:///photos/src/mixins/FetchFilesMixin.js","webpack:///photos/src/services/PhotoSearch.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return ((_vm.collection === undefined && !_vm.loading) || _vm.error === 404)?_c('NcEmptyContent',{staticClass:\"empty-content-with-illustration\",attrs:{\"name\":_vm.t('photos', 'This collection does not exist')}},[_c('FolderMultipleImage',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):(_vm.error)?_c('NcEmptyContent',{attrs:{\"name\":_vm.t('photos', 'An error occurred')}},[_c('AlertCircle',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):_c('div',{staticClass:\"collection\"},[_vm._t(\"header\",null,{\"selectedFileIds\":_vm.selectedFileIds,\"resetSelection\":_vm.resetSelection}),_vm._v(\" \"),(_vm.sortedCollectionFileIds.length === 0 && !_vm.loading)?_vm._t(\"empty-content\"):_vm._e(),_vm._v(\" \"),(_vm.collection !== undefined && _vm.sortedCollectionFileIds.length > 0 )?_c('FilesListViewer',{staticClass:\"collection__media\",attrs:{\"container-element\":_vm.appContent,\"file-ids\":_vm.sortedCollectionFileIds,\"base-height\":_vm.isMobile ? 120 : 200,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"default\",fn:function({file, distance}){return _c('File',{attrs:{\"file\":_vm.files[file.id],\"allow-selection\":_vm.allowSelection,\"selected\":_vm.selection[file.id] === true,\"distance\":distance},on:{\"click\":_vm.openViewer,\"select-toggled\":_vm.onFileSelectToggle}})}}],null,false,3813029717)}):_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n - @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n -\n - @author Louis Chemineau <louis@chmn.me>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n -->\n<template>\n\t<!-- Errors handlers-->\n\t<NcEmptyContent v-if=\"(collection === undefined && !loading) || error === 404\"\n\t\tclass=\"empty-content-with-illustration\"\n\t\t:name=\"t('photos', 'This collection does not exist')\">\n\t\t<FolderMultipleImage slot=\"icon\" />\n\t</NcEmptyContent>\n\t<NcEmptyContent v-else-if=\"error\" :name=\"t('photos', 'An error occurred')\">\n\t\t<AlertCircle slot=\"icon\" />\n\t</NcEmptyContent>\n\n\t<div v-else class=\"collection\">\n\t\t<!-- Header -->\n\t\t<slot class=\"collection__header\"\n\t\t\tname=\"header\"\n\t\t\t:selected-file-ids=\"selectedFileIds\"\n\t\t\t:reset-selection=\"resetSelection\" />\n\n\t\t<!-- No content -->\n\t\t<slot v-if=\"sortedCollectionFileIds.length === 0 && !loading\" name=\"empty-content\" />\n\n\t\t<!-- Media list -->\n\t\t<FilesListViewer v-if=\"collection !== undefined && sortedCollectionFileIds.length > 0 \"\n\t\t\t:container-element=\"appContent\"\n\t\t\tclass=\"collection__media\"\n\t\t\t:file-ids=\"sortedCollectionFileIds\"\n\t\t\t:base-height=\"isMobile ? 120 : 200\"\n\t\t\t:loading=\"loading\">\n\t\t\t<File slot-scope=\"{file, distance}\"\n\t\t\t\t:file=\"files[file.id]\"\n\t\t\t\t:allow-selection=\"allowSelection\"\n\t\t\t\t:selected=\"selection[file.id] === true\"\n\t\t\t\t:distance=\"distance\"\n\t\t\t\t@click=\"openViewer\"\n\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\n\t\t</FilesListViewer>\n\t</div>\n</template>\n\n<script>\nimport AlertCircle from 'vue-material-design-icons/AlertCircle.vue'\nimport FolderMultipleImage from 'vue-material-design-icons/FolderMultipleImage.vue'\n\nimport { subscribe, unsubscribe } from '@nextcloud/event-bus'\nimport { NcEmptyContent, isMobile } from '@nextcloud/vue'\nimport { translate } from '@nextcloud/l10n'\n\nimport FilesSelectionMixin from '../../mixins/FilesSelectionMixin.js'\nimport FilesListViewer from '.././FilesListViewer.vue'\nimport File from '.././File.vue'\nimport { toViewerFileInfo } from '../../utils/fileUtils.js'\n\nexport default {\n\tname: 'CollectionContent',\n\n\tcomponents: {\n\t\tAlertCircle,\n\t\tFolderMultipleImage,\n\t\tNcEmptyContent,\n\t\tFilesListViewer,\n\t\tFile,\n\t},\n\n\tmixins: [\n\t\tFilesSelectionMixin,\n\t\tisMobile,\n\t],\n\n\tprops: {\n\t\t/** @type {import('vue').PropType<import('../../services/collectionFetcher').Collection>} */\n\t\tcollection: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => undefined,\n\t\t},\n\n\t\t/** @type {import('vue').PropType<string[]>} */\n\t\tcollectionFileIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\n\t\tallowSelection: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\n\t\terror: {\n\t\t\ttype: [Error, Number],\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tappContent: document.getElementById('app-content-vue'),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/** @return {import('../../services/collectionFetcher').IndexedCollectionFiles} */\n\t\tfiles() {\n\t\t\treturn this.$store.getters.files\n\t\t},\n\n\t\tsortedCollectionFileIds() {\n\t\t\treturn this.collectionFileIds.toSorted((fileId1, fileId2) => this.files[fileId1].timestamp < this.files[fileId2].timestamp ? -1 : 1)\n\t\t},\n\t},\n\n\tmounted() {\n\t\tsubscribe('files:node:deleted', this.handleFileDeleted)\n\t},\n\n\tdestroyed() {\n\t\tunsubscribe('files:node:deleted', this.handleFileDeleted)\n\t},\n\n\tmethods: {\n\t\topenViewer(fileId) {\n\t\t\tconst file = this.files[fileId]\n\t\t\tOCA.Viewer.open({\n\t\t\t\tfileInfo: toViewerFileInfo(file),\n\t\t\t\tlist: this.sortedCollectionFileIds.map(fileId => toViewerFileInfo(this.files[fileId])).filter(file => !file.sectionHeader),\n\t\t\t\tloadMore: file.loadMore ? async () => await file.loadMore(true) : () => [],\n\t\t\t\tcanLoop: file.canLoop,\n\t\t\t})\n\t\t},\n\n\t\thandleFileDeleted({ fileid }) {\n\t\t\tthis.$store.commit('removeFilesFromCollection', { collectionFileName: this.collection.filename, fileIdsToRemove: [fileid?.toString()] })\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n<style lang=\"scss\" scoped>\n.collection {\n\tdisplay: flex;\n\tflex-direction: column;\n\n\t&__media {\n\t\tpadding: 0 64px;\n\n\t\t@media only screen and (max-width: 1200px) {\n\t\t\tpadding: 0 4px;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=7b4ec2eb&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=7b4ec2eb&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./CollectionContent.vue?vue&type=template&id=7b4ec2eb&scoped=true\"\nimport script from \"./CollectionContent.vue?vue&type=script&lang=js\"\nexport * from \"./CollectionContent.vue?vue&type=script&lang=js\"\nimport style0 from \"./CollectionContent.vue?vue&type=style&index=0&id=7b4ec2eb&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7b4ec2eb\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.collection[data-v-7b4ec2eb]{display:flex;flex-direction:column}.collection__media[data-v-7b4ec2eb]{padding:0 64px}@media only screen and (max-width: 1200px){.collection__media[data-v-7b4ec2eb]{padding:0 4px}}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Collection/CollectionContent.vue\"],\"names\":[],\"mappings\":\"AAEA,6BACC,YAAA,CACA,qBAAA,CAEA,oCACC,cAAA,CAEA,2CAHD,oCAIE,aAAA,CAAA\",\"sourcesContent\":[\"$sizes: (\\\"400\\\": (\\\"count\\\": 3, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"700\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"1024\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1280\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1440\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"1600\\\": (\\\"count\\\": 6, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2048\\\": (\\\"count\\\": 7, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2560\\\": (\\\"count\\\": 8, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"3440\\\": (\\\"count\\\": 9, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"max\\\": (\\\"count\\\": 10, \\\"marginTop\\\": 88, \\\"marginW\\\": 88));\\n\\n.collection {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\n\\t&__media {\\n\\t\\tpadding: 0 64px;\\n\\n\\t\\t@media only screen and (max-width: 1200px) {\\n\\t\\t\\tpadding: 0 4px;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('NcDialog',{attrs:{\"content-classes\":\"photos-picker\",\"name\":_vm.name,\"open\":_vm.open,\"out-transition\":\"\",\"size\":\"large\"},on:{\"update:open\":(open) => _vm.$emit('update:open', open)},scopedSlots:_vm._u([{key:\"navigation\",fn:function({ isCollapsed }){return [(isCollapsed)?_c('NcSelect',{staticClass:\"photos-picker__navigation__month-select\",attrs:{\"aria-label-listbox\":_vm.t('photos', 'Dates'),\"clearable\":false,\"input-label\":_vm.t('photos', 'Jump to specific date in list'),\"options\":_vm.monthsList},scopedSlots:_vm._u([{key:\"selected-option\",fn:function({ label }){return [_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(label))+\"\\n\\t\\t\\t\")]}},{key:\"option\",fn:function({ label }){return [_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(label))+\"\\n\\t\\t\\t\")]}}],null,true),model:{value:(_vm.targetMonth),callback:function ($$v) {_vm.targetMonth=$$v},expression:\"targetMonth\"}}):_c('ul',{attrs:{\"aria-label\":_vm.t('photos', 'Dates')}},_vm._l((_vm.monthsList),function(month){return _c('li',{key:month,staticClass:\"photos-picker__navigation__month\"},[_c('NcButton',{attrs:{\"type\":_vm.targetMonth === month ? 'secondary' : 'tertiary',\"aria-label\":_vm.t('photos', 'Jump to {date}', { date: _vm.dateMonthAndYear(month) })},on:{\"click\":function($event){_vm.targetMonth = month}}},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(month))+\"\\n\\t\\t\\t\\t\")])],1)}),0)]}},{key:\"actions\",fn:function(){return [_c('div',{staticClass:\"photos-picker__actions\"},[_c('div',{staticClass:\"photos-picker__actions__buttons\"},[_c('UploadPicker',{attrs:{\"accept\":_vm.allowedMimes,\"context\":_vm.uploadContext,\"destination\":_vm.photosLocationFolder,\"multiple\":true},on:{\"uploaded\":_vm.refreshFiles}}),_vm._v(\" \"),_c('NcButton',{attrs:{\"type\":\"primary\",\"disabled\":_vm.loading || _vm.selectedFileIds.length === 0},on:{\"click\":_vm.emitPickedEvent},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(!_vm.loading)?_c('ImagePlus'):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('NcLoadingIcon'):_vm._e()]},proxy:true}])},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('photos', 'Add to {destination}', { destination: _vm.destination }, undefined, {escape: false, sanitize: false,}))+\"\\n\\t\\t\\t\\t\")])],1),_vm._v(\" \"),(_vm.photosLocationFolder.attributes['owner-id'] !== _vm.currentUser)?_c('NcNoteCard',{attrs:{\"type\":\"warning\"}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('photos', 'The destination folder is owned by {owner}', { owner: _vm.photosLocationFolder.attributes['owner-id'] }))+\"\\n\\t\\t\\t\")]):_vm._e()],1)]},proxy:true}])},[_vm._v(\" \"),_vm._v(\" \"),_c('FilesListViewer',{staticClass:\"photos-picker__file-list\",class:{'photos-picker__file-list--placeholder': _vm.monthsList.length === 0},attrs:{\"file-ids-by-section\":_vm.fileIdsByMonth,\"empty-message\":_vm.t('photos', 'There are no photos or videos yet!'),\"sections\":_vm.monthsList,\"loading\":_vm.loadingFiles,\"base-height\":100,\"section-header-height\":50,\"scroll-to-section\":_vm.targetMonth},on:{\"need-content\":_vm.getFiles},nativeOn:{\"focusout\":function($event){return _vm.onFocusOut.apply(null, arguments)}},scopedSlots:_vm._u([{key:\"default\",fn:function({file, height, isHeader, distance}){return [(isHeader)?_c('h3',{staticClass:\"section-header\",style:({ height: `${height}px`}),attrs:{\"id\":`photos-picker-section-header-${file.id}`}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(file.id))+\"\\n\\t\\t\\t\")]):_c('File',{attrs:{\"file\":_vm.files[file.id],\"allow-selection\":true,\"selected\":_vm.selection[file.id] === true,\"distance\":distance},on:{\"select-toggled\":_vm.onFileSelectToggle}})]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n - @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n -\n - @author Louis Chemineau <louis@chmn.me>\n - @author Ferdinand Thiessen <opensource@fthiessen.de>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n -->\n<template>\n\t<NcDialog content-classes=\"photos-picker\"\n\t\t:name=\"name\"\n\t\t:open=\"open\"\n\t\tout-transition\n\t\tsize=\"large\"\n\t\t@update:open=\"(open) => $emit('update:open', open)\">\n\t\t<!-- Navigation containing the months available -->\n\t\t<template #navigation=\"{ isCollapsed }\">\n\t\t\t<!-- Mobile view -->\n\t\t\t<NcSelect v-if=\"isCollapsed\"\n\t\t\t\tv-model=\"targetMonth\"\n\t\t\t\t:aria-label-listbox=\"t('photos', 'Dates')\"\n\t\t\t\tclass=\"photos-picker__navigation__month-select\"\n\t\t\t\t:clearable=\"false\"\n\t\t\t\t:input-label=\"t('photos', 'Jump to specific date in list')\"\n\t\t\t\t:options=\"monthsList\">\n\t\t\t\t<template #selected-option=\"{ label }\">\n\t\t\t\t\t{{ dateMonthAndYear(label) }}\n\t\t\t\t</template>\n\t\t\t\t<template #option=\"{ label }\">\n\t\t\t\t\t{{ dateMonthAndYear(label) }}\n\t\t\t\t</template>\n\t\t\t</NcSelect>\n\n\t\t\t<!-- Default view -->\n\t\t\t<ul v-else :aria-label=\"t('photos', 'Dates')\">\n\t\t\t\t<li v-for=\"month in monthsList\"\n\t\t\t\t\t:key=\"month\"\n\t\t\t\t\tclass=\"photos-picker__navigation__month\">\n\t\t\t\t\t<NcButton :type=\"targetMonth === month ? 'secondary' : 'tertiary'\"\n\t\t\t\t\t\t:aria-label=\"t('photos', 'Jump to {date}', { date: dateMonthAndYear(month) })\"\n\t\t\t\t\t\t@click=\"targetMonth = month\">\n\t\t\t\t\t\t{{ dateMonthAndYear(month) }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</template>\n\n\t\t<!-- The actions on the bottom -->\n\t\t<template #actions>\n\t\t\t<div class=\"photos-picker__actions\">\n\t\t\t\t<div class=\"photos-picker__actions__buttons\">\n\t\t\t\t\t<UploadPicker :accept=\"allowedMimes\"\n\t\t\t\t\t\t:context=\"uploadContext\"\n\t\t\t\t\t\t:destination=\"photosLocationFolder\"\n\t\t\t\t\t\t:multiple=\"true\"\n\t\t\t\t\t\t@uploaded=\"refreshFiles\" />\n\t\t\t\t\t<NcButton type=\"primary\" :disabled=\"loading || selectedFileIds.length === 0\" @click=\"emitPickedEvent\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<ImagePlus v-if=\"!loading\" />\n\t\t\t\t\t\t\t<NcLoadingIcon v-if=\"loading\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('photos', 'Add to {destination}', { destination }, undefined, {escape: false, sanitize: false,}) }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t\t<NcNoteCard v-if=\"photosLocationFolder.attributes['owner-id'] !== currentUser\" type=\"warning\">\n\t\t\t\t\t{{ t('photos', 'The destination folder is owned by {owner}', { owner: photosLocationFolder.attributes['owner-id'] }) }}\n\t\t\t\t</NcNoteCard>\n\t\t\t</div>\n\t\t</template>\n\n\t\t<FilesListViewer class=\"photos-picker__file-list\"\n\t\t\t:class=\"{'photos-picker__file-list--placeholder': monthsList.length === 0}\"\n\t\t\t:file-ids-by-section=\"fileIdsByMonth\"\n\t\t\t:empty-message=\"t('photos', 'There are no photos or videos yet!')\"\n\t\t\t:sections=\"monthsList\"\n\t\t\t:loading=\"loadingFiles\"\n\t\t\t:base-height=\"100\"\n\t\t\t:section-header-height=\"50\"\n\t\t\t:scroll-to-section=\"targetMonth\"\n\t\t\t@need-content=\"getFiles\"\n\t\t\t@focusout.native=\"onFocusOut\">\n\t\t\t<template slot-scope=\"{file, height, isHeader, distance}\">\n\t\t\t\t<h3 v-if=\"isHeader\"\n\t\t\t\t\t:id=\"`photos-picker-section-header-${file.id}`\"\n\t\t\t\t\t:style=\"{ height: `${height}px`}\"\n\t\t\t\t\tclass=\"section-header\">\n\t\t\t\t\t{{ dateMonthAndYear(file.id) }}\n\t\t\t\t</h3>\n\n\t\t\t\t<File v-else\n\t\t\t\t\t:file=\"files[file.id]\"\n\t\t\t\t\t:allow-selection=\"true\"\n\t\t\t\t\t:selected=\"selection[file.id] === true\"\n\t\t\t\t\t:distance=\"distance\"\n\t\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\n\t\t\t</template>\n\t\t</FilesListViewer>\n\t</NcDialog>\n</template>\n\n<script>\nimport { UploadPicker } from '@nextcloud/upload'\nimport { NcButton, NcDialog, NcLoadingIcon, NcSelect, NcNoteCard, useIsMobile } from '@nextcloud/vue'\nimport { defineComponent } from 'vue'\nimport { mapGetters } from 'vuex'\n\nimport moment from '@nextcloud/moment'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nimport ImagePlus from 'vue-material-design-icons/ImagePlus.vue'\n\nimport FilesListViewer from './FilesListViewer.vue'\nimport File from './File.vue'\n\nimport FetchFilesMixin from '../mixins/FetchFilesMixin.js'\nimport FilesSelectionMixin from '../mixins/FilesSelectionMixin.js'\nimport FilesByMonthMixin from '../mixins/FilesByMonthMixin.js'\nimport allowedMimes from '../services/AllowedMimes.js'\n\nexport default defineComponent({\n\tname: 'PhotosPicker',\n\n\tcomponents: {\n\t\tFile,\n\t\tFilesListViewer,\n\t\tImagePlus,\n\t\tNcButton,\n\t\tNcDialog,\n\t\tNcLoadingIcon,\n\t\tNcSelect,\n\t\tNcNoteCard,\n\t\tUploadPicker,\n\t},\n\n\tmixins: [\n\t\tFetchFilesMixin,\n\t\tFilesByMonthMixin,\n\t\tFilesSelectionMixin,\n\t],\n\n\tprops: {\n\t\t/**\n\t\t * If the photos picker should be opened\n\t\t */\n\t\topen: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\n\t\t/**\n\t\t * Name to be used as heading\n\t\t */\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\t// Label to show in the submit button.\n\t\tdestination: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\t// List of file ids to not show.\n\t\tblacklistIds: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\n\t\t// Whether we should disable the submit button and show a spinner.\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: ['files-picked', 'update:open'],\n\n\tsetup() {\n\t\treturn {\n\t\t\tisMobile: useIsMobile(),\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tallowedMimes,\n\t\t\ttargetMonth: null,\n\t\t\tuploadContext: {\n\t\t\t\troute: 'albumpicker',\n\t\t\t},\n\t\t\tcurrentUser: getCurrentUser().uid,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'files',\n\t\t]),\n\n\t\tphotosLocationFolder() {\n\t\t\treturn this.$store.state.userConfig.photosLocationFolder\n\t\t},\n\t},\n\n\twatch: {\n\t\tmonthsList(value) {\n\t\t\tif (this.targetMonth === null) {\n\t\t\t\tthis.targetMonth = value[0]\n\t\t\t}\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {FocusEvent} event The focus event\n\t\t */\n\t\tonFocusOut(event) {\n\t\t\tif (event.relatedTarget === null) { // Focus escaping to body\n\t\t\t\tevent.target.focus({ preventScroll: true })\n\t\t\t}\n\t\t},\n\n\t\tgetFiles() {\n\t\t\tthis.fetchFiles({}, this.blacklistIds)\n\t\t},\n\n\t\trefreshFiles() {\n\t\t\tthis.fetchFiles({ firstResult: 0 }, [...this.blacklistIds, ...this.fetchedFileIds], true)\n\t\t},\n\n\t\temitPickedEvent() {\n\t\t\tthis.$emit('files-picked', this.selectedFileIds)\n\t\t\tthis.resetSelection()\n\t\t},\n\t\t/**\n\t\t * @param {string} date - In the following format: YYYYMM\n\t\t */\n\t\tdateMonthAndYear(date) {\n\t\t\tif (this.isMobile) {\n\t\t\t\treturn moment(date, 'YYYYMM').format('MMM YYYY')\n\t\t\t}\n\t\t\treturn moment(date, 'YYYYMM').format('MMMM YYYY')\n\t\t},\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n:deep(.photos-picker) {\n\t// remove padding to move scrollbar to the very end\n\tpadding-inline-end: 0 !important;\n}\n\n.photos-picker {\n\n\t&__navigation {\n\t\t&__month {\n\t\t\t// For focus-visible outline\n\t\t\tmargin: 4px;\n\t\t}\n\n\t\t&__month-select {\n\t\t\tflex: 1;\n\t\t\t// align with other content\n\t\t\tpadding-inline-end: 12px;\n\t\t\tpadding-block-end: 6px;\n\t\t}\n\t}\n\n\t&__file-list {\n\t\tflex-grow: 1;\n\t\tmin-width: 0;\n\t\theight: 100%;\n\t\tpadding: 0 4px;\n\n\t\t&--placeholder {\n\t\t\tbackground: var(--color-primary-element-light);\n\t\t\tborder-radius: var(--border-radius-large);\n\t\t}\n\n\t\t.section-header {\n\t\t\tfont-weight: bold;\n\t\t\tfont-size: 20px;\n\t\t\tpadding: 8px 0 4px 0;\n\t\t}\n\n\t\t:deep .empty-content {\n\t\t\tposition: absolute;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 0;\n\t\t\theight: 100%;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t&__actions {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tflex-grow: 1;\n\n\t\t&__buttons {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: end;\n\t\t\tgap: 16px;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=style&index=0&id=ada68ef2&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=style&index=0&id=ada68ef2&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./PhotosPicker.vue?vue&type=template&id=ada68ef2&scoped=true\"\nimport script from \"./PhotosPicker.vue?vue&type=script&lang=js\"\nexport * from \"./PhotosPicker.vue?vue&type=script&lang=js\"\nimport style0 from \"./PhotosPicker.vue?vue&type=style&index=0&id=ada68ef2&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ada68ef2\",\n  null\n  \n)\n\nexport default component.exports","/**\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n *\n * @author Louis Chemineau <louis@chmn.me>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default {\n\tname: 'FilesByMonthMixin',\n\n\tcomputed: {\n\t\t/**\n\t\t * @return {Object<string, []>}\n\t\t */\n\t\tfileIdsByMonth() {\n\t\t\tconst filesByMonth = {}\n\t\t\tfor (const fileId of this.fetchedFileIds) {\n\t\t\t\tconst file = this.files[fileId]\n\t\t\t\tif (file) {\n\t\t\t\t\tfilesByMonth[file.month] = filesByMonth[file.month] ?? []\n\t\t\t\t\tfilesByMonth[file.month].push(file.fileid)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Sort files in sections.\n\t\t\tObject.keys(filesByMonth)\n\t\t\t\t.forEach(month => filesByMonth[month].sort(this.sortFilesByTimestamp))\n\n\t\t\treturn filesByMonth\n\t\t},\n\n\t\t/**\n\t\t * @return {string[]}\n\t\t */\n\t\tmonthsList() {\n\t\t\treturn Object\n\t\t\t\t.keys(this.fileIdsByMonth)\n\t\t\t\t.sort((month1, month2) => month1 > month2 ? -1 : 1)\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {string} fileId1 The first file ID\n\t\t * @param {string} fileId2 The second file ID\n\t\t * @return {-1 | 1}\n\t\t */\n\t\tsortFilesByTimestamp(fileId1, fileId2) {\n\t\t\treturn this.files[fileId1].timestamp > this.files[fileId2].timestamp ? -1 : 1\n\t\t},\n\t},\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `[data-v-ada68ef2] .photos-picker{padding-inline-end:0 !important}.photos-picker__navigation__month[data-v-ada68ef2]{margin:4px}.photos-picker__navigation__month-select[data-v-ada68ef2]{flex:1;padding-inline-end:12px;padding-block-end:6px}.photos-picker__file-list[data-v-ada68ef2]{flex-grow:1;min-width:0;height:100%;padding:0 4px}.photos-picker__file-list--placeholder[data-v-ada68ef2]{background:var(--color-primary-element-light);border-radius:var(--border-radius-large)}.photos-picker__file-list .section-header[data-v-ada68ef2]{font-weight:bold;font-size:20px;padding:8px 0 4px 0}.photos-picker__file-list[data-v-ada68ef2] .empty-content{position:absolute;width:100%;margin-top:0;height:100%;display:flex;flex-direction:column;justify-content:center}.photos-picker__actions[data-v-ada68ef2]{display:flex;flex-direction:column;flex-grow:1}.photos-picker__actions__buttons[data-v-ada68ef2]{display:flex;align-items:center;justify-content:end;gap:16px}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/PhotosPicker.vue\"],\"names\":[],\"mappings\":\"AAEA,iCAEC,+BAAA,CAMC,mDAEC,UAAA,CAGD,0DACC,MAAA,CAEA,uBAAA,CACA,qBAAA,CAIF,2CACC,WAAA,CACA,WAAA,CACA,WAAA,CACA,aAAA,CAEA,wDACC,6CAAA,CACA,wCAAA,CAGD,2DACC,gBAAA,CACA,cAAA,CACA,mBAAA,CAGD,0DACC,iBAAA,CACA,UAAA,CACA,YAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CAIF,yCACC,YAAA,CACA,qBAAA,CACA,WAAA,CAEA,kDACC,YAAA,CACA,kBAAA,CACA,mBAAA,CACA,QAAA\",\"sourcesContent\":[\"$sizes: (\\\"400\\\": (\\\"count\\\": 3, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"700\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"1024\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1280\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1440\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"1600\\\": (\\\"count\\\": 6, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2048\\\": (\\\"count\\\": 7, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2560\\\": (\\\"count\\\": 8, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"3440\\\": (\\\"count\\\": 9, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"max\\\": (\\\"count\\\": 10, \\\"marginTop\\\": 88, \\\"marginW\\\": 88));\\n\\n:deep(.photos-picker) {\\n\\t// remove padding to move scrollbar to the very end\\n\\tpadding-inline-end: 0 !important;\\n}\\n\\n.photos-picker {\\n\\n\\t&__navigation {\\n\\t\\t&__month {\\n\\t\\t\\t// For focus-visible outline\\n\\t\\t\\tmargin: 4px;\\n\\t\\t}\\n\\n\\t\\t&__month-select {\\n\\t\\t\\tflex: 1;\\n\\t\\t\\t// align with other content\\n\\t\\t\\tpadding-inline-end: 12px;\\n\\t\\t\\tpadding-block-end: 6px;\\n\\t\\t}\\n\\t}\\n\\n\\t&__file-list {\\n\\t\\tflex-grow: 1;\\n\\t\\tmin-width: 0;\\n\\t\\theight: 100%;\\n\\t\\tpadding: 0 4px;\\n\\n\\t\\t&--placeholder {\\n\\t\\t\\tbackground: var(--color-primary-element-light);\\n\\t\\t\\tborder-radius: var(--border-radius-large);\\n\\t\\t}\\n\\n\\t\\t.section-header {\\n\\t\\t\\tfont-weight: bold;\\n\\t\\t\\tfont-size: 20px;\\n\\t\\t\\tpadding: 8px 0 4px 0;\\n\\t\\t}\\n\\n\\t\\t:deep .empty-content {\\n\\t\\t\\tposition: absolute;\\n\\t\\t\\twidth: 100%;\\n\\t\\t\\tmargin-top: 0;\\n\\t\\t\\theight: 100%;\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\tflex-direction: column;\\n\\t\\t\\tjustify-content: center;\\n\\t\\t}\\n\\t}\\n\\n\\t&__actions {\\n\\t\\tdisplay: flex;\\n\\t\\tflex-direction: column;\\n\\t\\tflex-grow: 1;\\n\\n\\t\\t&__buttons {\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\talign-items: center;\\n\\t\\t\\tjustify-content: end;\\n\\t\\t\\tgap: 16px;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","/**\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n *\n * @author Louis Chemineau <louis@chmn.me>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { davGetClient, davRootPath } from '@nextcloud/files'\nimport { joinPaths } from '@nextcloud/paths'\nimport logger from '../services/logger.js'\nimport getPhotos from '../services/PhotoSearch.js'\nimport SemaphoreWithPriority from '../utils/semaphoreWithPriority.js'\nimport AbortControllerMixin from './AbortControllerMixin.js'\nimport store from '../store/index.js'\n\nexport default {\n\tname: 'FetchFilesMixin',\n\n\tmixins: [\n\t\tAbortControllerMixin,\n\t],\n\n\tdata() {\n\t\treturn {\n\t\t\terrorFetchingFiles: null,\n\t\t\tloadingFiles: false,\n\t\t\tdoneFetchingFiles: false,\n\t\t\tfetchSemaphore: new SemaphoreWithPriority(1),\n\t\t\tfetchedFileIds: [],\n\t\t}\n\t},\n\n\twatch: {\n\t\t'$route.path'() {\n\t\t\tthis.resetFetchFilesState()\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {object} options - Options to pass to getPhotos.\n\t\t * @param {string[]} [blacklist=[]] - Array of ids to filter out.\n\t\t * @param {boolean} [force=false] - Force fetching even if doneFetchingFiles is true\n\t\t * @return {Promise<string[]>} - The next batch of data depending on global offset.\n\t\t */\n\t\tasync fetchFiles(options = {}, blacklist = [], force = false) {\n\t\t\tif ((this.doneFetchingFiles && !force) || this.loadingFiles) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tconst fetchSemaphoreSymbol = await this.fetchSemaphore.acquire()\n\n\t\t\ttry {\n\t\t\t\tthis.errorFetchingFiles = null\n\t\t\t\tthis.loadingFiles = true\n\n\t\t\t\tconst numberOfImagesPerBatch = 200\n\n\t\t\t\t// Load next batch of images\n\t\t\t\tconst fetchedFiles = await getPhotos({\n\t\t\t\t\tfirstResult: this.fetchedFileIds.length,\n\t\t\t\t\tnbResults: numberOfImagesPerBatch,\n\t\t\t\t\t...options,\n\t\t\t\t\tsignal: this.abortController.signal,\n\t\t\t\t})\n\n\t\t\t\t// If we get less files than requested that means we got to the end\n\t\t\t\tif (fetchedFiles.length !== numberOfImagesPerBatch) {\n\t\t\t\t\tthis.doneFetchingFiles = true\n\t\t\t\t}\n\n\t\t\t\tconst fileIds = fetchedFiles\n\t\t\t\t\t.map(file => file.fileid)\n\t\t\t\t\t.filter(fileId => !this.fetchedFileIds.includes(fileId.toString())) // Filter to prevent duplicate fileIds.\n\n\t\t\t\tthis.fetchedFileIds.push(\n\t\t\t\t\t...fileIds\n\t\t\t\t\t\t.map((fileId) => fileId.toString())\n\t\t\t\t\t\t.filter((fileId) => !blacklist.includes(fileId))\n\t\t\t\t)\n\n\t\t\t\tthis.$store.dispatch('appendFiles', fetchedFiles)\n\n\t\t\t\tlogger.debug(`[FetchFilesMixin] Fetched ${fileIds.length} new files: `, fileIds)\n\n\t\t\t\treturn fileIds\n\t\t\t} catch (error) {\n\t\t\t\tif (error.response?.status === 404) {\n\t\t\t\t\tconst sources = store.state.userConfig.photosSourceFolders\n\t\t\t\t\tfor (const source of sources) {\n\t\t\t\t\t\tif (error.response?.data?.match(`File with name /${source} could not be located`) === null) {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlogger.debug(`The ${source} folder does not exist, creating it.`)\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait davGetClient().createDirectory(joinPaths(davRootPath, source))\n\t\t\t\t\t\t\tthis.resetFetchFilesState()\n\t\t\t\t\t\t\treturn []\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tthis.errorFetchingFiles = 404\n\t\t\t\t\t\t\tlogger.error('Fail to create source directory', { error })\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (error.code === 'ERR_CANCELED') {\n\t\t\t\t\treturn []\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorFetchingFiles = error\n\t\t\t\t}\n\n\t\t\t\t// cancelled request, moving on...\n\t\t\t\tlogger.error('Error fetching files', { error })\n\t\t\t} finally {\n\t\t\t\tthis.loadingFiles = false\n\t\t\t\tthis.fetchSemaphore.release(fetchSemaphoreSymbol)\n\t\t\t}\n\n\t\t\treturn []\n\t\t},\n\n\t\tresetFetchFilesState() {\n\t\t\tthis.doneFetchingFiles = false\n\t\t\tthis.errorFetchingFiles = null\n\t\t\tthis.loadingFiles = false\n\t\t\tthis.fetchedFileIds = []\n\t\t},\n\t},\n}\n","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { genFileInfo } from '../utils/fileUtils.js'\nimport { allMimes } from './AllowedMimes.js'\nimport client from './DavClient.js'\nimport { props } from './DavRequest.js'\nimport moment from '@nextcloud/moment'\nimport store from '../store/index.js'\nimport { davRootPath } from '@nextcloud/files'\nimport { joinPaths } from '@nextcloud/paths'\n\n/**\n * List files from a folder and filter out unwanted mimes\n *\n * @param {object} [options] used for the cancellable requests\n * @param {number} [options.firstResult=0] Index of the first result that we want (starts at 0)\n * @param {number} [options.nbResults=200] The number of file to fetch\n * @param {string[]} [options.mimesType=allMimes] Mime type of the files\n * @param {boolean} [options.full=false] get full data of the files\n * @param {boolean} [options.onThisDay=false] get only items from this day of year\n * @param {boolean} [options.onlyFavorites=false] get only favorite items\n * @return {Promise<object[]>} the file list\n */\nexport default async function(options = {}) {\n\t// default function options\n\toptions = {\n\t\tfirstResult: 0,\n\t\tnbResults: 200,\n\t\tmimesType: allMimes,\n\t\tonThisDay: false,\n\t\tonlyFavorites: false,\n\t\t...options,\n\t}\n\n\t// generating the search or condition\n\t// based on the allowed mimetypes\n\tconst orMime = options.mimesType.reduce((str, mime) => `${str}\n\t\t<d:eq>\n\t\t\t<d:prop>\n\t\t\t\t<d:getcontenttype/>\n\t\t\t</d:prop>\n\t\t\t<d:literal>${mime}</d:literal>\n\t\t</d:eq>\n\t`, '')\n\n\tconst eqFavorites = options.onlyFavorites\n\t\t? `<d:eq>\n\t\t\t\t<d:prop>\n\t\t\t\t\t<oc:favorite/>\n\t\t\t\t</d:prop>\n\t\t\t\t<d:literal>1</d:literal>\n\t\t\t</d:eq>`\n\t\t: ''\n\n\tconst onThisDay = options.onThisDay\n\t\t? `<d:or>${Array(20).fill(1)\n\t\t\t.map((_, years) => {\n\t\t\t\tconst start = moment(Date.now()).startOf('day').subtract(3, 'd').subtract(years + 1, 'y')\n\t\t\t\tconst end = moment(Date.now()).endOf('day').add(3, 'd').subtract(years + 1, 'y')\n\t\t\t\treturn `<d:and>\n\t\t\t\t<d:gt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>${start.format(moment.defaultFormatUtc)}</d:literal>\n\t\t\t\t</d:gt>\n\t\t\t\t<d:lt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>${end.format(moment.defaultFormatUtc)}</d:literal>\n\t\t\t\t</d:lt>\n\t\t\t</d:and>`\n\t\t\t}).join('\\n')}</d:or>`\n\t\t: ''\n\n\tconst sourceFolders = store.state.userConfig.photosSourceFolders\n\t\t.map(folder => `\n\t\t\t<d:scope>\n\t\t\t\t<d:href>${joinPaths(davRootPath, folder)}</d:href>\n\t\t\t\t<d:depth>infinity</d:depth>\n\t\t\t</d:scope>`\n\t\t)\n\t\t.join('\\n')\n\n\toptions = Object.assign({\n\t\tmethod: 'SEARCH',\n\t\theaders: {\n\t\t\t'content-Type': 'text/xml',\n\t\t},\n\t\tdata: `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\t\t\t<d:searchrequest xmlns:d=\"DAV:\"\n\t\t\t\txmlns:oc=\"http://owncloud.org/ns\"\n\t\t\t\txmlns:nc=\"http://nextcloud.org/ns\"\n\t\t\t\txmlns:ns=\"https://github.com/icewind1991/SearchDAV/ns\"\n\t\t\t\txmlns:ocs=\"http://open-collaboration-services.org/ns\">\n\t\t\t\t<d:basicsearch>\n\t\t\t\t\t<d:select>\n\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t${props}\n\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t</d:select>\n\t\t\t\t\t<d:from>\n\t\t\t\t\t\t${sourceFolders}\n\t\t\t\t\t</d:from>\n\t\t\t\t\t<d:where>\n\t\t\t\t\t\t<d:and>\n\t\t\t\t\t\t\t<d:or>\n\t\t\t\t\t\t\t\t${orMime}\n\t\t\t\t\t\t\t</d:or>\n\t\t\t\t\t\t\t${eqFavorites}\n\t\t\t\t\t\t\t${onThisDay}\n\t\t\t\t\t\t</d:and>\n\t\t\t\t\t</d:where>\n\t\t\t\t\t<d:orderby>\n\t\t\t\t\t\t<d:order>\n\t\t\t\t\t\t\t<d:prop><nc:metadata-photos-original_date_time/></d:prop>\n\t\t\t\t\t\t\t<d:descending/>\n\t\t\t\t\t\t</d:order>\n\t\t\t\t\t\t<d:order>\n\t\t\t\t\t\t\t<d:prop><d:getlastmodified/></d:prop>\n\t\t\t\t\t\t\t<d:descending/>\n\t\t\t\t\t\t</d:order>\n\t\t\t\t\t</d:orderby>\n\t\t\t\t\t<d:limit>\n\t\t\t\t\t\t<d:nresults>${options.nbResults}</d:nresults>\n\t\t\t\t\t\t<ns:firstresult>${options.firstResult}</ns:firstresult>\n\t\t\t\t\t</d:limit>\n\t\t\t\t</d:basicsearch>\n\t\t\t</d:searchrequest>`,\n\t\tdeep: true,\n\t\tdetails: true,\n\t}, options)\n\n\tconst response = await client.getDirectoryContents('', options)\n\n\treturn response.data.map(data => genFileInfo(data))\n}\n"],"names":["name","components","AlertCircle","FolderMultipleImage","NcEmptyContent","FilesListViewer","File","mixins","FilesSelectionMixin","isMobile","props","collection","type","Object","default","collectionFileIds","Array","required","loading","Boolean","allowSelection","error","Error","Number","data","appContent","document","getElementById","computed","files","$store","getters","sortedCollectionFileIds","toSorted","fileId1","fileId2","timestamp","mounted","subscribe","handleFileDeleted","destroyed","unsubscribe","methods","openViewer","fileId","file","OCA","Viewer","open","fileInfo","toViewerFileInfo","list","map","filter","sectionHeader","loadMore","canLoop","_ref","fileid","commit","collectionFileName","filename","fileIdsToRemove","toString","t","translate","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","_vm","this","_c","_self","undefined","staticClass","attrs","slot","_t","selectedFileIds","resetSelection","_v","length","_e","scopedSlots","_u","key","fn","distance","id","selection","on","onFileSelectToggle","___CSS_LOADER_EXPORT___","push","module","defineComponent","ImagePlus","NcButton","NcDialog","NcLoadingIcon","NcSelect","NcNoteCard","UploadPicker","FetchFilesMixin","FilesByMonthMixin","String","destination","blacklistIds","emits","setup","useIsMobile","allowedMimes","targetMonth","uploadContext","route","currentUser","getCurrentUser","uid","mapGetters","photosLocationFolder","state","userConfig","watch","monthsList","value","onFocusOut","event","relatedTarget","target","focus","preventScroll","getFiles","fetchFiles","refreshFiles","firstResult","fetchedFileIds","emitPickedEvent","$emit","dateMonthAndYear","date","moment","format","_setupProxy","isCollapsed","_ref2","label","_s","_ref3","model","callback","$$v","expression","_l","month","$event","proxy","escape","sanitize","attributes","owner","class","fileIdsByMonth","loadingFiles","nativeOn","apply","arguments","_ref4","height","isHeader","style","filesByMonth","keys","forEach","sort","sortFilesByTimestamp","month1","month2","AbortControllerMixin","errorFetchingFiles","doneFetchingFiles","fetchSemaphore","SemaphoreWithPriority","resetFetchFilesState","blacklist","force","fetchSemaphoreSymbol","acquire","numberOfImagesPerBatch","fetchedFiles","async","nbResults","mimesType","allMimes","onThisDay","onlyFavorites","orMime","reduce","str","mime","eqFavorites","fill","_","years","start","Date","now","startOf","subtract","end","endOf","add","defaultFormatUtc","join","sourceFolders","store","photosSourceFolders","folder","joinPaths","davRootPath","assign","method","headers","deep","details","client","getDirectoryContents","genFileInfo","getPhotos","signal","abortController","fileIds","includes","dispatch","logger","debug","response","status","sources","source","match","davGetClient","createDirectory","code","release"],"sourceRoot":""}
{"version":3,"file":"photos-src_components_Collection_CollectionContent_vue-src_components_PhotosPicker_vue.js?v=93cc743f7e61deef83e4","mappings":"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","sources":["webpack://photos/./src/components/PhotosPicker.vue?4733","webpack:///photos/src/components/PhotosPicker.vue","webpack:///photos/src/components/PhotosPicker.vue?vue&type=script&lang=js","webpack://photos/./src/components/PhotosPicker.vue?24f0","webpack://photos/./src/components/PhotosPicker.vue?67e2","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue?vue&type=script&lang=js","webpack://photos/./node_modules/vue-material-design-icons/FolderMultipleImage.vue?f9dd","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue?vue&type=template&id=497205fa","webpack:///photos/src/components/PhotosPicker.vue?vue&type=style&index=0&id=bee097ec&prod&lang=scss&scoped=true","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=style&index=0&id=a7194c5e&prod&lang=scss&scoped=true","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue?vue&type=script&lang=js","webpack://photos/./node_modules/vue-material-design-icons/ImagePlus.vue?8b12","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue?vue&type=template&id=6b6ee9f3","webpack:///photos/src/mixins/FilesByMonthMixin.js","webpack:///photos/src/mixins/FetchFilesMixin.js","webpack:///photos/src/services/PhotoSearch.js","webpack://photos/./src/components/Collection/CollectionContent.vue?de63","webpack:///photos/src/components/Collection/CollectionContent.vue","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=script&lang=js","webpack://photos/./src/components/Collection/CollectionContent.vue?6c09","webpack://photos/./src/components/Collection/CollectionContent.vue?d20d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('NcDialog',{attrs:{\"content-classes\":\"photos-picker\",\"name\":_vm.name,\"open\":_vm.open,\"out-transition\":\"\",\"size\":\"large\"},on:{\"update:open\":(open) => _vm.$emit('update:open', open)},scopedSlots:_vm._u([{key:\"navigation\",fn:function({ isCollapsed }){return [(isCollapsed)?_c('NcSelect',{staticClass:\"photos-picker__navigation__month-select\",attrs:{\"aria-label-listbox\":_vm.t('photos', 'Dates'),\"clearable\":false,\"input-label\":_vm.t('photos', 'Jump to specific date in list'),\"options\":_vm.monthsList},scopedSlots:_vm._u([{key:\"selected-option\",fn:function({ label }){return [_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(label))+\"\\n\\t\\t\\t\")]}},{key:\"option\",fn:function({ label }){return [_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(label))+\"\\n\\t\\t\\t\")]}}],null,true),model:{value:(_vm.targetMonth),callback:function ($$v) {_vm.targetMonth=$$v},expression:\"targetMonth\"}}):_c('ul',{attrs:{\"aria-label\":_vm.t('photos', 'Dates')}},_vm._l((_vm.monthsList),function(month){return _c('li',{key:month,staticClass:\"photos-picker__navigation__month\"},[_c('NcButton',{attrs:{\"type\":_vm.targetMonth === month ? 'secondary' : 'tertiary',\"aria-label\":_vm.t('photos', 'Jump to {date}', { date: _vm.dateMonthAndYear(month) })},on:{\"click\":function($event){_vm.targetMonth = month}}},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(month))+\"\\n\\t\\t\\t\\t\")])],1)}),0)]}},{key:\"actions\",fn:function(){return [_c('div',{staticClass:\"photos-picker__actions\"},[_c('div',{staticClass:\"photos-picker__actions__buttons\"},[_c('UploadPicker',{attrs:{\"accept\":_vm.allowedMimes,\"context\":_vm.uploadContext,\"destination\":_vm.photosLocationFolder,\"multiple\":true},on:{\"uploaded\":_vm.refreshFiles}}),_vm._v(\" \"),_c('NcButton',{attrs:{\"type\":\"primary\",\"disabled\":_vm.loading || _vm.selectedFileIds.length === 0},on:{\"click\":_vm.emitPickedEvent},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [(!_vm.loading)?_c('ImagePlus'):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('NcLoadingIcon'):_vm._e()]},proxy:true}])},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('photos', 'Add to {destination}', { destination: _vm.destination }))+\"\\n\\t\\t\\t\\t\")])],1),_vm._v(\" \"),(_vm.photosLocationFolder.attributes['owner-id'] !== _vm.currentUser)?_c('NcNoteCard',{attrs:{\"type\":\"warning\"}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('photos', 'The destination folder is owned by {owner}', { owner: _vm.photosLocationFolder.attributes['owner-id'] }))+\"\\n\\t\\t\\t\")]):_vm._e()],1)]},proxy:true}])},[_vm._v(\" \"),_vm._v(\" \"),_c('FilesListViewer',{staticClass:\"photos-picker__file-list\",class:{'photos-picker__file-list--placeholder': _vm.monthsList.length === 0},attrs:{\"file-ids-by-section\":_vm.fileIdsByMonth,\"empty-message\":_vm.t('photos', 'There are no photos or videos yet!'),\"sections\":_vm.monthsList,\"loading\":_vm.loadingFiles,\"base-height\":100,\"section-header-height\":50,\"scroll-to-section\":_vm.targetMonth},on:{\"need-content\":_vm.getFiles},nativeOn:{\"focusout\":function($event){return _vm.onFocusOut.apply(null, arguments)}},scopedSlots:_vm._u([{key:\"default\",fn:function({file, height, isHeader, distance}){return [(isHeader)?_c('h3',{staticClass:\"section-header\",style:({ height: `${height}px`}),attrs:{\"id\":`photos-picker-section-header-${file.id}`}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.dateMonthAndYear(file.id))+\"\\n\\t\\t\\t\")]):_c('File',{attrs:{\"file\":_vm.files[file.id],\"allow-selection\":true,\"selected\":_vm.selection[file.id] === true,\"distance\":distance},on:{\"select-toggled\":_vm.onFileSelectToggle}})]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n - @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n -\n - @author Louis Chemineau <louis@chmn.me>\n - @author Ferdinand Thiessen <opensource@fthiessen.de>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n -->\n<template>\n\t<NcDialog content-classes=\"photos-picker\"\n\t\t:name=\"name\"\n\t\t:open=\"open\"\n\t\tout-transition\n\t\tsize=\"large\"\n\t\t@update:open=\"(open) => $emit('update:open', open)\">\n\t\t<!-- Navigation containing the months available -->\n\t\t<template #navigation=\"{ isCollapsed }\">\n\t\t\t<!-- Mobile view -->\n\t\t\t<NcSelect v-if=\"isCollapsed\"\n\t\t\t\tv-model=\"targetMonth\"\n\t\t\t\t:aria-label-listbox=\"t('photos', 'Dates')\"\n\t\t\t\tclass=\"photos-picker__navigation__month-select\"\n\t\t\t\t:clearable=\"false\"\n\t\t\t\t:input-label=\"t('photos', 'Jump to specific date in list')\"\n\t\t\t\t:options=\"monthsList\">\n\t\t\t\t<template #selected-option=\"{ label }\">\n\t\t\t\t\t{{ dateMonthAndYear(label) }}\n\t\t\t\t</template>\n\t\t\t\t<template #option=\"{ label }\">\n\t\t\t\t\t{{ dateMonthAndYear(label) }}\n\t\t\t\t</template>\n\t\t\t</NcSelect>\n\n\t\t\t<!-- Default view -->\n\t\t\t<ul v-else :aria-label=\"t('photos', 'Dates')\">\n\t\t\t\t<li v-for=\"month in monthsList\"\n\t\t\t\t\t:key=\"month\"\n\t\t\t\t\tclass=\"photos-picker__navigation__month\">\n\t\t\t\t\t<NcButton :type=\"targetMonth === month ? 'secondary' : 'tertiary'\"\n\t\t\t\t\t\t:aria-label=\"t('photos', 'Jump to {date}', { date: dateMonthAndYear(month) })\"\n\t\t\t\t\t\t@click=\"targetMonth = month\">\n\t\t\t\t\t\t{{ dateMonthAndYear(month) }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</template>\n\n\t\t<!-- The actions on the bottom -->\n\t\t<template #actions>\n\t\t\t<div class=\"photos-picker__actions\">\n\t\t\t\t<div class=\"photos-picker__actions__buttons\">\n\t\t\t\t\t<UploadPicker :accept=\"allowedMimes\"\n\t\t\t\t\t\t:context=\"uploadContext\"\n\t\t\t\t\t\t:destination=\"photosLocationFolder\"\n\t\t\t\t\t\t:multiple=\"true\"\n\t\t\t\t\t\t@uploaded=\"refreshFiles\" />\n\t\t\t\t\t<NcButton type=\"primary\" :disabled=\"loading || selectedFileIds.length === 0\" @click=\"emitPickedEvent\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<ImagePlus v-if=\"!loading\" />\n\t\t\t\t\t\t\t<NcLoadingIcon v-if=\"loading\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('photos', 'Add to {destination}', { destination }) }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t\t<NcNoteCard v-if=\"photosLocationFolder.attributes['owner-id'] !== currentUser\" type=\"warning\">\n\t\t\t\t\t{{ t('photos', 'The destination folder is owned by {owner}', { owner: photosLocationFolder.attributes['owner-id'] }) }}\n\t\t\t\t</NcNoteCard>\n\t\t\t</div>\n\t\t</template>\n\n\t\t<FilesListViewer class=\"photos-picker__file-list\"\n\t\t\t:class=\"{'photos-picker__file-list--placeholder': monthsList.length === 0}\"\n\t\t\t:file-ids-by-section=\"fileIdsByMonth\"\n\t\t\t:empty-message=\"t('photos', 'There are no photos or videos yet!')\"\n\t\t\t:sections=\"monthsList\"\n\t\t\t:loading=\"loadingFiles\"\n\t\t\t:base-height=\"100\"\n\t\t\t:section-header-height=\"50\"\n\t\t\t:scroll-to-section=\"targetMonth\"\n\t\t\t@need-content=\"getFiles\"\n\t\t\t@focusout.native=\"onFocusOut\">\n\t\t\t<template slot-scope=\"{file, height, isHeader, distance}\">\n\t\t\t\t<h3 v-if=\"isHeader\"\n\t\t\t\t\t:id=\"`photos-picker-section-header-${file.id}`\"\n\t\t\t\t\t:style=\"{ height: `${height}px`}\"\n\t\t\t\t\tclass=\"section-header\">\n\t\t\t\t\t{{ dateMonthAndYear(file.id) }}\n\t\t\t\t</h3>\n\n\t\t\t\t<File v-else\n\t\t\t\t\t:file=\"files[file.id]\"\n\t\t\t\t\t:allow-selection=\"true\"\n\t\t\t\t\t:selected=\"selection[file.id] === true\"\n\t\t\t\t\t:distance=\"distance\"\n\t\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\n\t\t\t</template>\n\t\t</FilesListViewer>\n\t</NcDialog>\n</template>\n\n<script>\nimport { UploadPicker } from '@nextcloud/upload'\nimport { NcButton, NcDialog, NcLoadingIcon, NcSelect, NcNoteCard, useIsMobile } from '@nextcloud/vue'\nimport { defineComponent } from 'vue'\nimport { mapGetters } from 'vuex'\n\nimport moment from '@nextcloud/moment'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nimport ImagePlus from 'vue-material-design-icons/ImagePlus.vue'\n\nimport FilesListViewer from './FilesListViewer.vue'\nimport File from './File.vue'\n\nimport FetchFilesMixin from '../mixins/FetchFilesMixin.js'\nimport FilesSelectionMixin from '../mixins/FilesSelectionMixin.js'\nimport FilesByMonthMixin from '../mixins/FilesByMonthMixin.js'\nimport allowedMimes from '../services/AllowedMimes.js'\n\nexport default defineComponent({\n\tname: 'PhotosPicker',\n\n\tcomponents: {\n\t\tFile,\n\t\tFilesListViewer,\n\t\tImagePlus,\n\t\tNcButton,\n\t\tNcDialog,\n\t\tNcLoadingIcon,\n\t\tNcSelect,\n\t\tNcNoteCard,\n\t\tUploadPicker,\n\t},\n\n\tmixins: [\n\t\tFetchFilesMixin,\n\t\tFilesByMonthMixin,\n\t\tFilesSelectionMixin,\n\t],\n\n\tprops: {\n\t\t/**\n\t\t * If the photos picker should be opened\n\t\t */\n\t\topen: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\n\t\t/**\n\t\t * Name to be used as heading\n\t\t */\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\t// Label to show in the submit button.\n\t\tdestination: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\n\t\t// List of file ids to not show.\n\t\tblacklistIds: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\n\t\t// Whether we should disable the submit button and show a spinner.\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: ['files-picked', 'update:open'],\n\n\tsetup() {\n\t\treturn {\n\t\t\tisMobile: useIsMobile(),\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tallowedMimes,\n\t\t\ttargetMonth: null,\n\t\t\tuploadContext: {\n\t\t\t\troute: 'albumpicker',\n\t\t\t},\n\t\t\tcurrentUser: getCurrentUser().uid,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'files',\n\t\t]),\n\n\t\tphotosLocationFolder() {\n\t\t\treturn this.$store.state.userConfig.photosLocationFolder\n\t\t},\n\t},\n\n\twatch: {\n\t\tmonthsList(value) {\n\t\t\tif (this.targetMonth === null) {\n\t\t\t\tthis.targetMonth = value[0]\n\t\t\t}\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {FocusEvent} event The focus event\n\t\t */\n\t\tonFocusOut(event) {\n\t\t\tif (event.relatedTarget === null) { // Focus escaping to body\n\t\t\t\tevent.target.focus({ preventScroll: true })\n\t\t\t}\n\t\t},\n\n\t\tgetFiles() {\n\t\t\tthis.fetchFiles({}, this.blacklistIds)\n\t\t},\n\n\t\trefreshFiles() {\n\t\t\tthis.fetchFiles({ firstResult: 0 }, [...this.blacklistIds, ...this.fetchedFileIds], true)\n\t\t},\n\n\t\temitPickedEvent() {\n\t\t\tthis.$emit('files-picked', this.selectedFileIds)\n\t\t},\n\t\t/**\n\t\t * @param {string} date - In the following format: YYYYMM\n\t\t */\n\t\tdateMonthAndYear(date) {\n\t\t\tif (this.isMobile) {\n\t\t\t\treturn moment(date, 'YYYYMM').format('MMM YYYY')\n\t\t\t}\n\t\t\treturn moment(date, 'YYYYMM').format('MMMM YYYY')\n\t\t},\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n:deep(.photos-picker) {\n\t// remove padding to move scrollbar to the very end\n\tpadding-inline-end: 0 !important;\n}\n\n.photos-picker {\n\n\t&__navigation {\n\t\t&__month {\n\t\t\t// For focus-visible outline\n\t\t\tmargin: 4px;\n\t\t}\n\n\t\t&__month-select {\n\t\t\tflex: 1;\n\t\t\t// align with other content\n\t\t\tpadding-inline-end: 12px;\n\t\t\tpadding-block-end: 6px;\n\t\t}\n\t}\n\n\t&__file-list {\n\t\tflex-grow: 1;\n\t\tmin-width: 0;\n\t\theight: 100%;\n\t\tpadding: 0 4px;\n\n\t\t&--placeholder {\n\t\t\tbackground: var(--color-primary-element-light);\n\t\t\tborder-radius: var(--border-radius-large);\n\t\t}\n\n\t\t.section-header {\n\t\t\tfont-weight: bold;\n\t\t\tfont-size: 20px;\n\t\t\tpadding: 8px 0 4px 0;\n\t\t}\n\n\t\t:deep .empty-content {\n\t\t\tposition: absolute;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 0;\n\t\t\theight: 100%;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t&__actions {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tflex-grow: 1;\n\n\t\t&__buttons {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: end;\n\t\t\tgap: 16px;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=script&lang=js\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=style&index=0&id=bee097ec&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PhotosPicker.vue?vue&type=style&index=0&id=bee097ec&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./PhotosPicker.vue?vue&type=template&id=bee097ec&scoped=true\"\nimport script from \"./PhotosPicker.vue?vue&type=script&lang=js\"\nexport * from \"./PhotosPicker.vue?vue&type=script&lang=js\"\nimport style0 from \"./PhotosPicker.vue?vue&type=style&index=0&id=bee097ec&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bee097ec\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"!title\"\n        :aria-label=\"title\"\n        class=\"material-design-icon folder-multiple-image-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"FolderMultipleImageIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./FolderMultipleImage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./FolderMultipleImage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./FolderMultipleImage.vue?vue&type=template&id=497205fa\"\nimport script from \"./FolderMultipleImage.vue?vue&type=script&lang=js\"\nexport * from \"./FolderMultipleImage.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('span',_vm._b({staticClass:\"material-design-icon folder-multiple-image-icon\",attrs:{\"aria-hidden\":!_vm.title,\"aria-label\":_vm.title,\"role\":\"img\"},on:{\"click\":function($event){return _vm.$emit('click', $event)}}},'span',_vm.$attrs,false),[_c('svg',{staticClass:\"material-design-icon__svg\",attrs:{\"fill\":_vm.fillColor,\"width\":_vm.size,\"height\":_vm.size,\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z\"}},[(_vm.title)?_c('title',[_vm._v(_vm._s(_vm.title))]):_vm._e()])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `[data-v-bee097ec] .photos-picker{padding-inline-end:0 !important}.photos-picker__navigation__month[data-v-bee097ec]{margin:4px}.photos-picker__navigation__month-select[data-v-bee097ec]{flex:1;padding-inline-end:12px;padding-block-end:6px}.photos-picker__file-list[data-v-bee097ec]{flex-grow:1;min-width:0;height:100%;padding:0 4px}.photos-picker__file-list--placeholder[data-v-bee097ec]{background:var(--color-primary-element-light);border-radius:var(--border-radius-large)}.photos-picker__file-list .section-header[data-v-bee097ec]{font-weight:bold;font-size:20px;padding:8px 0 4px 0}.photos-picker__file-list[data-v-bee097ec] .empty-content{position:absolute;width:100%;margin-top:0;height:100%;display:flex;flex-direction:column;justify-content:center}.photos-picker__actions[data-v-bee097ec]{display:flex;flex-direction:column;flex-grow:1}.photos-picker__actions__buttons[data-v-bee097ec]{display:flex;align-items:center;justify-content:end;gap:16px}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/PhotosPicker.vue\"],\"names\":[],\"mappings\":\"AAEA,iCAEC,+BAAA,CAMC,mDAEC,UAAA,CAGD,0DACC,MAAA,CAEA,uBAAA,CACA,qBAAA,CAIF,2CACC,WAAA,CACA,WAAA,CACA,WAAA,CACA,aAAA,CAEA,wDACC,6CAAA,CACA,wCAAA,CAGD,2DACC,gBAAA,CACA,cAAA,CACA,mBAAA,CAGD,0DACC,iBAAA,CACA,UAAA,CACA,YAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CAIF,yCACC,YAAA,CACA,qBAAA,CACA,WAAA,CAEA,kDACC,YAAA,CACA,kBAAA,CACA,mBAAA,CACA,QAAA\",\"sourcesContent\":[\"$sizes: (\\\"400\\\": (\\\"count\\\": 3, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"700\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"1024\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1280\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1440\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"1600\\\": (\\\"count\\\": 6, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2048\\\": (\\\"count\\\": 7, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2560\\\": (\\\"count\\\": 8, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"3440\\\": (\\\"count\\\": 9, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"max\\\": (\\\"count\\\": 10, \\\"marginTop\\\": 88, \\\"marginW\\\": 88));\\n\\n:deep(.photos-picker) {\\n\\t// remove padding to move scrollbar to the very end\\n\\tpadding-inline-end: 0 !important;\\n}\\n\\n.photos-picker {\\n\\n\\t&__navigation {\\n\\t\\t&__month {\\n\\t\\t\\t// For focus-visible outline\\n\\t\\t\\tmargin: 4px;\\n\\t\\t}\\n\\n\\t\\t&__month-select {\\n\\t\\t\\tflex: 1;\\n\\t\\t\\t// align with other content\\n\\t\\t\\tpadding-inline-end: 12px;\\n\\t\\t\\tpadding-block-end: 6px;\\n\\t\\t}\\n\\t}\\n\\n\\t&__file-list {\\n\\t\\tflex-grow: 1;\\n\\t\\tmin-width: 0;\\n\\t\\theight: 100%;\\n\\t\\tpadding: 0 4px;\\n\\n\\t\\t&--placeholder {\\n\\t\\t\\tbackground: var(--color-primary-element-light);\\n\\t\\t\\tborder-radius: var(--border-radius-large);\\n\\t\\t}\\n\\n\\t\\t.section-header {\\n\\t\\t\\tfont-weight: bold;\\n\\t\\t\\tfont-size: 20px;\\n\\t\\t\\tpadding: 8px 0 4px 0;\\n\\t\\t}\\n\\n\\t\\t:deep .empty-content {\\n\\t\\t\\tposition: absolute;\\n\\t\\t\\twidth: 100%;\\n\\t\\t\\tmargin-top: 0;\\n\\t\\t\\theight: 100%;\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\tflex-direction: column;\\n\\t\\t\\tjustify-content: center;\\n\\t\\t}\\n\\t}\\n\\n\\t&__actions {\\n\\t\\tdisplay: flex;\\n\\t\\tflex-direction: column;\\n\\t\\tflex-grow: 1;\\n\\n\\t\\t&__buttons {\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\talign-items: center;\\n\\t\\t\\tjustify-content: end;\\n\\t\\t\\tgap: 16px;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.collection[data-v-a7194c5e]{display:flex;flex-direction:column}.collection__media[data-v-a7194c5e]{padding:0 64px}@media only screen and (max-width: 1200px){.collection__media[data-v-a7194c5e]{padding:0 4px}}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Collection/CollectionContent.vue\"],\"names\":[],\"mappings\":\"AAEA,6BACC,YAAA,CACA,qBAAA,CAEA,oCACC,cAAA,CAEA,2CAHD,oCAIE,aAAA,CAAA\",\"sourcesContent\":[\"$sizes: (\\\"400\\\": (\\\"count\\\": 3, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"700\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"1024\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1280\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1440\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"1600\\\": (\\\"count\\\": 6, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2048\\\": (\\\"count\\\": 7, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2560\\\": (\\\"count\\\": 8, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"3440\\\": (\\\"count\\\": 9, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"max\\\": (\\\"count\\\": 10, \\\"marginTop\\\": 88, \\\"marginW\\\": 88));\\n\\n.collection {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\n\\t&__media {\\n\\t\\tpadding: 0 64px;\\n\\n\\t\\t@media only screen and (max-width: 1200px) {\\n\\t\\t\\tpadding: 0 4px;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"!title\"\n        :aria-label=\"title\"\n        class=\"material-design-icon image-plus-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"ImagePlusIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./ImagePlus.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./ImagePlus.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ImagePlus.vue?vue&type=template&id=6b6ee9f3\"\nimport script from \"./ImagePlus.vue?vue&type=script&lang=js\"\nexport * from \"./ImagePlus.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('span',_vm._b({staticClass:\"material-design-icon image-plus-icon\",attrs:{\"aria-hidden\":!_vm.title,\"aria-label\":_vm.title,\"role\":\"img\"},on:{\"click\":function($event){return _vm.$emit('click', $event)}}},'span',_vm.$attrs,false),[_c('svg',{staticClass:\"material-design-icon__svg\",attrs:{\"fill\":_vm.fillColor,\"width\":_vm.size,\"height\":_vm.size,\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z\"}},[(_vm.title)?_c('title',[_vm._v(_vm._s(_vm.title))]):_vm._e()])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n *\n * @author Louis Chemineau <louis@chmn.me>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default {\n\tname: 'FilesByMonthMixin',\n\n\tcomputed: {\n\t\t/**\n\t\t * @return {Object<string, []>}\n\t\t */\n\t\tfileIdsByMonth() {\n\t\t\tconst filesByMonth = {}\n\t\t\tfor (const fileId of this.fetchedFileIds) {\n\t\t\t\tconst file = this.files[fileId]\n\t\t\t\tif (file) {\n\t\t\t\t\tfilesByMonth[file.month] = filesByMonth[file.month] ?? []\n\t\t\t\t\tfilesByMonth[file.month].push(file.fileid)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Sort files in sections.\n\t\t\tObject.keys(filesByMonth)\n\t\t\t\t.forEach(month => filesByMonth[month].sort(this.sortFilesByTimestamp))\n\n\t\t\treturn filesByMonth\n\t\t},\n\n\t\t/**\n\t\t * @return {string[]}\n\t\t */\n\t\tmonthsList() {\n\t\t\treturn Object\n\t\t\t\t.keys(this.fileIdsByMonth)\n\t\t\t\t.sort((month1, month2) => month1 > month2 ? -1 : 1)\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {string} fileId1 The first file ID\n\t\t * @param {string} fileId2 The second file ID\n\t\t * @return {-1 | 1}\n\t\t */\n\t\tsortFilesByTimestamp(fileId1, fileId2) {\n\t\t\treturn this.files[fileId1].timestamp > this.files[fileId2].timestamp ? -1 : 1\n\t\t},\n\t},\n}\n","/**\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n *\n * @author Louis Chemineau <louis@chmn.me>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { davGetClient, davRootPath } from '@nextcloud/files'\nimport { joinPaths } from '@nextcloud/paths'\nimport logger from '../services/logger.js'\nimport getPhotos from '../services/PhotoSearch.js'\nimport SemaphoreWithPriority from '../utils/semaphoreWithPriority.js'\nimport AbortControllerMixin from './AbortControllerMixin.js'\nimport store from '../store/index.js'\n\nexport default {\n\tname: 'FetchFilesMixin',\n\n\tmixins: [\n\t\tAbortControllerMixin,\n\t],\n\n\tdata() {\n\t\treturn {\n\t\t\terrorFetchingFiles: null,\n\t\t\tloadingFiles: false,\n\t\t\tdoneFetchingFiles: false,\n\t\t\tfetchSemaphore: new SemaphoreWithPriority(1),\n\t\t\tfetchedFileIds: [],\n\t\t}\n\t},\n\n\twatch: {\n\t\t'$route.path'() {\n\t\t\tthis.resetFetchFilesState()\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {object} options - Options to pass to getPhotos.\n\t\t * @param {string[]} [blacklist=[]] - Array of ids to filter out.\n\t\t * @param {boolean} [force=false] - Force fetching even if doneFetchingFiles is true\n\t\t * @return {Promise<string[]>} - The next batch of data depending on global offset.\n\t\t */\n\t\tasync fetchFiles(options = {}, blacklist = [], force = false) {\n\t\t\tif ((this.doneFetchingFiles && !force) || this.loadingFiles) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tconst fetchSemaphoreSymbol = await this.fetchSemaphore.acquire()\n\n\t\t\ttry {\n\t\t\t\tthis.errorFetchingFiles = null\n\t\t\t\tthis.loadingFiles = true\n\n\t\t\t\tconst numberOfImagesPerBatch = 200\n\n\t\t\t\t// Load next batch of images\n\t\t\t\tconst fetchedFiles = await getPhotos({\n\t\t\t\t\tfirstResult: this.fetchedFileIds.length,\n\t\t\t\t\tnbResults: numberOfImagesPerBatch,\n\t\t\t\t\t...options,\n\t\t\t\t\tsignal: this.abortController.signal,\n\t\t\t\t})\n\n\t\t\t\t// If we get less files than requested that means we got to the end\n\t\t\t\tif (fetchedFiles.length !== numberOfImagesPerBatch) {\n\t\t\t\t\tthis.doneFetchingFiles = true\n\t\t\t\t}\n\n\t\t\t\tconst fileIds = fetchedFiles\n\t\t\t\t\t.map(file => file.fileid)\n\t\t\t\t\t.filter(fileId => !this.fetchedFileIds.includes(fileId.toString())) // Filter to prevent duplicate fileIds.\n\n\t\t\t\tthis.fetchedFileIds.push(\n\t\t\t\t\t...fileIds\n\t\t\t\t\t\t.map((fileId) => fileId.toString())\n\t\t\t\t\t\t.filter((fileId) => !blacklist.includes(fileId))\n\t\t\t\t)\n\n\t\t\t\tthis.$store.dispatch('appendFiles', fetchedFiles)\n\n\t\t\t\tlogger.debug(`[FetchFilesMixin] Fetched ${fileIds.length} new files: `, fileIds)\n\n\t\t\t\treturn fileIds\n\t\t\t} catch (error) {\n\t\t\t\tif (error.response?.status === 404) {\n\t\t\t\t\tconst sources = store.state.userConfig.photosSourceFolders\n\t\t\t\t\tfor (const source of sources) {\n\t\t\t\t\t\tif (error.response?.data?.match(`File with name /${source} could not be located`) === null) {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlogger.debug(`The ${source} folder does not exist, creating it.`)\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait davGetClient().createDirectory(joinPaths(davRootPath, source))\n\t\t\t\t\t\t\tthis.resetFetchFilesState()\n\t\t\t\t\t\t\treturn []\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tthis.errorFetchingFiles = 404\n\t\t\t\t\t\t\tlogger.error('Fail to create source directory', { error })\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (error.code === 'ERR_CANCELED') {\n\t\t\t\t\treturn []\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorFetchingFiles = error\n\t\t\t\t}\n\n\t\t\t\t// cancelled request, moving on...\n\t\t\t\tlogger.error('Error fetching files', { error })\n\t\t\t} finally {\n\t\t\t\tthis.loadingFiles = false\n\t\t\t\tthis.fetchSemaphore.release(fetchSemaphoreSymbol)\n\t\t\t}\n\n\t\t\treturn []\n\t\t},\n\n\t\tresetFetchFilesState() {\n\t\t\tthis.doneFetchingFiles = false\n\t\t\tthis.errorFetchingFiles = null\n\t\t\tthis.loadingFiles = false\n\t\t\tthis.fetchedFileIds = []\n\t\t},\n\t},\n}\n","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { genFileInfo } from '../utils/fileUtils.js'\nimport { allMimes } from './AllowedMimes.js'\nimport client from './DavClient.js'\nimport { props } from './DavRequest.js'\nimport moment from '@nextcloud/moment'\nimport store from '../store/index.js'\nimport { davRootPath } from '@nextcloud/files'\nimport { joinPaths } from '@nextcloud/paths'\n\n/**\n * List files from a folder and filter out unwanted mimes\n *\n * @param {object} [options] used for the cancellable requests\n * @param {number} [options.firstResult=0] Index of the first result that we want (starts at 0)\n * @param {number} [options.nbResults=200] The number of file to fetch\n * @param {string[]} [options.mimesType=allMimes] Mime type of the files\n * @param {boolean} [options.full=false] get full data of the files\n * @param {boolean} [options.onThisDay=false] get only items from this day of year\n * @param {boolean} [options.onlyFavorites=false] get only favorite items\n * @return {Promise<object[]>} the file list\n */\nexport default async function(options = {}) {\n\t// default function options\n\toptions = {\n\t\tfirstResult: 0,\n\t\tnbResults: 200,\n\t\tmimesType: allMimes,\n\t\tonThisDay: false,\n\t\tonlyFavorites: false,\n\t\t...options,\n\t}\n\n\t// generating the search or condition\n\t// based on the allowed mimetypes\n\tconst orMime = options.mimesType.reduce((str, mime) => `${str}\n\t\t<d:eq>\n\t\t\t<d:prop>\n\t\t\t\t<d:getcontenttype/>\n\t\t\t</d:prop>\n\t\t\t<d:literal>${mime}</d:literal>\n\t\t</d:eq>\n\t`, '')\n\n\tconst eqFavorites = options.onlyFavorites\n\t\t? `<d:eq>\n\t\t\t\t<d:prop>\n\t\t\t\t\t<oc:favorite/>\n\t\t\t\t</d:prop>\n\t\t\t\t<d:literal>1</d:literal>\n\t\t\t</d:eq>`\n\t\t: ''\n\n\tconst onThisDay = options.onThisDay\n\t\t? `<d:or>${Array(20).fill(1)\n\t\t\t.map((_, years) => {\n\t\t\t\tconst start = moment(Date.now()).startOf('day').subtract(3, 'd').subtract(years + 1, 'y')\n\t\t\t\tconst end = moment(Date.now()).endOf('day').add(3, 'd').subtract(years + 1, 'y')\n\t\t\t\treturn `<d:and>\n\t\t\t\t<d:gt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>${start.format(moment.defaultFormatUtc)}</d:literal>\n\t\t\t\t</d:gt>\n\t\t\t\t<d:lt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>${end.format(moment.defaultFormatUtc)}</d:literal>\n\t\t\t\t</d:lt>\n\t\t\t</d:and>`\n\t\t\t}).join('\\n')}</d:or>`\n\t\t: ''\n\n\tconst sourceFolders = store.state.userConfig.photosSourceFolders\n\t\t.map(folder => `\n\t\t\t<d:scope>\n\t\t\t\t<d:href>${joinPaths(davRootPath, folder)}</d:href>\n\t\t\t\t<d:depth>infinity</d:depth>\n\t\t\t</d:scope>`\n\t\t)\n\t\t.join('\\n')\n\n\toptions = Object.assign({\n\t\tmethod: 'SEARCH',\n\t\theaders: {\n\t\t\t'content-Type': 'text/xml',\n\t\t},\n\t\tdata: `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\t\t\t<d:searchrequest xmlns:d=\"DAV:\"\n\t\t\t\txmlns:oc=\"http://owncloud.org/ns\"\n\t\t\t\txmlns:nc=\"http://nextcloud.org/ns\"\n\t\t\t\txmlns:ns=\"https://github.com/icewind1991/SearchDAV/ns\"\n\t\t\t\txmlns:ocs=\"http://open-collaboration-services.org/ns\">\n\t\t\t\t<d:basicsearch>\n\t\t\t\t\t<d:select>\n\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t${props}\n\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t</d:select>\n\t\t\t\t\t<d:from>\n\t\t\t\t\t\t${sourceFolders}\n\t\t\t\t\t</d:from>\n\t\t\t\t\t<d:where>\n\t\t\t\t\t\t<d:and>\n\t\t\t\t\t\t\t<d:or>\n\t\t\t\t\t\t\t\t${orMime}\n\t\t\t\t\t\t\t</d:or>\n\t\t\t\t\t\t\t${eqFavorites}\n\t\t\t\t\t\t\t${onThisDay}\n\t\t\t\t\t\t</d:and>\n\t\t\t\t\t</d:where>\n\t\t\t\t\t<d:orderby>\n\t\t\t\t\t\t<d:order>\n\t\t\t\t\t\t\t<d:prop><nc:metadata-photos-original_date_time/></d:prop>\n\t\t\t\t\t\t\t<d:descending/>\n\t\t\t\t\t\t</d:order>\n\t\t\t\t\t\t<d:order>\n\t\t\t\t\t\t\t<d:prop><d:getlastmodified/></d:prop>\n\t\t\t\t\t\t\t<d:descending/>\n\t\t\t\t\t\t</d:order>\n\t\t\t\t\t</d:orderby>\n\t\t\t\t\t<d:limit>\n\t\t\t\t\t\t<d:nresults>${options.nbResults}</d:nresults>\n\t\t\t\t\t\t<ns:firstresult>${options.firstResult}</ns:firstresult>\n\t\t\t\t\t</d:limit>\n\t\t\t\t</d:basicsearch>\n\t\t\t</d:searchrequest>`,\n\t\tdeep: true,\n\t\tdetails: true,\n\t}, options)\n\n\tconst response = await client.getDirectoryContents('', options)\n\n\treturn response.data.map(data => genFileInfo(data))\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return ((_vm.collection === undefined && !_vm.loading) || _vm.error === 404)?_c('NcEmptyContent',{staticClass:\"empty-content-with-illustration\",attrs:{\"name\":_vm.t('photos', 'This collection does not exist')}},[_c('FolderMultipleImage',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):(_vm.error)?_c('NcEmptyContent',{attrs:{\"name\":_vm.t('photos', 'An error occurred')}},[_c('AlertCircle',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):_c('div',{staticClass:\"collection\"},[_vm._t(\"header\",null,{\"selectedFileIds\":_vm.selectedFileIds,\"resetSelection\":_vm.resetSelection}),_vm._v(\" \"),(_vm.sortedCollectionFileIds.length === 0 && !_vm.loading)?_vm._t(\"empty-content\"):_vm._e(),_vm._v(\" \"),(_vm.collection !== undefined && _vm.sortedCollectionFileIds.length > 0 )?_c('FilesListViewer',{staticClass:\"collection__media\",attrs:{\"container-element\":_vm.appContent,\"file-ids\":_vm.sortedCollectionFileIds,\"base-height\":_vm.isMobile ? 120 : 200,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"default\",fn:function({file, distance}){return _c('File',{attrs:{\"file\":_vm.files[file.id],\"allow-selection\":_vm.allowSelection,\"selected\":_vm.selection[file.id] === true,\"distance\":distance},on:{\"click\":_vm.openViewer,\"select-toggled\":_vm.onFileSelectToggle}})}}],null,false,3813029717)}):_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n - @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n -\n - @author Louis Chemineau <louis@chmn.me>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n -->\n<template>\n\t<!-- Errors handlers-->\n\t<NcEmptyContent v-if=\"(collection === undefined && !loading) || error === 404\"\n\t\tclass=\"empty-content-with-illustration\"\n\t\t:name=\"t('photos', 'This collection does not exist')\">\n\t\t<FolderMultipleImage slot=\"icon\" />\n\t</NcEmptyContent>\n\t<NcEmptyContent v-else-if=\"error\" :name=\"t('photos', 'An error occurred')\">\n\t\t<AlertCircle slot=\"icon\" />\n\t</NcEmptyContent>\n\n\t<div v-else class=\"collection\">\n\t\t<!-- Header -->\n\t\t<slot class=\"collection__header\"\n\t\t\tname=\"header\"\n\t\t\t:selected-file-ids=\"selectedFileIds\"\n\t\t\t:reset-selection=\"resetSelection\" />\n\n\t\t<!-- No content -->\n\t\t<slot v-if=\"sortedCollectionFileIds.length === 0 && !loading\" name=\"empty-content\" />\n\n\t\t<!-- Media list -->\n\t\t<FilesListViewer v-if=\"collection !== undefined && sortedCollectionFileIds.length > 0 \"\n\t\t\t:container-element=\"appContent\"\n\t\t\tclass=\"collection__media\"\n\t\t\t:file-ids=\"sortedCollectionFileIds\"\n\t\t\t:base-height=\"isMobile ? 120 : 200\"\n\t\t\t:loading=\"loading\">\n\t\t\t<File slot-scope=\"{file, distance}\"\n\t\t\t\t:file=\"files[file.id]\"\n\t\t\t\t:allow-selection=\"allowSelection\"\n\t\t\t\t:selected=\"selection[file.id] === true\"\n\t\t\t\t:distance=\"distance\"\n\t\t\t\t@click=\"openViewer\"\n\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\n\t\t</FilesListViewer>\n\t</div>\n</template>\n\n<script>\nimport AlertCircle from 'vue-material-design-icons/AlertCircle.vue'\nimport FolderMultipleImage from 'vue-material-design-icons/FolderMultipleImage.vue'\n\nimport { NcEmptyContent, isMobile } from '@nextcloud/vue'\nimport { translate } from '@nextcloud/l10n'\n\nimport FilesSelectionMixin from '../../mixins/FilesSelectionMixin.js'\nimport FilesListViewer from '.././FilesListViewer.vue'\nimport File from '.././File.vue'\n\nexport default {\n\tname: 'CollectionContent',\n\n\tcomponents: {\n\t\tAlertCircle,\n\t\tFolderMultipleImage,\n\t\tNcEmptyContent,\n\t\tFilesListViewer,\n\t\tFile,\n\t},\n\n\tmixins: [\n\t\tFilesSelectionMixin,\n\t\tisMobile,\n\t],\n\n\tprops: {\n\t\t/** @type {import('vue').PropType<import('../../services/collectionFetcher').Collection>} */\n\t\tcollection: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => undefined,\n\t\t},\n\n\t\t/** @type {import('vue').PropType<string[]>} */\n\t\tcollectionFileIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\n\t\tallowSelection: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\n\t\terror: {\n\t\t\ttype: [Error, Number],\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tappContent: document.getElementById('app-content-vue'),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/** @return {import('../../services/collectionFetcher').IndexedCollectionFiles} */\n\t\tfiles() {\n\t\t\treturn this.$store.getters.files\n\t\t},\n\n\t\tsortedCollectionFileIds() {\n\t\t\treturn this.collectionFileIds.toSorted((fileId1, fileId2) => this.files[fileId1].timestamp < this.files[fileId2].timestamp ? -1 : 1)\n\t\t},\n\t},\n\n\tmethods: {\n\t\topenViewer(fileId) {\n\t\t\tconst file = this.files[fileId]\n\t\t\tOCA.Viewer.open({\n\t\t\t\tfileInfo: file,\n\t\t\t\tlist: this.sortedCollectionFileIds.map(fileId => this.files[fileId]).filter(file => !file.sectionHeader),\n\t\t\t\tloadMore: file.loadMore ? async () => await file.loadMore(true) : () => [],\n\t\t\t\tcanLoop: file.canLoop,\n\t\t\t})\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n<style lang=\"scss\" scoped>\n.collection {\n\tdisplay: flex;\n\tflex-direction: column;\n\n\t&__media {\n\t\tpadding: 0 64px;\n\n\t\t@media only screen and (max-width: 1200px) {\n\t\t\tpadding: 0 4px;\n\t\t}\n\t}\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=a7194c5e&prod&lang=scss&scoped=true\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=a7194c5e&prod&lang=scss&scoped=true\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./CollectionContent.vue?vue&type=template&id=a7194c5e&scoped=true\"\nimport script from \"./CollectionContent.vue?vue&type=script&lang=js\"\nexport * from \"./CollectionContent.vue?vue&type=script&lang=js\"\nimport style0 from \"./CollectionContent.vue?vue&type=style&index=0&id=a7194c5e&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a7194c5e\",\n  null\n  \n)\n\nexport default component.exports"],"names":["defineComponent","name","components","File","FilesListViewer","ImagePlus","NcButton","NcDialog","NcLoadingIcon","NcSelect","NcNoteCard","UploadPicker","mixins","FetchFilesMixin","FilesByMonthMixin","FilesSelectionMixin","props","open","type","Boolean","default","String","required","destination","blacklistIds","Array","loading","emits","setup","isMobile","useIsMobile","data","allowedMimes","targetMonth","uploadContext","route","currentUser","getCurrentUser","uid","computed","mapGetters","photosLocationFolder","$store","state","userConfig","watch","monthsList","value","methods","onFocusOut","event","relatedTarget","target","focus","preventScroll","getFiles","fetchFiles","refreshFiles","firstResult","fetchedFileIds","emitPickedEvent","$emit","selectedFileIds","dateMonthAndYear","date","moment","format","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","_vm","this","_c","_self","_setupProxy","attrs","on","scopedSlots","_u","key","fn","_ref","isCollapsed","staticClass","t","_ref2","label","_v","_s","_ref3","model","callback","$$v","expression","_l","month","$event","length","_e","proxy","attributes","owner","class","fileIdsByMonth","loadingFiles","nativeOn","apply","arguments","_ref4","file","height","isHeader","distance","style","id","files","selection","onFileSelectToggle","title","fillColor","size","Number","_b","$attrs","___CSS_LOADER_EXPORT___","push","module","filesByMonth","fileId","fileid","Object","keys","forEach","sort","sortFilesByTimestamp","month1","month2","fileId1","fileId2","timestamp","AbortControllerMixin","errorFetchingFiles","doneFetchingFiles","fetchSemaphore","SemaphoreWithPriority","resetFetchFilesState","undefined","blacklist","force","fetchSemaphoreSymbol","acquire","numberOfImagesPerBatch","fetchedFiles","async","nbResults","mimesType","allMimes","onThisDay","onlyFavorites","orMime","reduce","str","mime","eqFavorites","fill","map","_","years","start","Date","now","startOf","subtract","end","endOf","add","defaultFormatUtc","join","sourceFolders","store","photosSourceFolders","folder","joinPaths","davRootPath","assign","method","headers","deep","details","client","getDirectoryContents","genFileInfo","getPhotos","signal","abortController","fileIds","filter","includes","toString","dispatch","logger","debug","error","response","status","sources","source","match","davGetClient","createDirectory","code","release","AlertCircle","FolderMultipleImage","NcEmptyContent","collection","collectionFileIds","allowSelection","Error","appContent","document","getElementById","getters","sortedCollectionFileIds","toSorted","openViewer","OCA","Viewer","fileInfo","list","sectionHeader","loadMore","canLoop","translate","slot","_t","resetSelection"],"sourceRoot":""}
"use strict";(self.webpackChunkphotos=self.webpackChunkphotos||[]).push([["node_modules_nextcloud_vue_dist_Components_NcSelect_mjs","vendors-node_modules_nextcloud_dialogs_dist_chunks_FilePicker-JKNLPCbR_mjs"],{23460(e){var t=Object.prototype.hasOwnProperty,i="~";function n(){}function r(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function s(e,t,n,s,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new r(n,s||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,n,r=[];if(0===this._eventsCount)return r;for(n in e=this._events)t.call(e,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,a=new Array(s);r<s;r++)a[r]=n[r].fn;return a},o.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,r,s,a){var o=i?i+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,s),!0;case 6:return u.fn.call(u.context,t,n,r,s,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,r);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,i){return s(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return s(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,n,r){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||r&&!o[l].once||n&&o[l].context!==n)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o},57975(e,t,i){var n=i(65606);function r(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function s(e,t){for(var i,n="",r=0,s=-1,a=0,o=0;o<=e.length;++o){if(o<e.length)i=e.charCodeAt(o);else{if(47===i)break;i=47}if(47===i){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(n.length<2||2!==r||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",r=0):r=(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),s=o,a=0;continue}}else if(2===n.length||1===n.length){n="",r=0,s=o,a=0;continue}t&&(n.length>0?n+="/..":n="..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,a=0}else 46===i&&-1!==a?++a:a=-1}return n}var a={resolve:function(){for(var e,t="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var o;a>=0?o=arguments[a]:(void 0===e&&(e=n.cwd()),o=e),r(o),0!==o.length&&(t=o+"/"+t,i=47===o.charCodeAt(0))}return t=s(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(r(e),0===e.length)return".";var t=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=s(e,!t)).length||t||(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return r(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];r(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":a.normalize(e)},relative:function(e,t){if(r(e),r(t),e===t)return"";if((e=a.resolve(e))===(t=a.resolve(t)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var n=e.length,s=n-i,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var l=t.length-o,c=s<l?s:l,u=-1,d=0;d<=c;++d){if(d===c){if(l>c){if(47===t.charCodeAt(o+d))return t.slice(o+d+1);if(0===d)return t.slice(o+d)}else s>c&&(47===e.charCodeAt(i+d)?u=d:0===d&&(u=0));break}var p=e.charCodeAt(i+d);if(p!==t.charCodeAt(o+d))break;47===p&&(u=d)}var h="";for(d=i+u+1;d<=n;++d)d!==n&&47!==e.charCodeAt(d)||(0===h.length?h+="..":h+="/..");return h.length>0?h+t.slice(o+u):(o+=u,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(r(e),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,n=-1,s=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!s){n=a;break}}else s=!1;return-1===n?i?"/":".":i&&1===n?"//":e.slice(0,n)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');r(e);var i,n=0,s=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,l=-1;for(i=e.length-1;i>=0;--i){var c=e.charCodeAt(i);if(47===c){if(!a){n=i+1;break}}else-1===l&&(a=!1,l=i+1),o>=0&&(c===t.charCodeAt(o)?-1==--o&&(s=i):(o=-1,s=l))}return n===s?s=l:-1===s&&(s=e.length),e.slice(n,s)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!a){n=i+1;break}}else-1===s&&(a=!1,s=i+1);return-1===s?"":e.slice(n,s)},extname:function(e){r(e);for(var t=-1,i=0,n=-1,s=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(47!==l)-1===n&&(s=!1,n=o+1),46===l?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!s){i=o+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===i+1?"":e.slice(t,n)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var i=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+n:i+e+n:n}("/",e)},parse:function(e){r(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var i,n=e.charCodeAt(0),s=47===n;s?(t.root="/",i=1):i=0;for(var a=-1,o=0,l=-1,c=!0,u=e.length-1,d=0;u>=i;--u)if(47!==(n=e.charCodeAt(u)))-1===l&&(c=!1,l=u+1),46===n?-1===a?a=u:1!==d&&(d=1):-1!==a&&(d=-1);else if(!c){o=u+1;break}return-1===a||-1===l||0===d||1===d&&a===l-1&&a===o+1?-1!==l&&(t.base=t.name=0===o&&s?e.slice(1,l):e.slice(o,l)):(0===o&&s?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(o,a),t.base=e.slice(o,l)),t.ext=e.slice(a,l)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,e.exports=a},82841(e,t,i){i.r(t),i.d(t,{default:()=>Je});var n=i(85471),r=i(47626),s=i(42e3),a=i(74095),o=i(32073);function l(e,t,i){const n=`#initial-state-${e}-${t}`;if(window._nc_initial_state?.has(n))return window._nc_initial_state.get(n);window._nc_initial_state||(window._nc_initial_state=new Map);const r=document.querySelector(n);if(null===r){if(void 0!==i)return i;throw new Error(`Could not find initial state ${t} of ${e}`)}try{const e=JSON.parse(atob(r.value));return window._nc_initial_state.set(n,e),e}catch(n){if(console.error("[@nextcloud/initial-state] Could not parse initial state",{key:t,app:e,error:n}),void 0!==i)return i;throw new Error(`Could not parse initial state ${t} of ${e}`,{cause:n})}}var c=i(63814);function u(){return l("files_sharing","isPublic",null)??null!==document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')}var d=i(12189);function p(e){return"function"==typeof e?e():(0,d.R1)(e)}d.Sg,d.Sg,d.Sg,"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString;function h(e){const t=Object.create(null);return i=>t[i]||(t[i]=e(i))}const f=/\B([A-Z])/g,v=(h((e=>e.replace(f,"-$1").toLowerCase())),/-(\w)/g);h((e=>e.replace(v,((e,t)=>t?t.toUpperCase():""))));var m,g=i(3239),y=i(41133),_=i(4604),w="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z";!function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh"}(m||(m={}));var C=i(23460);class b extends Error{name="TimeoutError";constructor(e,t){super(e,t),Error.captureStackTrace?.(this,b)}}const k=e=>e.reason??new DOMException("This operation was aborted.","AbortError");class I{#e=[];enqueue(e,t){const{priority:i=0,id:n}=t??{},r={priority:i,id:n,run:e};if(0===this.size||this.#e[this.size-1].priority>=i)return void this.#e.push(r);const s=function(e,t,i){let n=0,r=e.length;for(;r>0;){const s=Math.trunc(r/2);let a=n+s;i(e[a],t)<=0?(n=++a,r-=s+1):r=s}return n}(this.#e,r,((e,t)=>t.priority-e.priority));this.#e.splice(s,0,r)}setPriority(e,t){const i=this.#e.findIndex((t=>t.id===e));if(-1===i)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[n]=this.#e.splice(i,1);this.enqueue(n.run,{priority:t,id:e})}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}var S=i(6695),x=i(42610),A=i(24764),L=i(73148),F=i(81621),N=i(21777),T=i(67607),P=i(82182),E=i(54914),V=i(61338),z=i(94219),H=i(42507),R=i(36117),B=i(57975);const M={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var $=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},q=[];const D=(0,r.n)(M,$,q,!1,null,null).exports,W=()=>{const e=l("files","config",null),t=(0,n.KR)(e?.show_hidden??!0),i=(0,n.KR)(e?.sort_favorites_first??!0),s=(0,n.KR)(e?.crop_image_previews??!0);return(0,n.sV)((async()=>{if(u())console.debug("Skip loading files settings - currently on public share");else try{const{data:e}=await g.Ay.get((0,c.Jv)("/apps/files/api/v1/configs"));t.value=e?.data?.show_hidden??!1,i.value=e?.data?.sort_favorites_first??!0,s.value=e?.data?.crop_image_previews??!0}catch(e){console.error("Could not load files settings",e),(0,r.l)((0,r.t)("Could not load files settings"))}})),{showHiddenFiles:t,sortFavoritesFirst:i,cropImagePreviews:s}},O={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var K=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},j=[];const Z=(0,r.n)(O,K,j,!1,null,null).exports,U={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var J=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},G=[];const Y=(0,r.n)(U,J,G,!1,null,null).exports,Q={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},X=(0,n.pM)({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup:e=>({__sfc:!0,fileListIconStyles:Q})});var ee=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?t("td",{staticClass:"row-checkbox"},[t("span")]):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"row-wrapper"},[t("span",{class:i.fileListIconStyles["file-picker__file-icon"]}),t("span")])]),e._m(0),e._m(1)])},te=[function(){var e=this._self._c;return this._self._setupProxy,e("td",{staticClass:"row-size"},[e("span")])},function(){var e=this._self._c;return this._self._setupProxy,e("td",{staticClass:"row-modified"},[e("span")])}];const ie=(0,r.n)(X,ee,te,!1,null,"15187afc").exports,ne=new class extends C{#t;#i;#n=0;#r;#s=!1;#a=!1;#o;#l=0;#c=0;#u;#d;#p;#h=[];#f=0;#e;#v;#m=0;#g;#y;#_=1n;#w=new Map;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:I,strict:!1,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);if(e.strict&&0===e.interval)throw new TypeError("The `strict` option requires a non-zero `interval`");if(e.strict&&e.intervalCap===Number.POSITIVE_INFINITY)throw new TypeError("The `strict` option requires a finite `intervalCap`");if(this.#t=e.carryoverIntervalCount??e.carryoverConcurrencyCount??!1,this.#i=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#r=e.intervalCap,this.#o=e.interval,this.#p=e.strict,this.#e=new e.queueClass,this.#v=e.queueClass,this.concurrency=e.concurrency,void 0!==e.timeout&&!(Number.isFinite(e.timeout)&&e.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${e.timeout}\` (${typeof e.timeout})`);this.timeout=e.timeout,this.#y=!1===e.autoStart,this.#C()}#b(e){for(;this.#f<this.#h.length;){const t=this.#h[this.#f];if(!(void 0!==t&&e-t>=this.#o))break;this.#f++}(this.#f>100&&this.#f>this.#h.length/2||this.#f===this.#h.length)&&(this.#h=this.#h.slice(this.#f),this.#f=0)}#k(e){this.#p?this.#h.push(e):this.#n++}#I(){this.#p?this.#h.length>this.#f&&this.#h.pop():this.#n>0&&this.#n--}#S(){return this.#h.length-this.#f}get#x(){return!!this.#i||(this.#p?this.#S()<this.#r:this.#n<this.#r)}get#A(){return this.#m<this.#g}#L(){this.#m--,0===this.#m&&this.emit("pendingZero"),this.#F(),this.emit("next")}#N(){this.#d=void 0,this.#T(),this.#P()}#E(e){if(this.#p){this.#b(e);if(this.#S()>=this.#r){const t=this.#h[this.#f],i=this.#o-(e-t);return this.#V(i),!0}return!1}if(void 0===this.#u){const t=this.#l-e;if(!(t<0))return this.#V(t),!0;if(this.#c>0){const t=e-this.#c;if(t<this.#o)return this.#V(this.#o-t),!0}this.#n=this.#t?this.#m:0}return!1}#V(e){void 0===this.#d&&(this.#d=setTimeout((()=>{this.#N()}),e))}#z(){this.#u&&(clearInterval(this.#u),this.#u=void 0)}#H(){this.#d&&(clearTimeout(this.#d),this.#d=void 0)}#F(){if(0===this.#e.size){if(this.#z(),this.emit("empty"),0===this.#m){if(this.#H(),this.#p&&this.#f>0){const e=Date.now();this.#b(e)}this.emit("idle")}return!1}let e=!1;if(!this.#y){const t=Date.now(),i=!this.#E(t);if(this.#x&&this.#A){const n=this.#e.dequeue();this.#i||(this.#k(t),this.#R()),this.emit("active"),n(),i&&this.#P(),e=!0}}return e}#P(){this.#i||void 0!==this.#u||this.#p||(this.#u=setInterval((()=>{this.#T()}),this.#o),this.#l=Date.now()+this.#o)}#T(){this.#p||(0===this.#n&&0===this.#m&&this.#u&&this.#z(),this.#n=this.#t?this.#m:0),this.#B(),this.#R()}#B(){for(;this.#F(););}get concurrency(){return this.#g}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#g=e,this.#B()}setPriority(e,t){if("number"!=typeof t||!Number.isFinite(t))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${t}\` (${typeof t})`);this.#e.setPriority(e,t)}async add(e,t={}){return t={timeout:this.timeout,...t,id:t.id??(this.#_++).toString()},new Promise(((i,n)=>{const r=Symbol(`task-${t.id}`);this.#e.enqueue((async()=>{let s;this.#m++,this.#w.set(r,{id:t.id,priority:t.priority??0,startTime:Date.now(),timeout:t.timeout});try{try{t.signal?.throwIfAborted()}catch(e){throw this.#M(),this.#w.delete(r),e}this.#c=Date.now();let n=e({signal:t.signal});if(t.timeout&&(n=function(e,t){const{milliseconds:i,fallback:n,message:r,customTimers:s={setTimeout,clearTimeout},signal:a}=t;let o,l;const c=new Promise(((t,c)=>{if("number"!=typeof i||1!==Math.sign(i))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(a?.aborted)return void c(k(a));if(a&&(l=()=>{c(k(a))},a.addEventListener("abort",l,{once:!0})),e.then(t,c),i===Number.POSITIVE_INFINITY)return;const u=new b;o=s.setTimeout.call(void 0,(()=>{if(n)try{t(n())}catch(e){c(e)}else"function"==typeof e.cancel&&e.cancel(),!1===r?t():r instanceof Error?c(r):(u.message=r??`Promise timed out after ${i} milliseconds`,c(u))}),i)})).finally((()=>{c.clear(),l&&a&&a.removeEventListener("abort",l)}));return c.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},c}(Promise.resolve(n),{milliseconds:t.timeout,message:`Task timed out after ${t.timeout}ms (queue has ${this.#m} running, ${this.#e.size} waiting)`})),t.signal){const{signal:e}=t;n=Promise.race([n,new Promise(((t,i)=>{s=()=>{i(e.reason)},e.addEventListener("abort",s,{once:!0})}))])}const a=await n;i(a),this.emit("completed",a)}catch(e){n(e),this.emit("error",e)}finally{s&&t.signal?.removeEventListener("abort",s),this.#w.delete(r),queueMicrotask((()=>{this.#L()}))}}),t),this.emit("add"),this.#F()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#y?(this.#y=!1,this.#B(),this):this}pause(){this.#y=!0}clear(){this.#e=new this.#v,this.#z(),this.#$(),this.emit("empty"),0===this.#m&&(this.#H(),this.emit("idle")),this.emit("next")}async onEmpty(){0!==this.#e.size&&await this.#q("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#q("next",(()=>this.#e.size<e))}async onIdle(){0===this.#m&&0===this.#e.size||await this.#q("idle")}async onPendingZero(){0!==this.#m&&await this.#q("pendingZero")}async onRateLimit(){this.isRateLimited||await this.#q("rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await this.#q("rateLimitCleared")}onError(){return new Promise(((e,t)=>{const i=e=>{this.off("error",i),t(e)};this.on("error",i)}))}async#q(e,t){return new Promise((i=>{const n=()=>{t&&!t()||(this.off(e,n),i())};this.on(e,n)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#m}get isPaused(){return this.#y}#C(){this.#i||(this.on("add",(()=>{this.#e.size>0&&this.#R()})),this.on("next",(()=>{this.#R()})))}#R(){this.#i||this.#a||(this.#a=!0,queueMicrotask((()=>{this.#a=!1,this.#$()})))}#M(){this.#i||(this.#I(),this.#R())}#$(){const e=this.#s;if(this.#i||0===this.#e.size)return void(e&&(this.#s=!1,this.emit("rateLimitCleared")));let t;if(this.#p){const e=Date.now();this.#b(e),t=this.#S()}else t=this.#n;const i=t>=this.#r;i!==e&&(this.#s=i,this.emit(i?"rateLimit":"rateLimitCleared"))}get isRateLimited(){return this.#s}get isSaturated(){return this.#m===this.#g&&this.#e.size>0||this.isRateLimited&&this.#e.size>0}get runningTasks(){return[...this.#w.values()].map((e=>({...e})))}}({concurrency:5});const re=(e,t)=>{const i=(0,n.KR)(null),r=(0,n.KR)(!1);return(0,n.nT)((()=>{r.value=!1,i.value=function(e,t={}){t={size:32,cropPreview:!1,mimeFallback:!0,...t};try{const i=e.attributes?.previewUrl||(0,c.Jv)("/core/preview?fileId={fileid}",{fileid:e.fileid});let n;try{n=new URL(i)}catch(e){n=new URL(i,window.location.origin)}return n.searchParams.set("x",`${t.size}`),n.searchParams.set("y",`${t.size}`),n.searchParams.set("mimeFallback",`${t.mimeFallback}`),n.searchParams.set("a",!0===t.cropPreview?"0":"1"),n.searchParams.set("c",`${e.attributes.etag}`),n}catch(e){return null}}(p(e),p(t||{})),i.value&&p(e).type===s.pt.File&&function(e){const{resolve:t,promise:i}=Promise.withResolvers();return ne.add((()=>{const n=new Image;return n.onerror=()=>t(!1),n.onload=()=>t(!0),n.src=e,i})),i}(i.value.href).then((e=>{r.value=e}))})),{previewURL:i,previewLoaded:r}},se={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ae=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},oe=[];const le=(0,r.n)(se,ae,oe,!1,null,null).exports,ce=(0,n.pM)({name:"FilePreview",props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const t=e,i=(0,n.KR)(Q),{previewURL:r,previewLoaded:a}=re((0,n.lW)(t,"node"),(0,n.EW)((()=>({cropPreview:t.cropImagePreviews})))),o=(0,n.EW)((()=>t.node.type===s.pt.File)),l=(0,n.EW)((()=>{if(t.node.type!==s.pt.Folder)return null;if(1===t.node.attributes?.["is-encrypted"])return"M7 14C5.9 14 5 13.1 5 12S5.9 10 7 10 9 10.9 9 12 8.1 14 7 14M12.6 10C11.8 7.7 9.6 6 7 6C3.7 6 1 8.7 1 12S3.7 18 7 18C9.6 18 11.8 16.3 12.6 14H16V18H20V14H23V10H12.6Z";if(t.node.attributes?.["is-tag"])return"M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L11.59 21.42A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M13 20L4 11V4H11L20 13M6.5 5A1.5 1.5 0 1 1 5 6.5A1.5 1.5 0 0 1 6.5 5Z";const e=Object.values(t.node.attributes?.["share-types"]||{}).flat();if(e.some((e=>e===m.Link||e===m.Email)))return"M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z";if(e.length>0)return w;switch(t.node.attributes?.["mount-type"]){case"external":case"external-session":return"M15,20A1,1 0 0,0 14,19H13V17H17A2,2 0 0,0 19,15V5A2,2 0 0,0 17,3H7A2,2 0 0,0 5,5V15A2,2 0 0,0 7,17H11V19H10A1,1 0 0,0 9,20H2V22H9A1,1 0 0,0 10,23H14A1,1 0 0,0 15,22H22V20H15M7,15V5H17V15H7Z";case"group":return"M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z";case"shared":return w}return null}));return{__sfc:!0,fileListIconStyles:i,props:t,previewURL:r,previewLoaded:a,isFile:o,folderDecorationIcon:l,NcIconSvgWrapper:S.A,IconFile:D,IconFolder:le}}});var ue=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{class:i.fileListIconStyles["file-picker__file-icon"],style:i.previewLoaded?{backgroundImage:`url(${i.previewURL})`}:void 0},[i.previewLoaded?e._e():[i.isFile?t(i.IconFile,{attrs:{size:32}}):[i.folderDecorationIcon?t(i.NcIconSvgWrapper,{class:i.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:i.folderDecorationIcon,size:16}}):e._e(),t(i.IconFolder,{class:i.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},de=[];const pe=(0,r.n)(ce,ue,de,!1,null,null).exports,he=(0,n.pM)({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:t}){const i=e,a=(0,n.EW)((()=>(0,y.LC)(i.node.displayname))),l=(0,n.EW)((()=>i.node.displayname.slice(0,a.value?-a.value.length:void 0))),c=(0,n.EW)((()=>i.node.type===s.pt.Folder)),u=(0,n.EW)((()=>i.canPick&&(i.allowPickDirectory||!c.value))),d=(0,n.EW)((()=>(i.node.permissions&s.aX.READ)===s.aX.READ));function p(){u.value&&t("update:selected",!i.selected)}function h(){c.value?d.value&&t("enter-directory",i.node):p()}return{__sfc:!0,props:i,emit:t,fileExtension:a,displayName:l,isDirectory:c,isPickable:u,isNavigatable:d,toggleSelected:p,handleClick:h,handleKeyDown:function(e){"Enter"===e.key&&h()},formatFileSize:s.v7,NcCheckboxRadioSwitch:o.A,NcDateTime:_.A,t:r.t,FilePreview:pe}}});var fe=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":i.isDirectory&&!i.isNavigatable,"file-picker__row--not-pickable":!i.isPickable}],attrs:{tabindex:e.showCheckbox&&!i.isDirectory?void 0:0,"aria-selected":i.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:i.handleClick,...!e.showCheckbox||i.isDirectory?{keydown:i.handleKeyDown}:{}}),[e.showCheckbox?t("td",{staticClass:"row-checkbox",on:{click:function(e){return e.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select the row for {nodename}",{nodename:i.displayName}),disabled:!i.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":i.toggleSelected}})],1):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[t(i.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),t("div",{staticClass:"file-picker__file-name",attrs:{title:i.displayName},domProps:{textContent:e._s(i.displayName)}}),t("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(i.fileExtension)}})],1)]),t("td",{staticClass:"row-size"},[e._v(" "+e._s(i.formatFileSize(e.node.size||0))+" ")]),t("td",{staticClass:"row-modified"},[t(i.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},ve=[];const me=(0,r.n)(he,fe,ve,!1,null,"82f380c9").exports,ge=(0,n.pM)({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,canPick:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:t}){const i=e,d=(0,n.KR)(),{currentConfig:h}=(e=>{const t=e=>"asc"===e?"ascending":"desc"===e?"descending":"none",i=l("files","viewConfigs",null),s=(0,n.KR)({sortBy:i?.files?.sorting_mode??"basename",order:t(i?.files?.sorting_direction??"asc")}),a=(0,n.KR)({sortBy:i?.recent?.sorting_mode??"basename",order:t(i?.recent?.sorting_direction??"asc")}),o=(0,n.KR)({sortBy:i?.favorites?.sorting_mode??"basename",order:t(i?.favorites?.sorting_direction??"asc")});(0,n.sV)((async()=>{if(u())console.debug("Skip loading files views - currently on public share");else try{const{data:e}=await g.Ay.get((0,c.Jv)("/apps/files/api/v1/views"));s.value={sortBy:e?.data?.files?.sorting_mode??"basename",order:t(e?.data?.files?.sorting_direction)},o.value={sortBy:e?.data?.favorites?.sorting_mode??"basename",order:t(e?.data?.favorites?.sorting_direction)},a.value={sortBy:e?.data?.recent?.sorting_mode??"basename",order:t(e?.data?.recent?.sorting_direction)}}catch(e){console.error("Could not load files views",e),(0,r.l)((0,r.t)("Could not load files views"))}}));const d=(0,n.EW)((()=>"files"===p(e||"files")?s.value:"recent"===p(e)?a.value:o.value)),h=(0,n.EW)((()=>d.value.sortBy)),f=(0,n.EW)((()=>d.value.order));return{filesViewConfig:s,favoritesViewConfig:o,recentViewConfig:a,currentConfig:d,sortBy:h,order:f}})(i.currentView),f=(0,n.EW)((()=>d.value??h.value)),v=(0,n.EW)((()=>"basename"===f.value.sortBy?"none"===f.value.order?void 0:f.value.order:void 0)),m=(0,n.EW)((()=>"size"===f.value.sortBy?"none"===f.value.order?void 0:f.value.order:void 0)),y=(0,n.EW)((()=>"mtime"===f.value.sortBy?"none"===f.value.order?void 0:f.value.order:void 0)),{sortFavoritesFirst:_,cropImagePreviews:w}=W(),C=(0,n.EW)((()=>(0,s.ur)(i.files,{sortFoldersFirst:!0,sortFavoritesFirst:_.value,sortingOrder:"descending"===f.value.order?"desc":"asc",sortingMode:f.value.sortBy}))),b=(0,n.EW)((()=>i.files.filter((e=>i.allowPickDirectory||e.type!==s.pt.Folder)))),k=(0,n.EW)((()=>!i.loading&&i.selectedFiles.length>0&&i.selectedFiles.length>=b.value.length));const I=(0,n.KR)(4),S=(0,n.KR)();{const e=()=>(0,n.dY)((()=>{const e=S.value?.parentElement?.children||[];let t=S.value?.parentElement?.clientHeight||450;for(let i=0;i<e.length;i++)S.value?.isSameNode(e[i])||(t-=e[i].clientHeight);I.value=Math.max(1,Math.floor((t-50)/50))}));(0,n.sV)((()=>{window.addEventListener("resize",e),e()})),(0,n.hi)((()=>{window.removeEventListener("resize",e)}))}return{__sfc:!0,props:i,emit:t,customSortingConfig:d,filesAppSorting:h,sortingConfig:f,sortByName:v,sortBySize:m,sortByModified:y,toggleSorting:e=>{f.value.sortBy===e?"ascending"===f.value.order?d.value={sortBy:f.value.sortBy,order:"descending"}:d.value={sortBy:f.value.sortBy,order:"ascending"}:d.value={sortBy:e,order:"ascending"}},sortFavoritesFirst:_,cropImagePreviews:w,sortedFiles:C,selectableFiles:b,allSelected:k,onSelectAll:function(){i.selectedFiles.length<b.value.length?t("update:selectedFiles",b.value):t("update:selectedFiles",[])},onNodeSelected:function(e){i.selectedFiles.includes(e)?t("update:selectedFiles",i.selectedFiles.filter((t=>t.path!==e.path))):i.multiselect?t("update:selectedFiles",[...i.selectedFiles,e]):t("update:selectedFiles",[e])},onChangeDirectory:function(e){t("update:path",e.path)},skeletonNumber:I,fileContainer:S,NcButton:a.A,NcCheckboxRadioSwitch:o.A,t:r.t,IconSortAscending:Z,IconSortDescending:Y,LoadingTableRow:ie,FileListRow:me}}});var ye=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"fileContainer",staticClass:"file-picker__files"},[t("table",[t("thead",[t("tr",[e.multiselect?t("th",{staticClass:"row-checkbox"},[t("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(i.t("Select entry"))+" ")]),e.multiselect?t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":i.allSelected},on:{"update:model-value":i.onSelectAll}}):e._e()],1):e._e(),t("th",{staticClass:"row-name",attrs:{"aria-sort":i.sortByName}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"file-picker__header-preview"}),t(i.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(e){return i.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return["ascending"===i.sortByName?t(i.IconSortAscending,{attrs:{size:20}}):"descending"===i.sortByName?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Name"))+" ")])],1)]),t("th",{staticClass:"row-size",attrs:{"aria-sort":i.sortBySize}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(e){return i.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return["ascending"===i.sortBySize?t(i.IconSortAscending,{attrs:{size:20}}):"descending"===i.sortBySize?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Size"))+" ")])],1),t("th",{staticClass:"row-modified",attrs:{"aria-sort":i.sortByModified}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(e){return i.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return["ascending"===i.sortByModified?t(i.IconSortAscending,{attrs:{size:20}}):"descending"===i.sortByModified?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Modified"))+" ")])],1)])]),t("tbody",[e.loading?e._l(i.skeletonNumber,(function(n){return t(i.LoadingTableRow,{key:n,attrs:{"show-checkbox":e.multiselect}})})):e._l(i.sortedFiles,(function(n){return t(i.FileListRow,{key:n.fileid||n.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||0===e.selectedFiles.length||e.selectedFiles.includes(n))&&(void 0===e.canPick||e.canPick(n)),selected:e.selectedFiles.includes(n),node:n,"crop-image-previews":i.cropImagePreviews},on:{"update:selected":function(e){return i.onNodeSelected(n)},"enter-directory":i.onChangeDirectory}})}))],2)])])},_e=[];const we=(0,r.n)(ge,ye,_e,!1,null,"6503afab").exports,Ce={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var be=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ke=[];const Ie=(0,r.n)(Ce,be,ke,!1,null,null).exports,Se={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var xe=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ae=[];const Le=(0,r.n)(Se,xe,Ae,!1,null,null).exports,Fe=(0,n.pM)({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:t}){const i=e,a=(0,n.KR)(!1),o=(0,n.KR)(""),l=(0,n.KR)();function c(){const e=o.value.trim(),t=l.value?.$el?.querySelector("input");let i="";try{(0,s.KT)(e)}catch(e){if(!(e instanceof s.di))throw e;switch(e.reason){case s.nF.Character:i=(0,r.t)('"{char}" is not allowed inside a folder name.',{char:e.segment});break;case s.nF.ReservedName:i=(0,r.t)('"{segment}" is a reserved name and not allowed for folder names.',{segment:e.segment});break;case s.nF.Extension:i=(0,r.t)('Folder names must not end with "{extension}".',{extension:e.segment});break;default:i=(0,r.t)("Invalid folder name.")}}return t&&t.setCustomValidity(i),""===i}const u=(0,n.EW)((()=>i.path.split("/").filter((e=>""!==e)).map(((e,t,i)=>({name:e,path:"/"+i.slice(0,t+1).join("/")})))));return{__sfc:!0,props:i,emit:t,actionsOpen:a,newNodeName:o,nameInput:l,validateInput:c,onSubmit:function(){const e=o.value.trim();c()&&(a.value=!1,t("create-node",e),o.value="")},pathElements:u,NcActionInput:x.N,NcActions:A.A,NcBreadcrumb:L.N,NcBreadcrumbs:F.N,IconFolder:le,IconHome:Ie,IconPlus:Le,t:r.t}}});var Ne=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[t(i.NcBreadcrumb,{attrs:{name:i.t("All files"),title:i.t("Home")},on:{click:function(e){return i.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(i.pathElements,(function(e){return t(i.NcBreadcrumb,{key:e.path,attrs:{name:e.name,title:e.path},on:{click:function(t){return i.emit("update:path",e.path)}}})}))]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[t(i.NcActions,{attrs:{open:i.actionsOpen,"aria-label":i.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":i.t("New"),type:"secondary"},on:{"update:open":function(e){i.actionsOpen=e},close:function(e){i.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[t(i.NcActionInput,{ref:"nameInput",attrs:{value:i.newNodeName,label:i.t("New folder"),placeholder:i.t("New folder name")},on:{"update:value":function(e){i.newNodeName=e},submit:i.onSubmit,"update:model-value":i.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},Te=[];const Pe=(0,r.n)(Fe,Ne,Te,!1,null,"1a8cb0b2").exports,Ee={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ve=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ze=[];const He=(0,r.n)(Ee,Ve,ze,!1,null,null).exports,Re={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Be=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Me=[];const $e=(0,r.n)(Re,Be,Me,!1,null,null).exports,qe=(0,n.pM)({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:t}){const i=e,{availableViews:s}=(e=>{const t=[{id:"files",label:(0,r.t)("All files"),icon:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},{id:"recent",label:(0,r.t)("Recent"),icon:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z"},{id:"favorites",label:(0,r.t)("Favorites"),icon:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"}],i=e.value?t.filter((({id:e})=>"files"===e)):t;return{allViews:t,availableViews:i}})((0,n.KR)(null===(0,N.HW)())),o=(0,n.EW)((()=>s.filter((e=>e.id===i.currentView))[0]??s[0]));return{__sfc:!0,props:i,emit:t,availableViews:s,currentViewObject:o,updateFilterValue:e=>t("update:filterString",e),IconClose:He,IconMagnify:$e,NcButton:a.A,NcIconSvgWrapper:S.A,NcSelect:T.default,NcTextField:P.A,Fragment:E.F,t:r.t}}});var De=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.Fragment,[t(i.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:i.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":i.updateFilterValue,"trailing-button-click":function(e){return i.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[t(i.IconClose,{attrs:{size:16}})]},proxy:!0}])},[t(i.IconMagnify,{attrs:{size:16}})],1),i.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?t(i.NcSelect,{attrs:{"aria-label":i.t("Current view selector"),clearable:!1,searchable:!1,options:i.availableViews,"model-value":i.currentViewObject},on:{"update:model-value":function(e){return i.emit("update:currentView",e.id)}}}):t("ul",{staticClass:"file-picker__side"},e._l(i.availableViews,(function(n){return t("li",{key:n.id},[t(i.NcButton,{attrs:{type:e.currentView===n.id?"primary":"tertiary",wide:!0},on:{click:function(t){return e.$emit("update:currentView",n.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.NcIconSvgWrapper,{attrs:{path:n.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(n.label)+" ")])],1)})),0)]:e._e()],2)},We=[];const Oe=(0,r.n)(qe,De,We,!1,null,"f5975252").exports;const Ke=function(e,t){const i=(0,s.H4)(),r=(0,n.IJ)([]),a=(0,n.IJ)(null),o=(0,n.KR)(!0),l=(0,n.KR)(null);async function c(){l.value&&l.value.cancel(),o.value=!0,"favorites"===e.value?l.value=(0,s.Q$)(i,t.value):"recent"===e.value?l.value=function(e){const t=new AbortController,i=Math.round(Date.now()/1e3)-1209600;return new R.CancelablePromise((async(n,r,a)=>{a((()=>t.abort()));try{const{data:r}=await e.search("/",{signal:t.signal,details:!0,data:(0,s.R3)(i)});n(r.results.map((e=>(0,s.Al)(e))))}catch(e){r(e)}}))}(i):l.value=function(e,t){const i=new AbortController;return new R.CancelablePromise((async(n,r,a)=>{a((()=>i.abort()));try{const r=(await e.getDirectoryContents((0,B.join)(s.lJ,t),{signal:i.signal,details:!0,includeSelf:!0,data:(0,s.VL)()})).data.map((e=>(0,s.Al)(e)));n({contents:r.filter((({path:e})=>e!==t)),folder:r.find((({path:e})=>e===t))})}catch(e){r(e)}}))}(i,t.value);const n=await l.value;"folder"in n?(a.value=n.folder,r.value=n.contents):(a.value=null,r.value=n),l.value=null,o.value=!1}return(0,n.wB)([e,t],(()=>c())),(0,n.sV)((()=>c())),{isLoading:o,files:r,folder:a,loadFiles:c,createDirectory:async function(e){const n=(0,B.join)(t.value,e);await i.createDirectory((0,B.join)(s.lJ,n));const a=await async function(e,t){const{data:i}=await e.stat((0,B.join)(s.lJ,t),{details:!0,data:(0,s.VL)()});return(0,s.Al)(i)}(i,n);return r.value=[...r.value,a],a}}},je=(0,n.pM)({name:"FilePicker",props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},canPickFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:t}){const i=e,s=(0,n.KR)(!0),a=(0,n.EW)((()=>{const e=0===d.value.length&&i.allowPickDirectory&&y.value?[y.value]:d.value;return("function"==typeof i.buttons?i.buttons(e,f.value,c.value):i.buttons).map((t=>({...t,disabled:t.disabled||_.value,callback:()=>{o=!0,l(t.callback,e)}})))}));let o=!1;const l=async(e,i)=>{e(i),t("close",i),o=!1},c=(0,n.KR)("files"),u=(0,n.EW)((()=>"favorites"===c.value?(0,r.t)("Favorites"):"recent"===c.value?(0,r.t)("Recent"):"")),d=(0,n.IJ)([]),p=(0,n.KR)(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),h=(0,n.KR)("");(0,n.wB)([h],(()=>{void 0===i.path&&h.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",h.value),d.value=[]}));const f=(0,n.EW)({get:()=>"files"===c.value?h.value||i.path||p.value:"/",set:e=>{h.value=e}}),v=(0,n.KR)(""),{isSupportedMimeType:m}=function(e){const t=(0,n.EW)((()=>e.value.map((e=>e.split("/")))));return{isSupportedMimeType:e=>{const i=e.split("/");return t.value.some((([e,t])=>!(i[0]!==e&&"*"!==e||i[1]!==t&&"*"!==t)))}}}((0,n.lW)(i,"mimetypeFilter")),{files:g,folder:y,isLoading:_,loadFiles:w,createDirectory:C}=Ke(c,f);(0,n.sV)((()=>w()));const{showHiddenFiles:b}=W(),k=(0,n.EW)((()=>{let e=g.value;return b.value||(e=e.filter((e=>!e.basename.startsWith(".")))),i.mimetypeFilter.length>0&&(e=e.filter((e=>"folder"===e.type||e.mime&&m(e.mime)))),v.value&&(e=e.filter((e=>e.basename.toLowerCase().includes(v.value.toLowerCase())))),i.filterFn&&(e=e.filter((e=>i.filterFn(e)))),e})),I=(0,n.EW)((()=>"files"===c.value?(0,r.t)("Upload some content or sync with your devices!"):"recent"===c.value?(0,r.t)("Files and folders you recently modified will show up here."):(0,r.t)("Files and folders you mark as favorite will show up here.")));return{__sfc:!0,props:i,emit:t,isOpen:s,dialogButtons:a,isHandlingCallback:o,handleButtonClick:l,currentView:c,viewHeadline:u,selectedFiles:d,savedPath:p,navigatedPath:h,currentPath:f,filterString:v,isSupportedMimeType:m,files:g,currentFolder:y,isLoading:_,loadFiles:w,createDirectory:C,showHiddenFiles:b,filteredFiles:k,noFilesDescription:I,onCreateFolder:async e=>{try{const t=await C(e);h.value=t.path,(0,V.Ic)("files:node:created",g.value.filter((t=>t.basename===e))[0])}catch(t){console.warn("Could not create new folder",{name:e,error:t}),(0,r.l)((0,r.t)("Could not create the new folder"))}},handleClose:e=>{e||o||t("close")},IconFile:D,FileList:we,FilePickerBreadcrumbs:Pe,FilePickerNavigation:Oe,NcDialog:z.A,NcEmptyContent:H.A,t:r.t}}});var Ze=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcDialog,{attrs:{open:i.isOpen,container:e.container,buttons:i.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(e){i.isOpen=e},i.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:n}){return[t(i.FilePickerNavigation,{attrs:{"current-view":i.currentView,"filter-string":i.filterString,"is-collapsed":n,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(e){i.currentView=e},"update:current-view":function(e){i.currentView=e},"update:filterString":function(e){i.filterString=e},"update:filter-string":function(e){i.filterString=e}}})]}}])},[t("div",{staticClass:"file-picker__main"},["files"===i.currentView?t(i.FilePickerBreadcrumbs,{attrs:{path:i.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(e){i.currentPath=e},"create-node":i.onCreateFolder}}):t("div",{staticClass:"file-picker__view"},[t("h3",[e._v(e._s(i.viewHeadline))])]),i.isLoading||i.filteredFiles.length>0?t(i.FileList,{attrs:{path:i.currentPath,"selected-files":i.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":i.currentView,files:i.filteredFiles,multiselect:e.multiselect,loading:i.isLoading,name:i.viewHeadline,"can-pick":e.canPickFn},on:{"update:path":[function(e){i.currentPath=e},function(e){i.currentView="files"}],"update:selectedFiles":function(e){i.selectedFiles=e},"update:selected-files":function(e){i.selectedFiles=e}}}):i.filterString?t(i.NcEmptyContent,{attrs:{name:i.t("No matching files"),description:i.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])}):t(i.NcEmptyContent,{attrs:{name:i.t("No files in here"),description:i.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])})],1)])},Ue=[];const Je=(0,r.n)(je,Ze,Ue,!1,null,"dda9b42b").exports},41133(e,t,i){function n(e,t){return e=e.replace(/\\/g,"/").replace(/\/+$/g,"").replace(/.*\//,""),t&&t!==e&&e.endsWith(t)?e.substring(0,e.length-t.length):e}function r(e){const t=n(e),i=t.lastIndexOf(".");return i>0?t.substring(i):""}i.d(t,{LC:()=>r,P8:()=>n})},24764(e,t,i){i.d(t,{A:()=>n.N});var n=i(68166)},74095(e,t,i){i.d(t,{A:()=>n.N});var n=i(94294)},32073(e,t,i){i.d(t,{A:()=>n.N});var n=i(93314)},4604(e,t,i){i.d(t,{A:()=>n.N});var n=i(44025)},6695(e,t,i){i.d(t,{A:()=>n.N});var n=i(48191)},67607(e,t,i){i.r(t),i.d(t,{default:()=>n.N});var n=i(79066)},82182(e,t,i){i.d(t,{A:()=>n.N});var n=i(40959)}}]);
//# sourceMappingURL=photos-vendors-node_modules_nextcloud_dialogs_dist_chunks_FilePicker-JKNLPCbR_mjs.js.map?v=748f3b6ba79fdfbeabfc